<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Yi Yao's Homepage - Yi Yao</title><link href="https://yaoyi92.github.io/" rel="alternate"></link><link href="https://yaoyi92.github.io/feeds/yi-yao.atom.xml" rel="self"></link><id>https://yaoyi92.github.io/</id><updated>2021-06-15T14:56:00+02:00</updated><entry><title>Performing Bader Analysis with FHI-aims code</title><link href="https://yaoyi92.github.io/performing-bader-analysis-with-fhi-aims-code.html" rel="alternate"></link><published>2021-06-15T14:56:00+02:00</published><updated>2021-06-15T14:56:00+02:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2021-06-15:/performing-bader-analysis-with-fhi-aims-code.html</id><summary type="html">&lt;p&gt;How to perform Bader analysis with FHI-aims code.&lt;/p&gt;</summary><content type="html">&lt;h4&gt;Introduction&lt;/h4&gt;
&lt;p&gt;Bader analysis is a widely used technique to decompose the charge density into contributions from individual atoms &lt;a href="https://pubs.acs.org/doi/10.1021/ar00109a003"&gt;[Bader]&lt;/a&gt; &lt;a href="https://iopscience.iop.org/article/10.1088/0953-8984/21/8/084204"&gt;[Tang]&lt;/a&gt; &lt;a href="https://doi.org/10.1063/1.3553716"&gt;[Yu]&lt;/a&gt;. It belongs to the theory of atoms in molecules which helps explain the complex electronic interactions in molecules or materials. The electron density calculated by density functional theory is the most common object where Bader analysis working on. Especially, for the planewave pseudopotential codes such as VASP and Quantum Espresso, Bader analysis can be applied naturally on the electron density information saved in the &lt;a href="http://paulbourke.net/dataformats/cube/"&gt;Cube files&lt;/a&gt;, which are density values held on even distributed integration grids in periodic 3D space. &lt;/p&gt;
&lt;h4&gt;Difficulty with Cube file in all-electron full-potential code FHI-aims&lt;/h4&gt;
&lt;p&gt;&lt;a href="https://aimsclub.fhi-berlin.mpg.de/"&gt;FHI-aims&lt;/a&gt; is an all-electron full-potential code based on the numerical atom-centered orbital basis functions &lt;a href="https://www.sciencedirect.com/science/article/pii/S0010465509002033"&gt;[Blum]&lt;/a&gt;. One advantage of FHI-aims implementation is the correct description of the cusp of the electron density in the core region near the nuclei. However, such cusps also raise a problem for the cube file output from the FHI-aims code. If we integrate the normal density information held in the cube file output by FHI-aims, the result can differ from the number of electrons in the system.&lt;/p&gt;
&lt;p&gt;I plot a 1D example to explain the problem.
&lt;img alt="Alt Text" src="https://yaoyi92.github.io/images/aims_bader_cusp_1d.png"&gt;&lt;/p&gt;
&lt;p&gt;As plotted in the figure, we have a 1D electron density function f defined from 0.0 to 20.0. Its integral is 4.59931, as shown in blue color in the figure. To mimic the cube file information, we evenly separate the space into 20 small "voxel" with a length of 1.0 as plotted in yellow vertical lines. The information saved in the cube files are then the values of the red vertical lines, which are the values of the f function at the center of voxels. The integral of the f function calculated in
this way is then the summation of these values, which is 4.46412. It is close to but different from the exact integral.
Such summation will be a good approximation if the f function is smooth as the electron density in the planewave pseudopotential code. For the electron density in FHI-aims code, the error can be significant due to the cusps.&lt;/p&gt;
&lt;h4&gt;Integral instead of value at the center of voxel in FHI-aims with Cube file&lt;/h4&gt;
&lt;p&gt;To solve the problem, we could save the integral in each voxel instead of the value at the voxel center in the cube file. As plotted in black, the integrals in each voxel are slightly different from the value at the voxel center, and the summation of these integrals results in the correct integration of the whole space.
Note, to calculate the integrals in these small voxels; we can evaluate electron density adaptively in theory. However, electron density calculation from a density matrix is computationally relatively expensive. 
A computationally efficient quantity to evaluate is the free atom electron density, as they are saved as spline functions centered at each atom. We can evaluate the free atom electron density adaptively to high accuracy.
Thus, the output value for total density is &lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\(\rho_{total\ density}(voxel) = \rho_{total\ density}(voxel_{center}) - \rho_{free\ atom}(voxel_{center}) + \int_{voxel} \rho_{free\ atom}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Based on my test, the output cube files integrals to a value much closer to the total number of electrons in the system. I call the quantity integrable total density.&lt;/p&gt;
&lt;h4&gt;Inputs in FHI-aims&lt;/h4&gt;
&lt;p&gt;The keyword in FHI-aims to output the integrable total density is &lt;code&gt;output cube total_density_integrable&lt;/code&gt;. Let me give two complete examples. One is the crystalline NaCl with 8 atoms in the unit cell, the other is the crystalline silicon with 8 atoms in the unit cell.&lt;/p&gt;
&lt;h5&gt;Example Crystalline NaCl&lt;/h5&gt;
&lt;p&gt;FHI-aims needs two files as inputs &lt;code&gt;control.in&lt;/code&gt; and &lt;code&gt;geometry.in&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;control.in&lt;/code&gt; &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;# &lt;span class="nv"&gt;YY&lt;/span&gt;:&lt;span class="nv"&gt;WARNING&lt;/span&gt; &lt;span class="nv"&gt;just&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;test&lt;/span&gt;
#    &lt;span class="nv"&gt;NEVER&lt;/span&gt; &lt;span class="nv"&gt;use&lt;/span&gt; &lt;span class="nv"&gt;the&lt;/span&gt; &lt;span class="nv"&gt;numerical&lt;/span&gt; &lt;span class="nv"&gt;setting&lt;/span&gt; &lt;span class="nv"&gt;here&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;productive&lt;/span&gt; &lt;span class="nv"&gt;run&lt;/span&gt;
#
# &lt;span class="nv"&gt;Physical&lt;/span&gt; &lt;span class="nv"&gt;settings&lt;/span&gt;
  &lt;span class="nv"&gt;xc&lt;/span&gt;                 &lt;span class="nv"&gt;pw91_gga&lt;/span&gt;
  &lt;span class="nv"&gt;spin&lt;/span&gt;               &lt;span class="nv"&gt;none&lt;/span&gt;
# &lt;span class="nv"&gt;k&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;point&lt;/span&gt; &lt;span class="nv"&gt;grid&lt;/span&gt;
  &lt;span class="nv"&gt;k_grid&lt;/span&gt;  &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
  &lt;span class="nv"&gt;KS_method&lt;/span&gt; &lt;span class="nv"&gt;serial&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt; &lt;span class="nv"&gt;ELSI&lt;/span&gt; &lt;span class="nv"&gt;lapack&lt;/span&gt;
  &lt;span class="nv"&gt;preconditioner&lt;/span&gt; &lt;span class="nv"&gt;none&lt;/span&gt;
  &lt;span class="nv"&gt;output&lt;/span&gt; &lt;span class="nv"&gt;cube&lt;/span&gt; &lt;span class="nv"&gt;total_density_integrable&lt;/span&gt;
  &lt;span class="nv"&gt;cube&lt;/span&gt; &lt;span class="nv"&gt;edge&lt;/span&gt; &lt;span class="mi"&gt;120&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;04737105709166667&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt; # &lt;span class="nv"&gt;these&lt;/span&gt; &lt;span class="nv"&gt;are&lt;/span&gt; &lt;span class="nv"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;unit&lt;/span&gt; &lt;span class="nv"&gt;Angstrom&lt;/span&gt;
  &lt;span class="nv"&gt;cube&lt;/span&gt; &lt;span class="nv"&gt;edge&lt;/span&gt; &lt;span class="mi"&gt;120&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;04737105709166667&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt; # &lt;span class="nv"&gt;these&lt;/span&gt; &lt;span class="nv"&gt;are&lt;/span&gt; &lt;span class="nv"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;unit&lt;/span&gt; &lt;span class="nv"&gt;Angstrom&lt;/span&gt;
  &lt;span class="nv"&gt;cube&lt;/span&gt; &lt;span class="nv"&gt;edge&lt;/span&gt; &lt;span class="mi"&gt;120&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;04737105709166667&lt;/span&gt; # &lt;span class="nv"&gt;these&lt;/span&gt; &lt;span class="nv"&gt;are&lt;/span&gt; &lt;span class="nv"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;unit&lt;/span&gt; &lt;span class="nv"&gt;Angstrom&lt;/span&gt;
  &lt;span class="nv"&gt;cube&lt;/span&gt; &lt;span class="nv"&gt;divisor&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;
  &lt;span class="nv"&gt;cube_content_unit&lt;/span&gt;  &lt;span class="nv"&gt;bohr&lt;/span&gt;
################################################################################
#
#  &lt;span class="nv"&gt;FHI&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;aims&lt;/span&gt; &lt;span class="nv"&gt;code&lt;/span&gt; &lt;span class="nv"&gt;project&lt;/span&gt;
# &lt;span class="nv"&gt;Volker&lt;/span&gt; &lt;span class="nv"&gt;Blum&lt;/span&gt;, &lt;span class="nv"&gt;Fritz&lt;/span&gt; &lt;span class="nv"&gt;Haber&lt;/span&gt; &lt;span class="nv"&gt;Institute&lt;/span&gt; &lt;span class="nv"&gt;Berlin&lt;/span&gt;, &lt;span class="mi"&gt;2009&lt;/span&gt;
#
#  &lt;span class="nv"&gt;Suggested&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;intermediate&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="nv"&gt;defaults&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;Na&lt;/span&gt; &lt;span class="nv"&gt;atom&lt;/span&gt; &lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;to&lt;/span&gt; &lt;span class="nv"&gt;be&lt;/span&gt; &lt;span class="nv"&gt;pasted&lt;/span&gt; &lt;span class="nv"&gt;into&lt;/span&gt; &lt;span class="nv"&gt;control&lt;/span&gt;.&lt;span class="nv"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;file&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;
#
#  &lt;span class="nv"&gt;See&lt;/span&gt; &lt;span class="nv"&gt;https&lt;/span&gt;:&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="nv"&gt;aaltodoc&lt;/span&gt;.&lt;span class="nv"&gt;aalto&lt;/span&gt;.&lt;span class="nv"&gt;fi&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;handle&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;123456789&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;33620&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;the&lt;/span&gt; &lt;span class="nv"&gt;report&lt;/span&gt; &lt;span class="nv"&gt;these&lt;/span&gt;
#  &lt;span class="nv"&gt;setting&lt;/span&gt; &lt;span class="nv"&gt;are&lt;/span&gt; &lt;span class="nv"&gt;based&lt;/span&gt; &lt;span class="nv"&gt;on&lt;/span&gt;
################################################################################
  &lt;span class="nv"&gt;species&lt;/span&gt;        &lt;span class="nv"&gt;Na&lt;/span&gt;
#     &lt;span class="nv"&gt;global&lt;/span&gt; &lt;span class="nv"&gt;species&lt;/span&gt; &lt;span class="nv"&gt;definitions&lt;/span&gt;
    &lt;span class="nv"&gt;nucleus&lt;/span&gt;             &lt;span class="mi"&gt;11&lt;/span&gt;
    &lt;span class="nv"&gt;mass&lt;/span&gt;                &lt;span class="mi"&gt;22&lt;/span&gt;.&lt;span class="mi"&gt;98976928&lt;/span&gt;
#
    &lt;span class="nv"&gt;l_hartree&lt;/span&gt;           &lt;span class="mi"&gt;6&lt;/span&gt;
#
    &lt;span class="nv"&gt;cut_pot&lt;/span&gt;             &lt;span class="mi"&gt;4&lt;/span&gt;.&lt;span class="mi"&gt;5&lt;/span&gt;          &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="nv"&gt;basis_dep_cutoff&lt;/span&gt;    &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="nv"&gt;e&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;
#
    &lt;span class="nv"&gt;radial_base&lt;/span&gt;         &lt;span class="mi"&gt;40&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="nv"&gt;radial_multiplier&lt;/span&gt;   &lt;span class="mi"&gt;2&lt;/span&gt;
    &lt;span class="nv"&gt;angular_grids&lt;/span&gt;       &lt;span class="nv"&gt;specified&lt;/span&gt;
      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;5925&lt;/span&gt;  &lt;span class="mi"&gt;110&lt;/span&gt;
      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;7843&lt;/span&gt;  &lt;span class="mi"&gt;194&lt;/span&gt;
      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;0201&lt;/span&gt;  &lt;span class="mi"&gt;302&lt;/span&gt;
      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;1879&lt;/span&gt;  &lt;span class="mi"&gt;434&lt;/span&gt;
#      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;3799&lt;/span&gt;  &lt;span class="mi"&gt;590&lt;/span&gt;
#      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;4503&lt;/span&gt;  &lt;span class="mi"&gt;770&lt;/span&gt;
#      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;7&lt;/span&gt;.&lt;span class="mi"&gt;0005&lt;/span&gt;  &lt;span class="mi"&gt;974&lt;/span&gt;
#      &lt;span class="nv"&gt;outer_grid&lt;/span&gt;  &lt;span class="mi"&gt;974&lt;/span&gt;
      &lt;span class="nv"&gt;outer_grid&lt;/span&gt;  &lt;span class="mi"&gt;434&lt;/span&gt;
################################################################################
#
#  &lt;span class="nv"&gt;Definition&lt;/span&gt; &lt;span class="nv"&gt;of&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;minimal&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="nv"&gt;basis&lt;/span&gt;
#
################################################################################
#     &lt;span class="nv"&gt;valence&lt;/span&gt; &lt;span class="nv"&gt;basis&lt;/span&gt; &lt;span class="nv"&gt;states&lt;/span&gt;
    &lt;span class="nv"&gt;valence&lt;/span&gt;      &lt;span class="mi"&gt;3&lt;/span&gt;  &lt;span class="nv"&gt;s&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;.
    &lt;span class="nv"&gt;valence&lt;/span&gt;      &lt;span class="mi"&gt;2&lt;/span&gt;  &lt;span class="nv"&gt;p&lt;/span&gt;   &lt;span class="mi"&gt;6&lt;/span&gt;.
#     &lt;span class="nv"&gt;ion&lt;/span&gt; &lt;span class="nv"&gt;occupancy&lt;/span&gt;
    &lt;span class="nv"&gt;ion_occ&lt;/span&gt;      &lt;span class="mi"&gt;2&lt;/span&gt;  &lt;span class="nv"&gt;s&lt;/span&gt;   &lt;span class="mi"&gt;2&lt;/span&gt;.
    &lt;span class="nv"&gt;ion_occ&lt;/span&gt;      &lt;span class="mi"&gt;2&lt;/span&gt;  &lt;span class="nv"&gt;p&lt;/span&gt;   &lt;span class="mi"&gt;6&lt;/span&gt;.
################################################################################
#
#  &lt;span class="nv"&gt;Suggested&lt;/span&gt; &lt;span class="nv"&gt;additional&lt;/span&gt; &lt;span class="nv"&gt;basis&lt;/span&gt; &lt;span class="nv"&gt;functions&lt;/span&gt;. &lt;span class="k"&gt;For&lt;/span&gt; &lt;span class="nv"&gt;production&lt;/span&gt; &lt;span class="nv"&gt;calculations&lt;/span&gt;,
#  &lt;span class="nv"&gt;uncomment&lt;/span&gt; &lt;span class="nv"&gt;them&lt;/span&gt; &lt;span class="nv"&gt;one&lt;/span&gt; &lt;span class="nv"&gt;after&lt;/span&gt; &lt;span class="nv"&gt;another&lt;/span&gt; &lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;the&lt;/span&gt; &lt;span class="nv"&gt;most&lt;/span&gt; &lt;span class="nv"&gt;important&lt;/span&gt; &lt;span class="nv"&gt;basis&lt;/span&gt; &lt;span class="nv"&gt;functions&lt;/span&gt; &lt;span class="nv"&gt;are&lt;/span&gt;
#  &lt;span class="nv"&gt;listed&lt;/span&gt; &lt;span class="nv"&gt;first&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;.
#
#  &lt;span class="nv"&gt;Constructed&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;dimers&lt;/span&gt;: &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt;, &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt;, &lt;span class="mi"&gt;3&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt;, &lt;span class="mi"&gt;3&lt;/span&gt;.&lt;span class="mi"&gt;75&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt;, &lt;span class="mi"&gt;4&lt;/span&gt;.&lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt;
#
################################################################################
#  &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;First tier&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nv"&gt;improvements&lt;/span&gt;: &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;.&lt;span class="mi"&gt;09&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt; &lt;span class="nv"&gt;to&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;.&lt;span class="mi"&gt;02&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt;
     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="nv"&gt;p&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;2&lt;/span&gt;
     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;s&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;8&lt;/span&gt;
     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;d&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;.&lt;span class="mi"&gt;8&lt;/span&gt;
#  &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;Second tier&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nv"&gt;improvements&lt;/span&gt;: &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;94&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt; &lt;span class="nv"&gt;to&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;27&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt;
     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;p&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;.&lt;span class="mi"&gt;1&lt;/span&gt;
     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;s&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;
     &lt;span class="nv"&gt;for_aux&lt;/span&gt; &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;f&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;.&lt;span class="mi"&gt;2&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;d&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;3&lt;/span&gt;
#  &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;Third tier&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nv"&gt;improvements&lt;/span&gt;: &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;83&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt; &lt;span class="nv"&gt;to&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;07&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;d&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;.&lt;span class="mi"&gt;8&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;p&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;3&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="nv"&gt;g&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;.&lt;span class="mi"&gt;6&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;p&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;85&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="nv"&gt;f&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;8&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="nv"&gt;s&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;6&lt;/span&gt;
#  &lt;span class="nv"&gt;Further&lt;/span&gt; &lt;span class="nv"&gt;basis&lt;/span&gt; &lt;span class="nv"&gt;functions&lt;/span&gt; &lt;span class="nv"&gt;that&lt;/span&gt; &lt;span class="nv"&gt;fell&lt;/span&gt; &lt;span class="nv"&gt;out&lt;/span&gt; &lt;span class="nv"&gt;of&lt;/span&gt; &lt;span class="nv"&gt;the&lt;/span&gt; &lt;span class="nv"&gt;optimization&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nv"&gt;noise&lt;/span&gt; &lt;span class="nv"&gt;level&lt;/span&gt;...
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="nv"&gt;g&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;1&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;d&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;.&lt;span class="mi"&gt;4&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;s&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;1&lt;/span&gt;
################################################################################
#
#  &lt;span class="nv"&gt;FHI&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;aims&lt;/span&gt; &lt;span class="nv"&gt;code&lt;/span&gt; &lt;span class="nv"&gt;project&lt;/span&gt;
#  &lt;span class="nv"&gt;Volker&lt;/span&gt; &lt;span class="nv"&gt;Blum&lt;/span&gt;, &lt;span class="mi"&gt;2017&lt;/span&gt;
#
#  &lt;span class="nv"&gt;Suggested&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;intermediate&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="nv"&gt;defaults&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;Cl&lt;/span&gt; &lt;span class="nv"&gt;atom&lt;/span&gt; &lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;to&lt;/span&gt; &lt;span class="nv"&gt;be&lt;/span&gt; &lt;span class="nv"&gt;pasted&lt;/span&gt; &lt;span class="nv"&gt;into&lt;/span&gt; &lt;span class="nv"&gt;control&lt;/span&gt;.&lt;span class="nv"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;file&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;
#
################################################################################
  &lt;span class="nv"&gt;species&lt;/span&gt;        &lt;span class="nv"&gt;Cl&lt;/span&gt;
#     &lt;span class="nv"&gt;global&lt;/span&gt; &lt;span class="nv"&gt;species&lt;/span&gt; &lt;span class="nv"&gt;definitions&lt;/span&gt;
    &lt;span class="nv"&gt;nucleus&lt;/span&gt;             &lt;span class="mi"&gt;17&lt;/span&gt;
    &lt;span class="nv"&gt;mass&lt;/span&gt;                &lt;span class="mi"&gt;35&lt;/span&gt;.&lt;span class="mi"&gt;453&lt;/span&gt;
#
    &lt;span class="nv"&gt;l_hartree&lt;/span&gt;           &lt;span class="mi"&gt;6&lt;/span&gt;
#
    &lt;span class="nv"&gt;cut_pot&lt;/span&gt;             &lt;span class="mi"&gt;4&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;          &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="nv"&gt;basis_dep_cutoff&lt;/span&gt;    &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="nv"&gt;e&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;
#
    &lt;span class="nv"&gt;radial_base&lt;/span&gt;         &lt;span class="mi"&gt;45&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="nv"&gt;radial_multiplier&lt;/span&gt;   &lt;span class="mi"&gt;2&lt;/span&gt;
    &lt;span class="nv"&gt;angular_grids&lt;/span&gt;       &lt;span class="nv"&gt;specified&lt;/span&gt;
      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;4412&lt;/span&gt;  &lt;span class="mi"&gt;110&lt;/span&gt;
      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;5489&lt;/span&gt;  &lt;span class="mi"&gt;194&lt;/span&gt;
      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;6734&lt;/span&gt;  &lt;span class="mi"&gt;302&lt;/span&gt;
      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;7794&lt;/span&gt;  &lt;span class="mi"&gt;434&lt;/span&gt;
#      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;9402&lt;/span&gt;  &lt;span class="mi"&gt;590&lt;/span&gt;
#      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;0779&lt;/span&gt;  &lt;span class="mi"&gt;770&lt;/span&gt;
#      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;1792&lt;/span&gt;  &lt;span class="mi"&gt;974&lt;/span&gt;
#      &lt;span class="nv"&gt;outer_grid&lt;/span&gt;  &lt;span class="mi"&gt;974&lt;/span&gt;
      &lt;span class="nv"&gt;outer_grid&lt;/span&gt;  &lt;span class="mi"&gt;434&lt;/span&gt;
################################################################################
#
#  &lt;span class="nv"&gt;Definition&lt;/span&gt; &lt;span class="nv"&gt;of&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;minimal&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="nv"&gt;basis&lt;/span&gt;
#
################################################################################
#     &lt;span class="nv"&gt;valence&lt;/span&gt; &lt;span class="nv"&gt;basis&lt;/span&gt; &lt;span class="nv"&gt;states&lt;/span&gt;
    &lt;span class="nv"&gt;valence&lt;/span&gt;      &lt;span class="mi"&gt;3&lt;/span&gt;  &lt;span class="nv"&gt;s&lt;/span&gt;   &lt;span class="mi"&gt;2&lt;/span&gt;.
    &lt;span class="nv"&gt;valence&lt;/span&gt;      &lt;span class="mi"&gt;3&lt;/span&gt;  &lt;span class="nv"&gt;p&lt;/span&gt;   &lt;span class="mi"&gt;5&lt;/span&gt;.
#     &lt;span class="nv"&gt;ion&lt;/span&gt; &lt;span class="nv"&gt;occupancy&lt;/span&gt;
    &lt;span class="nv"&gt;ion_occ&lt;/span&gt;      &lt;span class="mi"&gt;3&lt;/span&gt;  &lt;span class="nv"&gt;s&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;.
    &lt;span class="nv"&gt;ion_occ&lt;/span&gt;      &lt;span class="mi"&gt;3&lt;/span&gt;  &lt;span class="nv"&gt;p&lt;/span&gt;   &lt;span class="mi"&gt;4&lt;/span&gt;.
################################################################################
#
#  &lt;span class="nv"&gt;Suggested&lt;/span&gt; &lt;span class="nv"&gt;additional&lt;/span&gt; &lt;span class="nv"&gt;basis&lt;/span&gt; &lt;span class="nv"&gt;functions&lt;/span&gt;. &lt;span class="k"&gt;For&lt;/span&gt; &lt;span class="nv"&gt;production&lt;/span&gt; &lt;span class="nv"&gt;calculations&lt;/span&gt;,
#  &lt;span class="nv"&gt;uncomment&lt;/span&gt; &lt;span class="nv"&gt;them&lt;/span&gt; &lt;span class="nv"&gt;one&lt;/span&gt; &lt;span class="nv"&gt;after&lt;/span&gt; &lt;span class="nv"&gt;another&lt;/span&gt; &lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;the&lt;/span&gt; &lt;span class="nv"&gt;most&lt;/span&gt; &lt;span class="nv"&gt;important&lt;/span&gt; &lt;span class="nv"&gt;basis&lt;/span&gt; &lt;span class="nv"&gt;functions&lt;/span&gt; &lt;span class="nv"&gt;are&lt;/span&gt;
#  &lt;span class="nv"&gt;listed&lt;/span&gt; &lt;span class="nv"&gt;first&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;.
#
#  &lt;span class="nv"&gt;Constructed&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;dimers&lt;/span&gt;: &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;65&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt;, &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt;, &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt;, &lt;span class="mi"&gt;3&lt;/span&gt;.&lt;span class="mi"&gt;25&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt;, &lt;span class="mi"&gt;4&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt;
#
################################################################################
#  &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;First tier&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nv"&gt;improvements&lt;/span&gt;: &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;429&lt;/span&gt;.&lt;span class="mi"&gt;57&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt; &lt;span class="nv"&gt;to&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;.&lt;span class="mi"&gt;03&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt;
     &lt;span class="nv"&gt;ionic&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;d&lt;/span&gt; &lt;span class="nv"&gt;auto&lt;/span&gt;
     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="nv"&gt;p&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;9&lt;/span&gt;
     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;f&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;.&lt;span class="mi"&gt;4&lt;/span&gt;
     &lt;span class="nv"&gt;ionic&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;s&lt;/span&gt; &lt;span class="nv"&gt;auto&lt;/span&gt;
     &lt;span class="nv"&gt;for_aux&lt;/span&gt;     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="nv"&gt;g&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;.&lt;span class="mi"&gt;4&lt;/span&gt;
#  &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;Second tier&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nv"&gt;improvements&lt;/span&gt;: &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;.&lt;span class="mi"&gt;84&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt; &lt;span class="nv"&gt;to&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;48&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;d&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;.&lt;span class="mi"&gt;3&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="nv"&gt;f&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;.&lt;span class="mi"&gt;8&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="nv"&gt;s&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;75&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="nv"&gt;g&lt;/span&gt; &lt;span class="mi"&gt;11&lt;/span&gt;.&lt;span class="mi"&gt;2&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;p&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;.&lt;span class="mi"&gt;4&lt;/span&gt;
#  &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;Third tier&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nv"&gt;improvements&lt;/span&gt;: &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;00&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt; &lt;span class="nv"&gt;to&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;12&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;d&lt;/span&gt; &lt;span class="mi"&gt;12&lt;/span&gt;.&lt;span class="mi"&gt;8&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;f&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;.&lt;span class="mi"&gt;6&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;d&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;.&lt;span class="mi"&gt;8&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="nv"&gt;s&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;8&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;p&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;
#  &lt;span class="nv"&gt;Further&lt;/span&gt; &lt;span class="nv"&gt;functions&lt;/span&gt; &lt;span class="nv"&gt;that&lt;/span&gt; &lt;span class="nv"&gt;fell&lt;/span&gt; &lt;span class="nv"&gt;out&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nv"&gt;improvements&lt;/span&gt;: &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt; &lt;span class="nv"&gt;and&lt;/span&gt; &lt;span class="nv"&gt;below&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="nv"&gt;f&lt;/span&gt; &lt;span class="mi"&gt;14&lt;/span&gt;.&lt;span class="mi"&gt;4&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;s&lt;/span&gt; &lt;span class="mi"&gt;12&lt;/span&gt;.&lt;span class="mi"&gt;8&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;d&lt;/span&gt; &lt;span class="mi"&gt;11&lt;/span&gt;.&lt;span class="mi"&gt;6&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;s&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;.&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;geometry.in&lt;/code&gt; &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;lattice_vector 5.6845268510 0.0 0.0
lattice_vector 0.0 5.6845268510 0.0
lattice_vector 0.0 0.0 5.6845268510
atom_frac 0.75   0.25   0.25  Na
atom_frac 0.25   0.75   0.25  Na
atom_frac 0.25   0.25   0.75  Na
atom_frac 0.75   0.75   0.75  Na
atom_frac 0.25   0.25   0.25  Cl
atom_frac 0.75   0.75   0.25  Cl
atom_frac 0.75   0.25   0.75  Cl
atom_frac 0.25   0.75   0.75  Cl
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h5&gt;Example Crystalline Silicon&lt;/h5&gt;
&lt;p&gt;&lt;code&gt;control.in&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;# &lt;span class="nv"&gt;YY&lt;/span&gt;:&lt;span class="nv"&gt;WARNING&lt;/span&gt; &lt;span class="nv"&gt;just&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;test&lt;/span&gt;
#    &lt;span class="nv"&gt;NEVER&lt;/span&gt; &lt;span class="nv"&gt;use&lt;/span&gt; &lt;span class="nv"&gt;the&lt;/span&gt; &lt;span class="nv"&gt;numerical&lt;/span&gt; &lt;span class="nv"&gt;setting&lt;/span&gt; &lt;span class="nv"&gt;here&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;productive&lt;/span&gt; &lt;span class="nv"&gt;run&lt;/span&gt;
#
# &lt;span class="nv"&gt;Physical&lt;/span&gt; &lt;span class="nv"&gt;settings&lt;/span&gt;
  &lt;span class="nv"&gt;xc&lt;/span&gt;                 &lt;span class="nv"&gt;pbe&lt;/span&gt;
  &lt;span class="nv"&gt;spin&lt;/span&gt;               &lt;span class="nv"&gt;none&lt;/span&gt;

# &lt;span class="nv"&gt;k&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;point&lt;/span&gt; &lt;span class="nv"&gt;grid&lt;/span&gt;
  &lt;span class="nv"&gt;k_grid&lt;/span&gt;  &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;

  &lt;span class="nv"&gt;KS_method&lt;/span&gt; &lt;span class="nv"&gt;serial&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt; &lt;span class="nv"&gt;ELSI&lt;/span&gt; &lt;span class="nv"&gt;lapack&lt;/span&gt;

  &lt;span class="nv"&gt;output&lt;/span&gt; &lt;span class="nv"&gt;cube&lt;/span&gt; &lt;span class="nv"&gt;total_density_integrable&lt;/span&gt;
  &lt;span class="nv"&gt;cube&lt;/span&gt; &lt;span class="nv"&gt;divisor&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;
  &lt;span class="nv"&gt;cube_content_unit&lt;/span&gt;  &lt;span class="nv"&gt;bohr&lt;/span&gt;

################################################################################
#
#  &lt;span class="nv"&gt;FHI&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;aims&lt;/span&gt; &lt;span class="nv"&gt;code&lt;/span&gt; &lt;span class="nv"&gt;project&lt;/span&gt;
#  &lt;span class="nv"&gt;Volker&lt;/span&gt; &lt;span class="nv"&gt;Blum&lt;/span&gt;, &lt;span class="mi"&gt;2017&lt;/span&gt;
#
#  &lt;span class="nv"&gt;Suggested&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;intermediate&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="nv"&gt;defaults&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;Si&lt;/span&gt; &lt;span class="nv"&gt;atom&lt;/span&gt; &lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;to&lt;/span&gt; &lt;span class="nv"&gt;be&lt;/span&gt; &lt;span class="nv"&gt;pasted&lt;/span&gt; &lt;span class="nv"&gt;into&lt;/span&gt; &lt;span class="nv"&gt;control&lt;/span&gt;.&lt;span class="nv"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;file&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;
#
################################################################################
  &lt;span class="nv"&gt;species&lt;/span&gt;        &lt;span class="nv"&gt;Si&lt;/span&gt;
#     &lt;span class="nv"&gt;global&lt;/span&gt; &lt;span class="nv"&gt;species&lt;/span&gt; &lt;span class="nv"&gt;definitions&lt;/span&gt;
    &lt;span class="nv"&gt;nucleus&lt;/span&gt;             &lt;span class="mi"&gt;14&lt;/span&gt;
    &lt;span class="nv"&gt;mass&lt;/span&gt;                &lt;span class="mi"&gt;28&lt;/span&gt;.&lt;span class="mi"&gt;0855&lt;/span&gt;
#
    &lt;span class="nv"&gt;l_hartree&lt;/span&gt;           &lt;span class="mi"&gt;6&lt;/span&gt;
#
    &lt;span class="nv"&gt;cut_pot&lt;/span&gt;             &lt;span class="mi"&gt;4&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;          &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="nv"&gt;basis_dep_cutoff&lt;/span&gt;    &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="nv"&gt;e&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;
#
    &lt;span class="nv"&gt;radial_base&lt;/span&gt;         &lt;span class="mi"&gt;42&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="nv"&gt;radial_multiplier&lt;/span&gt;   &lt;span class="mi"&gt;2&lt;/span&gt;
    &lt;span class="nv"&gt;angular_grids&lt;/span&gt;       &lt;span class="nv"&gt;specified&lt;/span&gt;
      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;4121&lt;/span&gt;   &lt;span class="mi"&gt;50&lt;/span&gt;
      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;7665&lt;/span&gt;  &lt;span class="mi"&gt;110&lt;/span&gt;
      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;0603&lt;/span&gt;  &lt;span class="mi"&gt;194&lt;/span&gt;
      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;2846&lt;/span&gt;  &lt;span class="mi"&gt;302&lt;/span&gt;
      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;4125&lt;/span&gt;  &lt;span class="mi"&gt;434&lt;/span&gt;
#      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;4810&lt;/span&gt;  &lt;span class="mi"&gt;590&lt;/span&gt;
#      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;5529&lt;/span&gt;  &lt;span class="mi"&gt;770&lt;/span&gt;
#      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;6284&lt;/span&gt;  &lt;span class="mi"&gt;974&lt;/span&gt;
#      &lt;span class="nv"&gt;division&lt;/span&gt;   &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;6016&lt;/span&gt; &lt;span class="mi"&gt;1202&lt;/span&gt;
#      &lt;span class="nv"&gt;outer_grid&lt;/span&gt;   &lt;span class="mi"&gt;974&lt;/span&gt;
      &lt;span class="nv"&gt;outer_grid&lt;/span&gt;  &lt;span class="mi"&gt;434&lt;/span&gt;
################################################################################
#
#  &lt;span class="nv"&gt;Definition&lt;/span&gt; &lt;span class="nv"&gt;of&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;minimal&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="nv"&gt;basis&lt;/span&gt;
#
################################################################################
#     &lt;span class="nv"&gt;valence&lt;/span&gt; &lt;span class="nv"&gt;basis&lt;/span&gt; &lt;span class="nv"&gt;states&lt;/span&gt;
    &lt;span class="nv"&gt;valence&lt;/span&gt;      &lt;span class="mi"&gt;3&lt;/span&gt;  &lt;span class="nv"&gt;s&lt;/span&gt;   &lt;span class="mi"&gt;2&lt;/span&gt;.
    &lt;span class="nv"&gt;valence&lt;/span&gt;      &lt;span class="mi"&gt;3&lt;/span&gt;  &lt;span class="nv"&gt;p&lt;/span&gt;   &lt;span class="mi"&gt;2&lt;/span&gt;.
#     &lt;span class="nv"&gt;ion&lt;/span&gt; &lt;span class="nv"&gt;occupancy&lt;/span&gt;
    &lt;span class="nv"&gt;ion_occ&lt;/span&gt;      &lt;span class="mi"&gt;3&lt;/span&gt;  &lt;span class="nv"&gt;s&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;.
    &lt;span class="nv"&gt;ion_occ&lt;/span&gt;      &lt;span class="mi"&gt;3&lt;/span&gt;  &lt;span class="nv"&gt;p&lt;/span&gt;   &lt;span class="mi"&gt;1&lt;/span&gt;.
################################################################################
#
#  &lt;span class="nv"&gt;Suggested&lt;/span&gt; &lt;span class="nv"&gt;additional&lt;/span&gt; &lt;span class="nv"&gt;basis&lt;/span&gt; &lt;span class="nv"&gt;functions&lt;/span&gt;. &lt;span class="k"&gt;For&lt;/span&gt; &lt;span class="nv"&gt;production&lt;/span&gt; &lt;span class="nv"&gt;calculations&lt;/span&gt;,
#  &lt;span class="nv"&gt;uncomment&lt;/span&gt; &lt;span class="nv"&gt;them&lt;/span&gt; &lt;span class="nv"&gt;one&lt;/span&gt; &lt;span class="nv"&gt;after&lt;/span&gt; &lt;span class="nv"&gt;another&lt;/span&gt; &lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;the&lt;/span&gt; &lt;span class="nv"&gt;most&lt;/span&gt; &lt;span class="nv"&gt;important&lt;/span&gt; &lt;span class="nv"&gt;basis&lt;/span&gt; &lt;span class="nv"&gt;functions&lt;/span&gt; &lt;span class="nv"&gt;are&lt;/span&gt;
#  &lt;span class="nv"&gt;listed&lt;/span&gt; &lt;span class="nv"&gt;first&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;.
#
#  &lt;span class="nv"&gt;Constructed&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;dimers&lt;/span&gt;: &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;75&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt;, &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt;, &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;25&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt;, &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;75&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt;, &lt;span class="mi"&gt;3&lt;/span&gt;.&lt;span class="mi"&gt;75&lt;/span&gt; &lt;span class="nv"&gt;A&lt;/span&gt;
#
################################################################################
#  &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;First tier&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nv"&gt;improvements&lt;/span&gt;: &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;571&lt;/span&gt;.&lt;span class="mi"&gt;96&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt; &lt;span class="nv"&gt;to&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;37&lt;/span&gt;.&lt;span class="mi"&gt;03&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt;
     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;d&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;.&lt;span class="mi"&gt;2&lt;/span&gt;
     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="nv"&gt;p&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;4&lt;/span&gt;
     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;f&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;.&lt;span class="mi"&gt;2&lt;/span&gt;
     &lt;span class="nv"&gt;ionic&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;s&lt;/span&gt; &lt;span class="nv"&gt;auto&lt;/span&gt;
#  &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;Second tier&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nv"&gt;improvements&lt;/span&gt;: &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;.&lt;span class="mi"&gt;76&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt; &lt;span class="nv"&gt;to&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;.&lt;span class="mi"&gt;03&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;d&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;
&lt;span class="nv"&gt;for_aux&lt;/span&gt;     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="nv"&gt;g&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;.&lt;span class="mi"&gt;4&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;p&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="nv"&gt;s&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;65&lt;/span&gt;
#  &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;Third tier&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nv"&gt;improvements&lt;/span&gt;: &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;.&lt;span class="mi"&gt;89&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt; &lt;span class="nv"&gt;to&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;60&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt;
#     &lt;span class="nv"&gt;ionic&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;d&lt;/span&gt; &lt;span class="nv"&gt;auto&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;s&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;6&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;f&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;.&lt;span class="mi"&gt;4&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;d&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;.&lt;span class="mi"&gt;4&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;p&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;.&lt;span class="mi"&gt;8&lt;/span&gt;
#  &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="s"&gt;Fourth tier&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nv"&gt;improvements&lt;/span&gt;: &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;33&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt; &lt;span class="nv"&gt;to&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;11&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="nv"&gt;p&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;6&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="nv"&gt;g&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;.&lt;span class="mi"&gt;8&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="nv"&gt;f&lt;/span&gt; &lt;span class="mi"&gt;11&lt;/span&gt;.&lt;span class="mi"&gt;2&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="nv"&gt;d&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;s&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;.&lt;span class="mi"&gt;5&lt;/span&gt;
#  &lt;span class="nv"&gt;Further&lt;/span&gt; &lt;span class="nv"&gt;basis&lt;/span&gt; &lt;span class="nv"&gt;functions&lt;/span&gt; &lt;span class="nv"&gt;that&lt;/span&gt; &lt;span class="nv"&gt;fell&lt;/span&gt; &lt;span class="nv"&gt;out&lt;/span&gt; &lt;span class="nv"&gt;of&lt;/span&gt; &lt;span class="nv"&gt;the&lt;/span&gt; &lt;span class="nv"&gt;optimization&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="nv"&gt;noise&lt;/span&gt;
#  &lt;span class="nv"&gt;level&lt;/span&gt;... &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;08&lt;/span&gt; &lt;span class="nv"&gt;meV&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;d&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;.&lt;span class="mi"&gt;6&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="nv"&gt;g&lt;/span&gt; &lt;span class="mi"&gt;16&lt;/span&gt;.&lt;span class="mi"&gt;4&lt;/span&gt;
#     &lt;span class="nv"&gt;hydro&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="nv"&gt;d&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;geometry.in&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;lattice_vector 5.43 0.0000000000000000 0.0000000000000000
lattice_vector 0.0000000000000000 5.43 0.0000000000000000
lattice_vector 0.0000000000000000 0.0000000000000000 5.43
atom 0.0000000000000000 0.0000000000000000 0.0000000000000000 Si
atom 1.3575000000000000 1.3575000000000000 1.3575000000000000 Si
atom 0.0000000000000000 2.7150000000000000 2.7150000000000000 Si
atom 1.3575000000000000 4.0725000000000000 4.0725000000000000 Si
atom 2.7150000000000000 0.0000000000000000 2.7150000000000000 Si
atom 4.0725000000000000 1.3575000000000000 4.0725000000000000 Si
atom 2.7150000000000000 2.7150000000000000 0.0000000000000000 Si
atom 4.0725000000000000 4.0725000000000000 1.3575000000000000 Si
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4&gt;How to perform Bader analysis on the output cube files&lt;/h4&gt;
&lt;p&gt;Codes exist to perform Bader analysis on cube files, here I have two recommendations. One is the &lt;a href="http://theory.cm.utexas.edu/henkelman/code/bader/"&gt;Bader code&lt;/a&gt; by Henkelman's Group. The other is the &lt;a href="https://aoterodelaroza.github.io/critic2/"&gt;Critic2 code&lt;/a&gt; by Alberto's Group.&lt;/p&gt;
&lt;h5&gt;Bader code&lt;/h5&gt;
&lt;p&gt;The way to run the Bader code is quite intuitive. Here is an example command line for the Bader analysis.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;bader -vac 0 cube_001_total_density_integrable.cube&lt;/code&gt; 
The output file &lt;code&gt;ACF.dat&lt;/code&gt; shows the number of electrons associate with each atom. Here is the example of crystalline NaCl.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    #         X           Y           Z       CHARGE      MIN DIST   ATOMIC VOL
 --------------------------------------------------------------------------------
    1    8.056649    2.685550    2.685550   10.134933     2.127317    66.679119
    2    2.685550    8.056649    2.685550   10.134933     2.127317    66.679119
    3    2.685550    2.685550    8.056649   10.134933     2.127317    66.679119
    4    8.056649    8.056649    8.056649   10.134933     2.127313    66.679119
    5    2.685550    2.685550    2.685550   17.863308     3.089009   242.798590
    6    8.056649    8.056649    2.685550   17.865052     3.088990   243.331581
    7    8.056649    2.685550    8.056649   17.866106     3.088990   243.652954
    8    2.685550    8.056649    8.056649   17.864259     3.088990   243.081226
 --------------------------------------------------------------------------------
    VACUUM CHARGE:               0.0000
    VACUUM VOLUME:               0.0000
    NUMBER OF ELECTRONS:       111.9985
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h5&gt;Critic2 code&lt;/h5&gt;
&lt;p&gt;The critic2 code is more versatile. It is basically a general code to perform all kinds of operators on some fields. Here we present a simple input for the same Bader analysis of Yu-Trinkle type.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;critic2.in&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# Read the structure from any of the cube files&lt;/span&gt;
&lt;span class="n"&gt;crystal&lt;/span&gt; &lt;span class="n"&gt;cube_001_total_density_integrable&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;

&lt;span class="c1"&gt;# Load the electron density&lt;/span&gt;
&lt;span class="nb"&gt;load&lt;/span&gt; &lt;span class="n"&gt;cube_001_total_density_integrable&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="n"&gt;rho&lt;/span&gt;

&lt;span class="c1"&gt;# Use Bader.&lt;/span&gt;
&lt;span class="n"&gt;bader&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then we run the code via commandline.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;critic2 critic2.in &amp;gt; critic2.out&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;We can take a look at the &lt;code&gt;critic2.out&lt;/code&gt; file. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nv"&gt;Integrated&lt;/span&gt; &lt;span class="nv"&gt;atomic&lt;/span&gt; &lt;span class="nv"&gt;properties&lt;/span&gt;
# &lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;See&lt;/span&gt; &lt;span class="nv"&gt;key&lt;/span&gt; &lt;span class="nv"&gt;above&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;interpretation&lt;/span&gt; &lt;span class="nv"&gt;of&lt;/span&gt; &lt;span class="nv"&gt;column&lt;/span&gt; &lt;span class="nv"&gt;headings&lt;/span&gt;.&lt;span class="ss"&gt;)&lt;/span&gt;
# &lt;span class="nv"&gt;Integrable&lt;/span&gt; &lt;span class="nv"&gt;properties&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="nv"&gt;to&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;
# &lt;span class="nv"&gt;Id&lt;/span&gt;   &lt;span class="nv"&gt;cp&lt;/span&gt;   &lt;span class="nv"&gt;ncp&lt;/span&gt;   &lt;span class="nv"&gt;Name&lt;/span&gt;  &lt;span class="nv"&gt;Z&lt;/span&gt;   &lt;span class="nv"&gt;mult&lt;/span&gt;     &lt;span class="nv"&gt;Volume&lt;/span&gt;            &lt;span class="nv"&gt;Pop&lt;/span&gt;             &lt;span class="nv"&gt;Lap&lt;/span&gt;
  &lt;span class="mi"&gt;1&lt;/span&gt;    &lt;span class="mi"&gt;1&lt;/span&gt;    &lt;span class="mi"&gt;1&lt;/span&gt;      &lt;span class="nv"&gt;Na&lt;/span&gt;   &lt;span class="mi"&gt;11&lt;/span&gt;  &lt;span class="o"&gt;--&lt;/span&gt;   &lt;span class="mi"&gt;6&lt;/span&gt;.&lt;span class="mi"&gt;66791186&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;01&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;01349330&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;01&lt;/span&gt;  &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;37946134&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;02&lt;/span&gt;
  &lt;span class="mi"&gt;2&lt;/span&gt;    &lt;span class="mi"&gt;2&lt;/span&gt;    &lt;span class="mi"&gt;1&lt;/span&gt;      &lt;span class="nv"&gt;Na&lt;/span&gt;   &lt;span class="mi"&gt;11&lt;/span&gt;  &lt;span class="o"&gt;--&lt;/span&gt;   &lt;span class="mi"&gt;6&lt;/span&gt;.&lt;span class="mi"&gt;66791186&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;01&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;01349330&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;01&lt;/span&gt;  &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;37946061&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;02&lt;/span&gt;
  &lt;span class="mi"&gt;3&lt;/span&gt;    &lt;span class="mi"&gt;3&lt;/span&gt;    &lt;span class="mi"&gt;1&lt;/span&gt;      &lt;span class="nv"&gt;Na&lt;/span&gt;   &lt;span class="mi"&gt;11&lt;/span&gt;  &lt;span class="o"&gt;--&lt;/span&gt;   &lt;span class="mi"&gt;6&lt;/span&gt;.&lt;span class="mi"&gt;66791186&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;01&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;01349330&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;01&lt;/span&gt;  &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;37946091&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;02&lt;/span&gt;
  &lt;span class="mi"&gt;4&lt;/span&gt;    &lt;span class="mi"&gt;4&lt;/span&gt;    &lt;span class="mi"&gt;1&lt;/span&gt;      &lt;span class="nv"&gt;Na&lt;/span&gt;   &lt;span class="mi"&gt;11&lt;/span&gt;  &lt;span class="o"&gt;--&lt;/span&gt;   &lt;span class="mi"&gt;6&lt;/span&gt;.&lt;span class="mi"&gt;66791186&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;01&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;01349330&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;01&lt;/span&gt;  &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;37946131&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;02&lt;/span&gt;
  &lt;span class="mi"&gt;5&lt;/span&gt;    &lt;span class="mi"&gt;5&lt;/span&gt;    &lt;span class="mi"&gt;2&lt;/span&gt;      &lt;span class="nv"&gt;Cl&lt;/span&gt;   &lt;span class="mi"&gt;17&lt;/span&gt;  &lt;span class="o"&gt;--&lt;/span&gt;   &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;42798590&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;02&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;78633076&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;01&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;72005475&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;02&lt;/span&gt;
  &lt;span class="mi"&gt;6&lt;/span&gt;    &lt;span class="mi"&gt;6&lt;/span&gt;    &lt;span class="mi"&gt;2&lt;/span&gt;      &lt;span class="nv"&gt;Cl&lt;/span&gt;   &lt;span class="mi"&gt;17&lt;/span&gt;  &lt;span class="o"&gt;--&lt;/span&gt;   &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;43331581&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;02&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;78650521&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;01&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;28806825&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;02&lt;/span&gt;
  &lt;span class="mi"&gt;7&lt;/span&gt;    &lt;span class="mi"&gt;7&lt;/span&gt;    &lt;span class="mi"&gt;2&lt;/span&gt;      &lt;span class="nv"&gt;Cl&lt;/span&gt;   &lt;span class="mi"&gt;17&lt;/span&gt;  &lt;span class="o"&gt;--&lt;/span&gt;   &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;43652954&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;02&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;78661064&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;01&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;02729109&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;02&lt;/span&gt;
  &lt;span class="mi"&gt;8&lt;/span&gt;    &lt;span class="mi"&gt;8&lt;/span&gt;    &lt;span class="mi"&gt;2&lt;/span&gt;      &lt;span class="nv"&gt;Cl&lt;/span&gt;   &lt;span class="mi"&gt;17&lt;/span&gt;  &lt;span class="o"&gt;--&lt;/span&gt;   &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;43081226&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;02&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;78642592&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;01&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;48243008&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;02&lt;/span&gt;
&lt;span class="o"&gt;--------------------------------------------------------------------------------&lt;/span&gt;
  &lt;span class="nv"&gt;Sum&lt;/span&gt;                            &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;23958083&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;03&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt;.&lt;span class="mi"&gt;11998457&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;02&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;.&lt;span class="mi"&gt;66990638&lt;/span&gt;&lt;span class="nv"&gt;E&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Clearly, the outputs from Bader and critic2 codes match with each other.&lt;/p&gt;
&lt;p&gt;With critic2, we can calculate more quantities than the Bader integrals. For example, we can plot &lt;a href="https://doi.org/10.1021/ct100641a"&gt;NCIPLOT&lt;/a&gt; with critic2 with the input &lt;code&gt;critic2_nci.in&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# Read the structure from any of the cube files&lt;/span&gt;
&lt;span class="n"&gt;crystal&lt;/span&gt; &lt;span class="n"&gt;cube_001_total_density_integrable&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt;

&lt;span class="c1"&gt;# Load the electron density&lt;/span&gt;
&lt;span class="nb"&gt;load&lt;/span&gt; &lt;span class="n"&gt;cube_001_total_density_integrable&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cube&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="n"&gt;rho&lt;/span&gt;

&lt;span class="c1"&gt;#NCIplot&lt;/span&gt;
&lt;span class="n"&gt;NCIPLOT&lt;/span&gt;
&lt;span class="n"&gt;END&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The result can be visualized in VMD via command &lt;code&gt;vmd -e critic2_nci.vmd&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt Text" src="https://yaoyi92.github.io/images/aims_bader_nciplot.png"&gt;&lt;/p&gt;
&lt;p&gt;For the crystalline NaCl here, this plot doesn't tell much. But, for systems with vdW interaction, hybrogen bond, or steric clashes, this plot can provide useful information.&lt;/p&gt;
&lt;h4&gt;Convergence of the integral in the integrable total density cube file output by FHI-aims.&lt;/h4&gt;
&lt;p&gt;An interesting observation I have for the cube file output is the integral of the integrable total density cube file has a convergence behavior. With the more accurate numerical settings the more accurate the total number of electrons is got.
My suspicion is the normalization of the integration grid with different setting might play a role here. Without dense enough integration setting, the integration in the atom centered integration grid will introduce a normalization error which will pass to the total number of electrons calculated by the integration of the integrable total density cube file. Luckily, the error is relatively small and will reduce with a more strict numerical setting as I showed the results for both examples.&lt;/p&gt;
&lt;p&gt;The convergence behavior for crystalline sillicon.&lt;/p&gt;
&lt;p&gt;&lt;center&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="center"&gt;Numerical Setting &lt;code&gt;&amp;nbsp;&lt;/code&gt;&lt;/th&gt;
&lt;th align="center"&gt;Integral of integrable total density cube file&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="center"&gt;Minimal&lt;/td&gt;
&lt;td align="center"&gt;111.9851&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;Light&lt;/td&gt;
&lt;td align="center"&gt;111.9909&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;Intermediate&lt;/td&gt;
&lt;td align="center"&gt;111.9966&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;Tight&lt;/td&gt;
&lt;td align="center"&gt;111.9965&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;Really tight&lt;/td&gt;
&lt;td align="center"&gt;111.9998&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;/center&gt;&lt;/p&gt;
&lt;p&gt;The convergence behavior for crystalline NaCl.&lt;/p&gt;
&lt;p&gt;&lt;center&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align="center"&gt;Numerical Setting &lt;code&gt;&amp;nbsp;&lt;/code&gt;&lt;/th&gt;
&lt;th align="center"&gt;Integral of integrable total density cube file &lt;code&gt;&amp;nbsp;&lt;/code&gt;&lt;/th&gt;
&lt;th align="center"&gt;Charge on Na &lt;code&gt;&amp;nbsp;&lt;/code&gt;&lt;/th&gt;
&lt;th align="center"&gt;Charge on Cl &lt;code&gt;&amp;nbsp;&lt;/code&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td align="center"&gt;Minimal&lt;/td&gt;
&lt;td align="center"&gt;111.9968&lt;/td&gt;
&lt;td align="center"&gt;0.8665&lt;/td&gt;
&lt;td align="center"&gt;-0.8657&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;Light&lt;/td&gt;
&lt;td align="center"&gt;111.9970&lt;/td&gt;
&lt;td align="center"&gt;0.8645&lt;/td&gt;
&lt;td align="center"&gt;-0.8638&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;Intermediate&lt;/td&gt;
&lt;td align="center"&gt;111.9985&lt;/td&gt;
&lt;td align="center"&gt;0.8651&lt;/td&gt;
&lt;td align="center"&gt;-0.8647&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;Tight&lt;/td&gt;
&lt;td align="center"&gt;111.9984&lt;/td&gt;
&lt;td align="center"&gt;0.8653&lt;/td&gt;
&lt;td align="center"&gt;-0.8649&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td align="center"&gt;Really tight&lt;/td&gt;
&lt;td align="center"&gt;111.9991&lt;/td&gt;
&lt;td align="center"&gt;0.8653&lt;/td&gt;
&lt;td align="center"&gt;-0.8651&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;/center&gt;&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="FHI-aims"></category><category term="dft"></category></entry><entry><title>SCAN TM pseudopotentials</title><link href="https://yaoyi92.github.io/scan-tm-pseudopotentials.html" rel="alternate"></link><published>2017-04-11T23:26:00+02:00</published><updated>2017-04-11T23:26:00+02:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2017-04-11:/scan-tm-pseudopotentials.html</id><summary type="html">&lt;p&gt;SCAN pseudopotentials&lt;/p&gt;</summary><content type="html">&lt;p&gt;Use at your own risk.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;th&gt;===&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="https://yaoyi92.github.io/scan_pps/H.SCAN.UPF"&gt;&lt;strong&gt;H&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://yaoyi92.github.io/scan_pps/He.SCAN.UPF"&gt;&lt;strong&gt;He&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;a href="https://yaoyi92.github.io/scan_pps/Li.SCAN.UPF"&gt;&lt;strong&gt;Li&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://yaoyi92.github.io/scan_pps/Be.SCAN.UPF"&gt;&lt;strong&gt;Be&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://yaoyi92.github.io/scan_pps/B.SCAN.UPF"&gt;&lt;strong&gt;B&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://yaoyi92.github.io/scan_pps/C.SCAN.UPF"&gt;&lt;strong&gt;C&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://yaoyi92.github.io/scan_pps/N.SCAN.UPF"&gt;&lt;strong&gt;N&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://yaoyi92.github.io/scan_pps/O.SCAN.UPF"&gt;&lt;strong&gt;O&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://yaoyi92.github.io/scan_pps/F.SCAN.UPF"&gt;&lt;strong&gt;F&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://yaoyi92.github.io/scan_pps/Ne.SCAN.UPF"&gt;&lt;strong&gt;Ne&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Na&lt;/td&gt;
&lt;td&gt;Mg&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://yaoyi92.github.io/scan_pps/Al.SCAN.UPF"&gt;&lt;strong&gt;Al&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://yaoyi92.github.io/scan_pps/Si.SCAN.UPF"&gt;&lt;strong&gt;Si&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://yaoyi92.github.io/scan_pps/P.SCAN.UPF"&gt;&lt;strong&gt;P&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://yaoyi92.github.io/scan_pps/S.SCAN.UPF"&gt;&lt;strong&gt;S&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href="https://yaoyi92.github.io/scan_pps/Cl.SCAN.UPF"&gt;&lt;strong&gt;Cl&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;Ar&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;K&lt;/td&gt;
&lt;td&gt;Ca&lt;/td&gt;
&lt;td&gt;Sc&lt;/td&gt;
&lt;td&gt;Ti&lt;/td&gt;
&lt;td&gt;V&lt;/td&gt;
&lt;td&gt;Cr&lt;/td&gt;
&lt;td&gt;Mn&lt;/td&gt;
&lt;td&gt;Fe&lt;/td&gt;
&lt;td&gt;Co&lt;/td&gt;
&lt;td&gt;Ni&lt;/td&gt;
&lt;td&gt;Cu&lt;/td&gt;
&lt;td&gt;Zn&lt;/td&gt;
&lt;td&gt;Ga&lt;/td&gt;
&lt;td&gt;&lt;a href="https://yaoyi92.github.io/scan_pps/Ge.SCAN.UPF"&gt;&lt;strong&gt;Ge&lt;/strong&gt;&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;As&lt;/td&gt;
&lt;td&gt;Se&lt;/td&gt;
&lt;td&gt;Br&lt;/td&gt;
&lt;td&gt;Kr&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Rb&lt;/td&gt;
&lt;td&gt;Sr&lt;/td&gt;
&lt;td&gt;Y&lt;/td&gt;
&lt;td&gt;Zr&lt;/td&gt;
&lt;td&gt;Nb&lt;/td&gt;
&lt;td&gt;Mo&lt;/td&gt;
&lt;td&gt;Tc&lt;/td&gt;
&lt;td&gt;Ru&lt;/td&gt;
&lt;td&gt;Rh&lt;/td&gt;
&lt;td&gt;Pd&lt;/td&gt;
&lt;td&gt;Ag&lt;/td&gt;
&lt;td&gt;Cd&lt;/td&gt;
&lt;td&gt;In&lt;/td&gt;
&lt;td&gt;Sn&lt;/td&gt;
&lt;td&gt;Sb&lt;/td&gt;
&lt;td&gt;Te&lt;/td&gt;
&lt;td&gt;I&lt;/td&gt;
&lt;td&gt;Xe&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Cs&lt;/td&gt;
&lt;td&gt;Ba&lt;/td&gt;
&lt;td&gt;La&lt;/td&gt;
&lt;td&gt;Hf&lt;/td&gt;
&lt;td&gt;Ta&lt;/td&gt;
&lt;td&gt;W&lt;/td&gt;
&lt;td&gt;Re&lt;/td&gt;
&lt;td&gt;Os&lt;/td&gt;
&lt;td&gt;Ir&lt;/td&gt;
&lt;td&gt;Pt&lt;/td&gt;
&lt;td&gt;Au&lt;/td&gt;
&lt;td&gt;Hg&lt;/td&gt;
&lt;td&gt;Tl&lt;/td&gt;
&lt;td&gt;Pb&lt;/td&gt;
&lt;td&gt;Bi&lt;/td&gt;
&lt;td&gt;Po&lt;/td&gt;
&lt;td&gt;At&lt;/td&gt;
&lt;td&gt;Rn&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Fr&lt;/td&gt;
&lt;td&gt;Ra&lt;/td&gt;
&lt;td&gt;Ac&lt;/td&gt;
&lt;td&gt;Rf&lt;/td&gt;
&lt;td&gt;Db&lt;/td&gt;
&lt;td&gt;Sg&lt;/td&gt;
&lt;td&gt;Rh&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1&gt;reference:&lt;/h1&gt;
&lt;p&gt;The Journal of Chemical Physics 146, 224105 (2017)&lt;/p&gt;</content><category term="DFT"></category><category term="DFT"></category></entry><entry><title>tricubic interpolation</title><link href="https://yaoyi92.github.io/tricubic-interpolation.html" rel="alternate"></link><published>2017-02-13T10:00:00+01:00</published><updated>2017-02-13T10:00:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2017-02-13:/tricubic-interpolation.html</id><summary type="html">&lt;p&gt;tricubic interpolation&lt;/p&gt;</summary><content type="html">&lt;p&gt;When dealing with charge density data or wave function data stored in a cube file, I sometimes would like to find a charge density in a specific point in the space. However, only density on grid is stored in the file. Interpolation is necessary for this purpose. In scipy, scipy.interpolate.RegularGridInterpolator can be used for 3d interpolation, but only "nearest" and "linear" method is available. In order to get high presicion, &lt;a href="http://onlinelibrary.wiley.com/doi/10.1002/nme.1296/full"&gt;Tricubic&lt;/a&gt; interpolation could help. In two packages, this function is available. &lt;a href="https://github.com/danielguterding/pytricubic"&gt;pytricubic&lt;/a&gt; and &lt;a href="https://eqtools.readthedocs.io/en/latest/eqtools.html#module-eqtools.trispline"&gt;eqtools&lt;/a&gt;, I tried both and both works fine. I would recommend the eqtools since it is easy to install and doesnt have a dependence on Eigen or boost.&lt;/p&gt;
&lt;p&gt;Here I give a small test script for comparison of nearst, linear, and tricubic interpolation accuracy.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;scipy.interpolate&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;RegularGridInterpolator&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;eqtools.trispline&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Spline&lt;/span&gt;
&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;
&lt;span class="n"&gt;xgrid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ygrid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;zgrid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;dtype&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;float&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xgrid&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;\
                         &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;ygrid&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;\
                         &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;zgrid&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;interpolating_function_tricubic&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Spline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;xgrid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;ygrid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;zgrid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;interpolating_function&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;RegularGridInterpolator&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;xgrid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;ygrid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;zgrid&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;linear&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;interpolating_function_nearest&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;RegularGridInterpolator&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;xgrid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;ygrid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;zgrid&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;nearest&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt;
&lt;span class="n"&gt;error_nearest&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;error&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;error_tricubic&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;xgrid_d&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ygrid_d&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;zgrid_d&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;error&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt;  &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;interpolating_function&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;xgrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;ygrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;zgrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; \
                         &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xgrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;\
                         &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;ygrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;\
                         &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;zgrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]))[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="n"&gt;error_nearest&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt;  &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;interpolating_function_nearest&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;xgrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;ygrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;zgrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; \
                         &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xgrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;\
                         &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;ygrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;\
                         &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;zgrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]))[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="n"&gt;error_tricubic&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt;  &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;interpolating_function_tricubic&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ev&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;\
                         &lt;span class="n"&gt;xgrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;ygrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;zgrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;\
                         &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;xgrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;\
                         &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;ygrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;\
                         &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;zgrid_d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]))[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;average error for nearest, linear, and tricubic interpolation&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;error_nearest&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;error_tricubic&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;It gave such result, showing better accuracy for tricubic interpolation.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;average&lt;/span&gt; &lt;span class="nv"&gt;error&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;nearest&lt;/span&gt;, &lt;span class="nv"&gt;linear&lt;/span&gt;, &lt;span class="nv"&gt;and&lt;/span&gt; &lt;span class="nv"&gt;tricubic&lt;/span&gt; &lt;span class="nv"&gt;interpolation&lt;/span&gt;
&lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;0479790688641&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;0103316526679&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;000350221662438&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="python"></category><category term="python"></category></entry><entry><title>molecular dynamics simulations by gromacs lammps cpmd cp2k cp.x qbox from scratch</title><link href="https://yaoyi92.github.io/molecular-dynamics-simulations-by-gromacs-lammps-cpmd-cp2k-cpx-qbox-from-scratch.html" rel="alternate"></link><published>2017-01-09T10:00:00+01:00</published><updated>2017-01-09T10:00:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2017-01-09:/molecular-dynamics-simulations-by-gromacs-lammps-cpmd-cp2k-cpx-qbox-from-scratch.html</id><summary type="html">&lt;p&gt;FPMD setup&lt;/p&gt;</summary><content type="html">&lt;p&gt;Example of setting up first principle molecular dynamics (FPMD) simulation from scratch. &lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;In FPMD simulations for liquids, usually, a classical MD simulation is needed to equilibrate the system. I gave examples of using gromacs and lammps as classical MD simulator and cpmd, cp2k, cp.x, qbox as FPMD simulator. The system of 55 water at room temperature is used as the example.    &lt;/p&gt;
&lt;p&gt;From scratch means I generate the initial structure from the water molecular structure.   &lt;/p&gt;
&lt;p&gt;In this post, 3 steps are listed.  &lt;br&gt;
1. generating initial structure  &lt;br&gt;
2. equilibrate the system by classical MD  ( 2.1 gromacs code, 2.2 lammps code )  &lt;br&gt;
3. running a short FPMD simulation ( 3.1 cpmd code 3.2 cp2k code 3.3 cp.x code 3.4 qbox code )&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;softwares used:
&lt;a href="http://www.ks.uiuc.edu/Research/vmd/"&gt;VMD&lt;/a&gt;
&lt;a href="http://www.ime.unicamp.br/~martinez/packmol/home.shtml"&gt;packmol&lt;/a&gt;
&lt;a href="http://www.gromacs.org/"&gt;gromacs&lt;/a&gt;
&lt;a href="http://lammps.sandia.gov/"&gt;lammps&lt;/a&gt;
&lt;a href="http://www.cpmd.org/"&gt;cpmd&lt;/a&gt;
&lt;a href="https://www.cp2k.org/"&gt;cp2k&lt;/a&gt;
&lt;a href="http://www.quantum-espresso.org/"&gt;cp.x quantum-espresso&lt;/a&gt;
&lt;a href="http://eslab.ucdavis.edu/software/qbox/"&gt;qbox&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3&gt;0 download the files&lt;/h3&gt;
&lt;p&gt;All the files needed are included here.  &lt;/p&gt;
&lt;p&gt;&lt;a href="https://yaoyi92.github.io/codes/AIMD_setup.tar.gz"&gt;AIMD_setup.tar.gz&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3&gt;1.1 generate initial structure for gromacs&lt;/h3&gt;
&lt;p&gt;Note: in gromacs, genbox command can be used to generate a water box. Here I use packmol to generate the input structure and convert it to gro file as input.&lt;/p&gt;
&lt;p&gt;The water structure is as follow (water.xyz):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mf"&gt;3&lt;/span&gt;

&lt;span class="n"&gt;OW&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;HW1&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.81649&lt;/span&gt; &lt;span class="mf"&gt;0.57736&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;HW2&lt;/span&gt; &lt;span class="mf"&gt;0.81649&lt;/span&gt; &lt;span class="mf"&gt;0.57736&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;a packmol input (water55_packmol.in) script is used here to generate the structure of the total system.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;tolerance&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="nv"&gt;filetype&lt;/span&gt; &lt;span class="nv"&gt;xyz&lt;/span&gt;
&lt;span class="nv"&gt;output&lt;/span&gt; &lt;span class="nv"&gt;water55&lt;/span&gt;.&lt;span class="nv"&gt;xyz&lt;/span&gt;

&lt;span class="nv"&gt;structure&lt;/span&gt; &lt;span class="nv"&gt;water&lt;/span&gt;.&lt;span class="nv"&gt;xyz&lt;/span&gt;
  &lt;span class="nv"&gt;number&lt;/span&gt; &lt;span class="mi"&gt;55&lt;/span&gt;
  &lt;span class="nv"&gt;inside&lt;/span&gt; &lt;span class="nv"&gt;box&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;0&lt;/span&gt;.  &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;10&lt;/span&gt;.&lt;span class="mi"&gt;8172&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;.&lt;span class="mi"&gt;8172&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;.&lt;span class="mi"&gt;8172&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nv"&gt;structure&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And also I have a python script for the convertion from xyz to gro file (convert_xyz_to_gro.py), the class mdsystem.py can be download here.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mdsystem&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;water55.xyz&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mdsystem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;11.8172&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;11.8172&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;11.8172&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xyzinput&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;generate_bonds&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cutoff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;molecular_detection&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;moleculars&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;molecular_names&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;SOL&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;grooutput&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="n"&gt;convert_xyz_to_gro&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;water55&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gro&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I use this structure for the input of classical molecular dynamics simulation in gromacs.&lt;/p&gt;
&lt;hr&gt;
&lt;h3&gt;1.2 generate initial structure for lammps&lt;/h3&gt;
&lt;p&gt;The water structure is as follow (water.xyz):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mf"&gt;3&lt;/span&gt;

&lt;span class="n"&gt;O&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;H&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.81649&lt;/span&gt; &lt;span class="mf"&gt;0.57736&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;H&lt;/span&gt; &lt;span class="mf"&gt;0.81649&lt;/span&gt; &lt;span class="mf"&gt;0.57736&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;a packmol input (water55_packmol.in) script is used here to generate the structure of the total system.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;tolerance&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="nv"&gt;filetype&lt;/span&gt; &lt;span class="nv"&gt;xyz&lt;/span&gt;
&lt;span class="nv"&gt;output&lt;/span&gt; &lt;span class="nv"&gt;water55&lt;/span&gt;.&lt;span class="nv"&gt;xyz&lt;/span&gt;

&lt;span class="nv"&gt;structure&lt;/span&gt; &lt;span class="nv"&gt;water&lt;/span&gt;.&lt;span class="nv"&gt;xyz&lt;/span&gt;
  &lt;span class="nv"&gt;number&lt;/span&gt; &lt;span class="mi"&gt;55&lt;/span&gt;
  &lt;span class="nv"&gt;inside&lt;/span&gt; &lt;span class="nv"&gt;box&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;0&lt;/span&gt;.  &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;10&lt;/span&gt;.&lt;span class="mi"&gt;8172&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;.&lt;span class="mi"&gt;8172&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;.&lt;span class="mi"&gt;8172&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nv"&gt;structure&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And also I have a vmd script for the generation of psf and pdb and lammps data file.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="x"&gt;mol new water55.xyz&lt;/span&gt;

&lt;span class="x"&gt;pbc set &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt; &lt;span class="m"&gt;11.8172&lt;/span&gt; &lt;span class="m"&gt;11.8172&lt;/span&gt; &lt;span class="m"&gt;11.8172&lt;/span&gt; &lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;topo clearbonds&lt;/span&gt;
&lt;span class="x"&gt;for &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt;&lt;span class="nf"&gt;set&lt;/span&gt; &lt;span class="na"&gt;i&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="m"&gt;55&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt;&lt;span class="nf"&gt;incr&lt;/span&gt; &lt;span class="na"&gt;i&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addbond&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addbond&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addangle&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;

&lt;span class="x"&gt;animate write psf water55.psf&lt;/span&gt;
&lt;span class="x"&gt;animate write pdb water55.pdb&lt;/span&gt;
&lt;span class="x"&gt;topo writelammpsdata water55.data&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I use this structure for the input of classical molecular dynamics simulation in lammps.&lt;/p&gt;
&lt;hr&gt;
&lt;h3&gt;2.1 gromacs code&lt;/h3&gt;
&lt;p&gt;for gromacs simulation, there is separate forcefield file and topology file ( spcfw.itp and water55.top ).&lt;/p&gt;
&lt;p&gt;two mdp input files needed ( min.mdp nvt.mdp ), the first one is used to minimize the structure, the second one is used for the simulation. Here is the command I use for the simulation.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;gmx grompp -f min.mdp -c water55.gro -p water55.top -o min.tpr
gmx mdrun -s min.tpr -c em.gro
gmx grompp -f nvt.mdp -c em.gro -p water55.top -o nvt.tpr
gmx mdrun -s nvt.tpr
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;In the example, I run 100ps for equlibrating the system. In real simulation, longer is usually needed.&lt;/p&gt;
&lt;p&gt;I also like to convert the trajectory so that the atom in the same molecule are not separate in the edge of the box.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;gmx trjconv -s nvt.tpr -f traj_comp.xtc -o traj_comp_whole.xtc -pbc whole &amp;lt;&amp;lt;&amp;lt; &amp;quot;0&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then, the script ( take_last_snapshot.vmd ) can be used to take the last snapshot of the simulation as the initial structure for FPMD.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;mol&lt;/span&gt; &lt;span class="nv"&gt;new&lt;/span&gt; &lt;span class="nv"&gt;water55&lt;/span&gt;.&lt;span class="nv"&gt;psf&lt;/span&gt;
&lt;span class="nv"&gt;mol&lt;/span&gt; &lt;span class="nv"&gt;addfile&lt;/span&gt; &lt;span class="nv"&gt;traj_comp_whole&lt;/span&gt;.&lt;span class="nv"&gt;xtc&lt;/span&gt; &lt;span class="nv"&gt;waitfor&lt;/span&gt; &lt;span class="nv"&gt;all&lt;/span&gt;
&lt;span class="nv"&gt;pbc&lt;/span&gt; &lt;span class="nv"&gt;wrap&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;all&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;compound&lt;/span&gt; &lt;span class="nv"&gt;residue&lt;/span&gt;
&lt;span class="nv"&gt;set&lt;/span&gt; &lt;span class="nv"&gt;nframes&lt;/span&gt; [&lt;span class="nv"&gt;molinfo&lt;/span&gt; &lt;span class="nv"&gt;top&lt;/span&gt; &lt;span class="nv"&gt;get&lt;/span&gt; &lt;span class="nv"&gt;numframes&lt;/span&gt;]
&lt;span class="nv"&gt;set&lt;/span&gt; &lt;span class="nv"&gt;nframes&lt;/span&gt; [&lt;span class="nv"&gt;expr&lt;/span&gt; $&lt;span class="nv"&gt;nframes&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;]
&lt;span class="nv"&gt;animate&lt;/span&gt; &lt;span class="nv"&gt;write&lt;/span&gt; &lt;span class="nv"&gt;xyz&lt;/span&gt; &lt;span class="nv"&gt;eq&lt;/span&gt;.&lt;span class="nv"&gt;xyz&lt;/span&gt; &lt;span class="nv"&gt;beg&lt;/span&gt; $&lt;span class="nv"&gt;nframes&lt;/span&gt;
&lt;span class="k"&gt;exit&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;hr&gt;
&lt;h3&gt;2.2 lammps code&lt;/h3&gt;
&lt;p&gt;Here we use the generated initial structure to run molecular dynamics with lammps. SPC/Fw force field is used.&lt;br&gt;
Here is the ( in.spcf ) lammps input script&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;units&lt;/span&gt;      &lt;span class="n"&gt;real&lt;/span&gt;
&lt;span class="n"&gt;dimension&lt;/span&gt;  &lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="n"&gt;boundary&lt;/span&gt;   &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;
&lt;span class="n"&gt;atom_style&lt;/span&gt; &lt;span class="n"&gt;full&lt;/span&gt;
&lt;span class="n"&gt;read_data&lt;/span&gt; &lt;span class="n"&gt;water55&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;

&lt;span class="c1"&gt;## alternate way to set charges - besides manually in data file ###&lt;/span&gt;
&lt;span class="n"&gt;group&lt;/span&gt; &lt;span class="n"&gt;ox&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;span class="n"&gt;group&lt;/span&gt; &lt;span class="n"&gt;hy&lt;/span&gt; &lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt; &lt;span class="n"&gt;group&lt;/span&gt; &lt;span class="n"&gt;ox&lt;/span&gt; &lt;span class="n"&gt;charge&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.8200&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt; &lt;span class="n"&gt;group&lt;/span&gt; &lt;span class="n"&gt;hy&lt;/span&gt; &lt;span class="n"&gt;charge&lt;/span&gt; &lt;span class="mf"&gt;0.4100&lt;/span&gt;

&lt;span class="n"&gt;pair_style&lt;/span&gt; &lt;span class="n"&gt;lj&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cut&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;coul&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;long&lt;/span&gt; &lt;span class="mf"&gt;5.9086&lt;/span&gt;
&lt;span class="n"&gt;pair_coeff&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;pair_coeff&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="mf"&gt;0.1553537&lt;/span&gt; &lt;span class="mf"&gt;3.166&lt;/span&gt;
&lt;span class="n"&gt;bond_style&lt;/span&gt;  &lt;span class="n"&gt;harmonic&lt;/span&gt;
&lt;span class="n"&gt;bond_coeff&lt;/span&gt;  &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;529.581&lt;/span&gt; &lt;span class="mf"&gt;1.0120&lt;/span&gt;
&lt;span class="n"&gt;angle_style&lt;/span&gt; &lt;span class="n"&gt;harmonic&lt;/span&gt;
&lt;span class="n"&gt;angle_coeff&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;37.95&lt;/span&gt; &lt;span class="mf"&gt;113.24&lt;/span&gt;
&lt;span class="n"&gt;kspace_style&lt;/span&gt; &lt;span class="n"&gt;ewald&lt;/span&gt; &lt;span class="mf"&gt;1.0e-5&lt;/span&gt;

&lt;span class="n"&gt;velocity&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="n"&gt;create&lt;/span&gt; &lt;span class="mf"&gt;298.0&lt;/span&gt; &lt;span class="mi"&gt;12345689&lt;/span&gt; &lt;span class="n"&gt;dist&lt;/span&gt; &lt;span class="n"&gt;uniform&lt;/span&gt;
&lt;span class="n"&gt;fix&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="n"&gt;nvt&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt; &lt;span class="mf"&gt;298.0&lt;/span&gt; &lt;span class="mf"&gt;298.0&lt;/span&gt; &lt;span class="mf"&gt;100.0&lt;/span&gt;


&lt;span class="n"&gt;neighbor&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="n"&gt;bin&lt;/span&gt;
&lt;span class="n"&gt;neigh_modify&lt;/span&gt; &lt;span class="n"&gt;delay&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;every&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="n"&gt;check&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;
&lt;span class="n"&gt;thermo&lt;/span&gt;      &lt;span class="mi"&gt;200&lt;/span&gt;
&lt;span class="n"&gt;thermo_style&lt;/span&gt; &lt;span class="n"&gt;custom&lt;/span&gt; &lt;span class="n"&gt;step&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt; &lt;span class="n"&gt;temp&lt;/span&gt;
&lt;span class="n"&gt;thermo_modify&lt;/span&gt; &lt;span class="n"&gt;norm&lt;/span&gt; &lt;span class="n"&gt;no&lt;/span&gt; &lt;span class="n"&gt;flush&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;

&lt;span class="n"&gt;minimize&lt;/span&gt; &lt;span class="mf"&gt;1.0e-8&lt;/span&gt; &lt;span class="mf"&gt;1.0e-8&lt;/span&gt; &lt;span class="mi"&gt;10000&lt;/span&gt; &lt;span class="mi"&gt;10000&lt;/span&gt;

&lt;span class="n"&gt;dump&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="n"&gt;dcd&lt;/span&gt; &lt;span class="mi"&gt;2000&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dcd&lt;/span&gt;
&lt;span class="n"&gt;dump_modify&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="n"&gt;unwrap&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;
&lt;span class="c1"&gt;#run variables&lt;/span&gt;
&lt;span class="n"&gt;timestep&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;
&lt;span class="n"&gt;run&lt;/span&gt; &lt;span class="mi"&gt;200000&lt;/span&gt; &lt;span class="c1"&gt;# 100ps, longer needed ( 2000000 10ns )&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;after the simulation, the ( result.dcd ) together with the ( water55.psf )&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;mol&lt;/span&gt; &lt;span class="nv"&gt;new&lt;/span&gt; &lt;span class="nv"&gt;water55&lt;/span&gt;.&lt;span class="nv"&gt;psf&lt;/span&gt;
&lt;span class="nv"&gt;mol&lt;/span&gt; &lt;span class="nv"&gt;addfile&lt;/span&gt; &lt;span class="nb"&gt;result&lt;/span&gt;.&lt;span class="nv"&gt;dcd&lt;/span&gt; &lt;span class="nv"&gt;waitfor&lt;/span&gt; &lt;span class="nv"&gt;all&lt;/span&gt;
&lt;span class="nv"&gt;pbc&lt;/span&gt; &lt;span class="nv"&gt;wrap&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;all&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nv"&gt;compound&lt;/span&gt; &lt;span class="nv"&gt;residue&lt;/span&gt;
&lt;span class="nv"&gt;set&lt;/span&gt; &lt;span class="nv"&gt;nframes&lt;/span&gt; [&lt;span class="nv"&gt;molinfo&lt;/span&gt; &lt;span class="nv"&gt;top&lt;/span&gt; &lt;span class="nv"&gt;get&lt;/span&gt; &lt;span class="nv"&gt;numframes&lt;/span&gt;]
&lt;span class="nv"&gt;set&lt;/span&gt; &lt;span class="nv"&gt;nframes&lt;/span&gt; [&lt;span class="nv"&gt;expr&lt;/span&gt; $&lt;span class="nv"&gt;nframes&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;]
&lt;span class="nv"&gt;animate&lt;/span&gt; &lt;span class="nv"&gt;write&lt;/span&gt; &lt;span class="nv"&gt;xyz&lt;/span&gt; &lt;span class="nv"&gt;eq&lt;/span&gt;.&lt;span class="nv"&gt;xyz&lt;/span&gt; &lt;span class="nv"&gt;beg&lt;/span&gt; $&lt;span class="nv"&gt;nframes&lt;/span&gt;
&lt;span class="k"&gt;exit&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;hr&gt;
&lt;p&gt;After the equilibrium run. I got the equilibrium structure (eq.xyz) from gromacs or lammps run. Now, I will use this structure as starting point for FPMD simulations.&lt;/p&gt;
&lt;hr&gt;
&lt;h3&gt;3.1 cpmd code&lt;/h3&gt;
&lt;p&gt;I recommend a tutorial about cpmd code ( &lt;a href="http://www.ipcms.unistra.fr/wp-content/uploads/2016/03/cpmd.pdf"&gt;cpmd.pdf&lt;/a&gt; ).&lt;/p&gt;
&lt;p&gt;First, the equilibrium structure need to be transformed to CPMD format. Here is the script ( cpmd_initial_structures.py ).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;argv&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mdsystem&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mdsystem&lt;/span&gt;&lt;span class="p"&gt;([],[],[])&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xyzinput&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;atom_number&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
&lt;span class="n"&gt;atom_xyz&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;atom&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;atom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;species&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;atom_number&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;atom_number&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;atom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;species&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;atom_xyz&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;atom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;species&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;atom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;coordinates&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;atom_number&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;atom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;species&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;atom_xyz&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;atom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;species&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;atom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;coordinates&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;coord&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;amp;ATOMS&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ISOTOPES&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;16.01&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;1.008&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;*O_MT_PBE.psp KLEINMAN-BYLANDER&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; LMAX=P LOC=P&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;atom_number&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;O&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;coord&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;atom_xyz&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;O&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
    &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;%f&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="si"&gt;%f&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="si"&gt;%f&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;coord&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;coord&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;coord&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;*H_MT_PBE.psp KLEINMAN-BYLANDER&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; LMAX=S LOC=S&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;atom_number&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;H&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;coord&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;atom_xyz&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;H&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
    &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;%f&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="si"&gt;%f&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="si"&gt;%f&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;coord&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;coord&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;coord&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;amp;END&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I am using cpmd simulation in cpmd code, so wavefucntion need to be optimized, first. Append the coord file at the end of the input file.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;
&lt;span class="n"&gt;wf&lt;/span&gt; &lt;span class="n"&gt;opt&lt;/span&gt; &lt;span class="n"&gt;for&lt;/span&gt; &lt;span class="n"&gt;pure&lt;/span&gt; &lt;span class="mi"&gt;55&lt;/span&gt; &lt;span class="n"&gt;water&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt;

&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;CPMD&lt;/span&gt;
 &lt;span class="n"&gt;OPTIMIZE&lt;/span&gt; &lt;span class="n"&gt;WAVEFUNCTION&lt;/span&gt;

 &lt;span class="n"&gt;CONVERGENCE&lt;/span&gt; &lt;span class="n"&gt;ORBITALS&lt;/span&gt;
   &lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;
 &lt;span class="n"&gt;ODIIS&lt;/span&gt; &lt;span class="n"&gt;NO_RESET&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;
   &lt;span class="mi"&gt;5&lt;/span&gt;
 &lt;span class="n"&gt;MAXSTEP&lt;/span&gt;
  &lt;span class="mi"&gt;1000&lt;/span&gt;

 &lt;span class="n"&gt;MEMORY&lt;/span&gt; &lt;span class="n"&gt;BIG&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt;

&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;SYSTEM&lt;/span&gt;
 &lt;span class="n"&gt;SYMMETRY&lt;/span&gt;
  &lt;span class="mi"&gt;1&lt;/span&gt;
 &lt;span class="n"&gt;ANGSTROM&lt;/span&gt;
 &lt;span class="n"&gt;CELL&lt;/span&gt;
  &lt;span class="mf"&gt;11.8172&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;  &lt;span class="mf"&gt;0.0&lt;/span&gt;  &lt;span class="mf"&gt;0.0&lt;/span&gt;  &lt;span class="mf"&gt;0.0&lt;/span&gt;
 &lt;span class="n"&gt;CUTOFF&lt;/span&gt;
  &lt;span class="mf"&gt;80.0&lt;/span&gt;
 &lt;span class="n"&gt;TESR&lt;/span&gt;
  &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt;

&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;DFT&lt;/span&gt;
 &lt;span class="n"&gt;NEWCODE&lt;/span&gt;
 &lt;span class="n"&gt;FUNCTIONAL&lt;/span&gt; &lt;span class="n"&gt;PBE&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;after the wavefunction optimization, a RESTART.1 file should be there. And we generate a LATEST file for the restart.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;
&lt;span class="n"&gt;equilibrium&lt;/span&gt; &lt;span class="n"&gt;steps&lt;/span&gt; &lt;span class="n"&gt;md&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="n"&gt;K&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;get&lt;/span&gt; &lt;span class="n"&gt;thermo&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt;

&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;CPMD&lt;/span&gt;
 &lt;span class="n"&gt;MOLECULAR&lt;/span&gt; &lt;span class="n"&gt;DYNAMICS&lt;/span&gt;
 &lt;span class="n"&gt;RESTART&lt;/span&gt; &lt;span class="n"&gt;WAVEFUNCTIONS&lt;/span&gt; &lt;span class="n"&gt;COORDINATES&lt;/span&gt; &lt;span class="n"&gt;LATEST&lt;/span&gt;

 &lt;span class="n"&gt;RESTFILE&lt;/span&gt;
 &lt;span class="mi"&gt;3&lt;/span&gt;

 &lt;span class="n"&gt;TRAJECTORY&lt;/span&gt; &lt;span class="n"&gt;SAMPLE&lt;/span&gt; &lt;span class="n"&gt;XYZ&lt;/span&gt;
  &lt;span class="mi"&gt;10&lt;/span&gt;

 &lt;span class="n"&gt;TEMPERATURE&lt;/span&gt;
   &lt;span class="mi"&gt;300&lt;/span&gt;

 &lt;span class="n"&gt;NOSE&lt;/span&gt; &lt;span class="n"&gt;IONS&lt;/span&gt;
   &lt;span class="mi"&gt;300&lt;/span&gt; &lt;span class="mf"&gt;3000.0&lt;/span&gt;

 &lt;span class="n"&gt;NOSE&lt;/span&gt; &lt;span class="n"&gt;ELECTRONS&lt;/span&gt;
   &lt;span class="mf"&gt;0.03&lt;/span&gt;  &lt;span class="mf"&gt;9000.0&lt;/span&gt;

 &lt;span class="n"&gt;MAXSTEP&lt;/span&gt;
   &lt;span class="mi"&gt;100&lt;/span&gt;

 &lt;span class="n"&gt;TIMESTEP&lt;/span&gt;
  &lt;span class="mf"&gt;4.0&lt;/span&gt;
 &lt;span class="n"&gt;EMASS&lt;/span&gt;
  &lt;span class="mf"&gt;400.0&lt;/span&gt;

 &lt;span class="n"&gt;MEMORY&lt;/span&gt; &lt;span class="n"&gt;BIG&lt;/span&gt;

 &lt;span class="n"&gt;RHOOUT&lt;/span&gt; &lt;span class="n"&gt;SAMPLE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;

 &lt;span class="n"&gt;SUBTRACT&lt;/span&gt; &lt;span class="n"&gt;COMVEL&lt;/span&gt; &lt;span class="n"&gt;ROTVEL&lt;/span&gt;
 &lt;span class="mi"&gt;1&lt;/span&gt;

&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt;

&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;SYSTEM&lt;/span&gt;
 &lt;span class="n"&gt;SYMMETRY&lt;/span&gt;
  &lt;span class="mi"&gt;1&lt;/span&gt;
 &lt;span class="n"&gt;ANGSTROM&lt;/span&gt;
 &lt;span class="n"&gt;CELL&lt;/span&gt;
  &lt;span class="mf"&gt;11.8172&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt;  &lt;span class="mf"&gt;0.0&lt;/span&gt;  &lt;span class="mf"&gt;0.0&lt;/span&gt;  &lt;span class="mf"&gt;0.0&lt;/span&gt;
 &lt;span class="n"&gt;CUTOFF&lt;/span&gt;
  &lt;span class="mf"&gt;80.0&lt;/span&gt;
 &lt;span class="n"&gt;TESR&lt;/span&gt;
  &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt;

&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;DFT&lt;/span&gt;
 &lt;span class="n"&gt;NEWCODE&lt;/span&gt;
 &lt;span class="n"&gt;FUNCTIONAL&lt;/span&gt; &lt;span class="n"&gt;PBE&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;hr&gt;
&lt;h3&gt;3.2 cp2k code&lt;/h3&gt;
&lt;p&gt;In cp2k, BOMD is running.  &lt;/p&gt;
&lt;p&gt;copy the eq.xyz file to the cp2k folder and write this input file for FPMD. (water55.inp)  &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;FORCE_EVAL&lt;/span&gt;
  &lt;span class="n"&gt;METHOD&lt;/span&gt; &lt;span class="n"&gt;Quickstep&lt;/span&gt;
  &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;DFT&lt;/span&gt;
    &lt;span class="n"&gt;BASIS_SET_FILE_NAME&lt;/span&gt;    &lt;span class="n"&gt;BASIS_MOLOPT&lt;/span&gt;
    &lt;span class="n"&gt;POTENTIAL_FILE_NAME&lt;/span&gt;    &lt;span class="n"&gt;GTH_POTENTIALS&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;MGRID&lt;/span&gt;
     &lt;span class="n"&gt;CUTOFF&lt;/span&gt;      &lt;span class="mi"&gt;200&lt;/span&gt;
     &lt;span class="n"&gt;REL_CUTOFF&lt;/span&gt;   &lt;span class="mi"&gt;50&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;MGRID&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;QS&lt;/span&gt;
      &lt;span class="n"&gt;EPS_DEFAULT&lt;/span&gt; &lt;span class="mf"&gt;1.0E-12&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;QS&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;SCF&lt;/span&gt;
      &lt;span class="n"&gt;SCF_GUESS&lt;/span&gt;  &lt;span class="n"&gt;ATOMIC&lt;/span&gt;
      &lt;span class="n"&gt;EPS_SCF&lt;/span&gt;    &lt;span class="mf"&gt;1.0E-6&lt;/span&gt;
      &lt;span class="n"&gt;MAX_SCF&lt;/span&gt;    &lt;span class="mi"&gt;30&lt;/span&gt;
      &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;OT&lt;/span&gt;
        &lt;span class="n"&gt;MINIMIZER&lt;/span&gt;       &lt;span class="n"&gt;DIIS&lt;/span&gt;
        &lt;span class="n"&gt;PRECONDITIONER&lt;/span&gt;  &lt;span class="n"&gt;FULL_ALL&lt;/span&gt;
      &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt;
      &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;OUTER_SCF&lt;/span&gt;
        &lt;span class="n"&gt;EPS_SCF&lt;/span&gt;  &lt;span class="mf"&gt;1.0E-6&lt;/span&gt;
        &lt;span class="n"&gt;MAX_SCF&lt;/span&gt;  &lt;span class="mi"&gt;20&lt;/span&gt;
      &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt;
      &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;PRINT&lt;/span&gt;
        &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;RESTART&lt;/span&gt;
          &lt;span class="n"&gt;BACKUP_COPIES&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt;
      &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;SCF&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;XC&lt;/span&gt;
      &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;XC_FUNCTIONAL&lt;/span&gt; &lt;span class="n"&gt;PBE&lt;/span&gt;
      &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;XC_FUNCTIONAL&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;XC&lt;/span&gt;
  &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;DFT&lt;/span&gt;
  &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;SUBSYS&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;CELL&lt;/span&gt;
      &lt;span class="n"&gt;ABC&lt;/span&gt; &lt;span class="mf"&gt;11.8172&lt;/span&gt; &lt;span class="mf"&gt;11.8172&lt;/span&gt; &lt;span class="mf"&gt;11.8172&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;CELL&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;TOPOLOGY&lt;/span&gt;
       &lt;span class="n"&gt;COORD_FILE_NAME&lt;/span&gt;   &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;eq&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xyz&lt;/span&gt;
       &lt;span class="n"&gt;COORD_FILE_FORMAT&lt;/span&gt; &lt;span class="n"&gt;xyz&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;TOPOLOGY&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;KIND&lt;/span&gt; &lt;span class="n"&gt;H&lt;/span&gt;
      &lt;span class="n"&gt;BASIS_SET&lt;/span&gt;         &lt;span class="n"&gt;DZVP&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;MOLOPT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SR&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GTH&lt;/span&gt;
      &lt;span class="n"&gt;POTENTIAL&lt;/span&gt;         &lt;span class="n"&gt;GTH&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;PBE&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;q1&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;KIND&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;KIND&lt;/span&gt; &lt;span class="n"&gt;O&lt;/span&gt;
      &lt;span class="n"&gt;BASIS_SET&lt;/span&gt;         &lt;span class="n"&gt;DZVP&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;MOLOPT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SR&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GTH&lt;/span&gt;
      &lt;span class="n"&gt;POTENTIAL&lt;/span&gt;         &lt;span class="n"&gt;GTH&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;PBE&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;q6&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;KIND&lt;/span&gt;
  &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;SUBSYS&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;FORCE_EVAL&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;MOTION&lt;/span&gt;
  &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;
    &lt;span class="n"&gt;ENSEMBLE&lt;/span&gt; &lt;span class="n"&gt;NVE&lt;/span&gt;
    &lt;span class="n"&gt;STEPS&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;
    &lt;span class="n"&gt;TIMESTEP&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;
    &lt;span class="n"&gt;TEMPERATURE&lt;/span&gt; &lt;span class="mf"&gt;300.0&lt;/span&gt;
  &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;MD&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;MOTION&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;GLOBAL&lt;/span&gt;
  &lt;span class="n"&gt;PROJECT&lt;/span&gt;     &lt;span class="n"&gt;H2O&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;55&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;PBE&lt;/span&gt;
  &lt;span class="n"&gt;RUN_TYPE&lt;/span&gt;    &lt;span class="n"&gt;MD&lt;/span&gt;
  &lt;span class="n"&gt;PRINT_LEVEL&lt;/span&gt; &lt;span class="n"&gt;MEDIUM&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kr"&gt;END&lt;/span&gt; &lt;span class="n"&gt;GLOBAL&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;hr&gt;
&lt;h3&gt;3.3 cp.x code&lt;/h3&gt;
&lt;p&gt;The script here.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cd &lt;span class="nv"&gt;$PWD&lt;/span&gt;

Name=cp-H2O

fricei=( 1.0 1.0 0.5 0.1 0.0 0.0 0.0 )
fricpi=( 0.9 1.0 0.3 0.05 0.0 0.0 0.0 )
runi=( 100 100 200 200 1500 1500 35000 )
orthoi=( Gram-Schmidt ortho ortho ortho ortho ortho ortho )
modei=( from_scratch reset_counters restart restart reset_counters restart restart)
wfr=( 51 51 51 51 51 71 72 )
wfw=( 51 51 51 51 71 72 73 )
ions=( none none none none verlet verlet verlet)
tempi=( 50 50 50 50 300 350 375 )
electrons=( damp damp damp damp verlet verlet verlet )

typeset -i j=1
while (( j == 1 ));do
if [[ -d &amp;quot;H2O_&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;wfw&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;.save&amp;quot; ]]; then
 wfr[6]=&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;wfw&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;
 wfw[6]=$((&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;wfw&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;+1))
else
 j=0
fi
done

echo &amp;quot;in&amp;quot;

for i in 0 1 2 3 4 ;
do

rm -f in.00
cat &lt;span class="nt"&gt;&amp;lt;&amp;lt; EOF&lt;/span&gt; &lt;span class="nt"&gt;&amp;gt; in.00&lt;/span&gt;

&lt;span class="err"&gt;&amp;amp;CONTROL&lt;/span&gt;
  &lt;span class="na"&gt;outdir =&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nv"&gt;$PWD&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;
  &lt;span class="na"&gt;pseudo_dir =&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;./&amp;#39;&lt;/span&gt;
  &lt;span class="na"&gt;title  =&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;H2O&amp;#39;&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt;
  &lt;span class="na"&gt;prefix =&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;H2O&amp;#39;&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt;
  &lt;span class="na"&gt;calculation =&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;cp&amp;#39;&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt;
  &lt;span class="na"&gt;restart_mode =&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;modei&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt;
  &lt;span class="na"&gt;ndr =&lt;/span&gt; &lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;wfr&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="s"&gt;,&lt;/span&gt;
  &lt;span class="na"&gt;ndw =&lt;/span&gt; &lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;wfw&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="s"&gt;,&lt;/span&gt;
  &lt;span class="na"&gt;nstep  =&lt;/span&gt; &lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;runi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="s"&gt;,&lt;/span&gt;
  &lt;span class="na"&gt;iprint =&lt;/span&gt; &lt;span class="s"&gt;20,&lt;/span&gt;
  &lt;span class="na"&gt;isave  =&lt;/span&gt; &lt;span class="s"&gt;1000,&lt;/span&gt;
  &lt;span class="na"&gt;tstress =&lt;/span&gt; &lt;span class="s"&gt;.true.,&lt;/span&gt;
  &lt;span class="na"&gt;tprnfor =&lt;/span&gt; &lt;span class="s"&gt;.true.,&lt;/span&gt;
  &lt;span class="na"&gt;dt    =&lt;/span&gt;  &lt;span class="s"&gt;3.d0,&lt;/span&gt;
&lt;span class="err"&gt;!&lt;/span&gt;  &lt;span class="na"&gt;etot_conv_thr =&lt;/span&gt; &lt;span class="s"&gt;1.D-8&lt;/span&gt;
&lt;span class="err"&gt;!&lt;/span&gt;  &lt;span class="na"&gt;forc_conv_thr =&lt;/span&gt; &lt;span class="s"&gt;1.D-3&lt;/span&gt;
&lt;span class="err"&gt;/&lt;/span&gt;


&lt;span class="err"&gt;&amp;amp;SYSTEM&lt;/span&gt;
  &lt;span class="na"&gt;ibrav =&lt;/span&gt; &lt;span class="s"&gt;1,&lt;/span&gt;
  &lt;span class="err"&gt;celldm(1)&lt;/span&gt; &lt;span class="err"&gt;=&lt;/span&gt; &lt;span class="err"&gt;CELL_X_YY,&lt;/span&gt;
  &lt;span class="err"&gt;celldm(2)&lt;/span&gt; &lt;span class="err"&gt;=&lt;/span&gt; &lt;span class="err"&gt;1.00,&lt;/span&gt;
  &lt;span class="err"&gt;celldm(3)&lt;/span&gt; &lt;span class="err"&gt;=&lt;/span&gt; &lt;span class="err"&gt;1.00,&lt;/span&gt;
  &lt;span class="err"&gt;celldm(4)&lt;/span&gt; &lt;span class="err"&gt;=&lt;/span&gt; &lt;span class="err"&gt;0.0,&lt;/span&gt;
  &lt;span class="err"&gt;celldm(5)&lt;/span&gt; &lt;span class="err"&gt;=&lt;/span&gt; &lt;span class="err"&gt;0.0,&lt;/span&gt;
  &lt;span class="err"&gt;celldm(6)&lt;/span&gt; &lt;span class="err"&gt;=&lt;/span&gt; &lt;span class="err"&gt;0.0,&lt;/span&gt;
  &lt;span class="na"&gt;nat  =&lt;/span&gt; &lt;span class="s"&gt;NATOMS_YY,&lt;/span&gt;
  &lt;span class="na"&gt;ntyp =&lt;/span&gt; &lt;span class="s"&gt;2,&lt;/span&gt;
  &lt;span class="na"&gt;nspin =&lt;/span&gt; &lt;span class="s"&gt;1,&lt;/span&gt;
  &lt;span class="na"&gt;ecutwfc =&lt;/span&gt; &lt;span class="s"&gt;25.0,&lt;/span&gt;
  &lt;span class="na"&gt;ecutrho =&lt;/span&gt; &lt;span class="s"&gt;200.0,&lt;/span&gt;
  &lt;span class="na"&gt;nr1b=&lt;/span&gt; &lt;span class="s"&gt;20,&lt;/span&gt; &lt;span class="na"&gt;nr2b =&lt;/span&gt; &lt;span class="s"&gt;20,&lt;/span&gt; &lt;span class="na"&gt;nr3b =&lt;/span&gt; &lt;span class="s"&gt;20,&lt;/span&gt;
&lt;span class="err"&gt;!&lt;/span&gt;  &lt;span class="err"&gt;starting_magnetization(1)=0.1,&lt;/span&gt;
&lt;span class="err"&gt;!&lt;/span&gt;  &lt;span class="na"&gt;occupations=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;from_input&amp;#39;&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt;
&lt;span class="err"&gt;/&lt;/span&gt;

&lt;span class="err"&gt;&amp;amp;ELECTRONS&lt;/span&gt;
  &lt;span class="na"&gt;emass =&lt;/span&gt; &lt;span class="s"&gt;340.d0,&lt;/span&gt;
  &lt;span class="na"&gt;emass_cutoff =&lt;/span&gt; &lt;span class="s"&gt;2.0d0,&lt;/span&gt;
  &lt;span class="na"&gt;orthogonalization =&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;orthoi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt;
  &lt;span class="na"&gt;ortho_eps =&lt;/span&gt; &lt;span class="s"&gt;5.d-8,&lt;/span&gt;
  &lt;span class="na"&gt;ortho_max =&lt;/span&gt; &lt;span class="s"&gt;200,&lt;/span&gt;
  &lt;span class="na"&gt;electron_dynamics =&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;electrons&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt;
  &lt;span class="na"&gt;electron_damping =&lt;/span&gt; &lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;fricei&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="s"&gt;,&lt;/span&gt;
&lt;span class="err"&gt;/&lt;/span&gt;

&lt;span class="err"&gt;&amp;amp;IONS&lt;/span&gt;
  &lt;span class="na"&gt;ion_dynamics =&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;ions&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt;
  &lt;span class="na"&gt;ion_damping =&lt;/span&gt; &lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;fricpi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="s"&gt;,&lt;/span&gt;
  &lt;span class="na"&gt;tempw  =&lt;/span&gt; &lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;tempi&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="s"&gt;,&lt;/span&gt;
&lt;span class="err"&gt;!&lt;/span&gt;  &lt;span class="na"&gt;ion_temperature =&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;rescaling&amp;#39;&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt;
  &lt;span class="na"&gt;ion_temperature =&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;nose&amp;#39;&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt;
  &lt;span class="na"&gt;fnosep =&lt;/span&gt; &lt;span class="s"&gt;10.0&lt;/span&gt;  &lt;span class="err"&gt;30.0&lt;/span&gt;   &lt;span class="err"&gt;60.0&lt;/span&gt;  &lt;span class="err"&gt;100.0,&lt;/span&gt;
  &lt;span class="na"&gt;nhpcl =&lt;/span&gt; &lt;span class="s"&gt;4,&lt;/span&gt;
  &lt;span class="na"&gt;nhptyp =&lt;/span&gt; &lt;span class="s"&gt;2,&lt;/span&gt;
&lt;span class="err"&gt;/&lt;/span&gt;

&lt;span class="err"&gt;ATOMIC_SPECIES&lt;/span&gt;
&lt;span class="err"&gt;H&lt;/span&gt; &lt;span class="err"&gt;1.008&lt;/span&gt; &lt;span class="err"&gt;H.pbe-van_ak.UPF&lt;/span&gt;
&lt;span class="err"&gt;O&lt;/span&gt; &lt;span class="err"&gt;15.999&lt;/span&gt; &lt;span class="err"&gt;O.pbe-van_ak.UPF&lt;/span&gt;

&lt;span class="err"&gt;ATOMIC_POSITIONS&lt;/span&gt; &lt;span class="err"&gt;(&lt;/span&gt; &lt;span class="err"&gt;angstrom&lt;/span&gt; &lt;span class="err"&gt;)&lt;/span&gt;
&lt;span class="err"&gt;COORD_YY&lt;/span&gt;

&lt;span class="err"&gt;EOF&lt;/span&gt;

&lt;span class="err"&gt;echo&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;Strat&lt;/span&gt; &lt;span class="err"&gt;turn&lt;/span&gt; &lt;span class="err"&gt;of&amp;#39;&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;
&lt;span class="err"&gt;mpirun&lt;/span&gt; &lt;span class="err"&gt;~/software/qe/qe-6.0/bin/cp.x&lt;/span&gt; &lt;span class="nt"&gt;&amp;lt; in.00&lt;/span&gt; &lt;span class="nt"&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="nv"&gt;$Name.out&lt;/span&gt;

done

echo &amp;#39;ALL DONE&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The coord generate script.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;head -n 167 eq.xyz | tail -n 165 &amp;gt; coord
sed &amp;#39;s/CELL_X_YY/22.331269952/&amp;#39; water_template.j &amp;gt; water_tmp.j
sed &amp;#39;s/NATOMS_YY/165/&amp;#39; water_tmp.j &amp;gt;  water_tmp2.j
sed &amp;quot;/COORD_YY/ r coord&amp;quot; water_tmp2.j &amp;gt; water_tmp3.j
sed &amp;quot;s/COORD_YY/ /&amp;quot; water_tmp3.j &amp;gt; water.j
rm water_tmp.j water_tmp2.j water_tmp3.j
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;hr&gt;
&lt;h3&gt;3.4 qbox code&lt;/h3&gt;
&lt;p&gt;For qbox code, also a convertor script is needed. The units used in qbox is atomic units. I list the script here.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mdsystem&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;eq.xyz&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mdsystem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mf"&gt;11.8172&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;11.8172&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;11.8172&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xyzinput&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;generate_bonds&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cutoff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;molecular_detection&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;moleculars&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;molecular_names&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;SOL&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;AtoBohr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mf"&gt;1.8897259886&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;set cell &amp;quot;&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;AtoBohr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
                    &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;AtoBohr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
                    &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;AtoBohr&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;species oxygen O_HSCV_PBE-1.0.xml&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;species hydrogen H_HSCV_PBE-1.0.xml&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;nO&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="n"&gt;nH&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;atom&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;atom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;species&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;O&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;nO&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;xyz&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;atom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;coordinates&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;AtoBohr&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;atom &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;O&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;nO&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;oxygen&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;xyz&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;xyz&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;xyz&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;atom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;species&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;H&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;nH&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;xyz&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;atom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;coordinates&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;AtoBohr&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;atom &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;H&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;nH&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;hydrogen&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;xyz&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;xyz&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;xyz&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;with pseudopotentials files and sample.xsd, species.xsd (taken from xml folder in qbox package) in the same folder. &lt;br&gt;
We then append these commands at the end of the structure information.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;set ecut 70
set wf_dyn PSDA
set ecutprec 5
randomize_wf
run 0 100

set atoms_dyn MD
set dt 40 
run 100 10
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Run the calculation like this.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mpirun /nas02/home/y/i/yiy/bin/qb &amp;lt; test.i &amp;gt; test.out
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;hr&gt;
&lt;p&gt;After the simulation, I got trajs like this.  &lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt Text" src="https://yaoyi92.github.io/images/water55_aimd.gif"&gt;&lt;/p&gt;
&lt;hr&gt;</content><category term="molecular dynamics"></category><category term="molecular dynamics"></category></entry><entry><title>bash loop template</title><link href="https://yaoyi92.github.io/bash-loop-template.html" rel="alternate"></link><published>2015-05-13T01:56:00+02:00</published><updated>2015-05-13T01:56:00+02:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2015-05-13:/bash-loop-template.html</id><summary type="html">&lt;p&gt;the simple use of bash&lt;/p&gt;</summary><content type="html">&lt;p&gt;A bash template for loops.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;&lt;span class="normal"&gt; 1&lt;/span&gt;
&lt;span class="normal"&gt; 2&lt;/span&gt;
&lt;span class="normal"&gt; 3&lt;/span&gt;
&lt;span class="normal"&gt; 4&lt;/span&gt;
&lt;span class="normal"&gt; 5&lt;/span&gt;
&lt;span class="normal"&gt; 6&lt;/span&gt;
&lt;span class="normal"&gt; 7&lt;/span&gt;
&lt;span class="normal"&gt; 8&lt;/span&gt;
&lt;span class="normal"&gt; 9&lt;/span&gt;
&lt;span class="normal"&gt;10&lt;/span&gt;
&lt;span class="normal"&gt;11&lt;/span&gt;
&lt;span class="normal"&gt;12&lt;/span&gt;
&lt;span class="normal"&gt;13&lt;/span&gt;
&lt;span class="normal"&gt;14&lt;/span&gt;
&lt;span class="normal"&gt;15&lt;/span&gt;
&lt;span class="normal"&gt;16&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;

&lt;span class="nv"&gt;list1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;seq -w &lt;span class="m"&gt;07&lt;/span&gt; &lt;span class="m"&gt;38&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;span class="nv"&gt;n&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="nv"&gt;home&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$PWD&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; i &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;list1&lt;/span&gt;&lt;span class="p"&gt;[*]&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;do&lt;/span&gt;
  mkdir &lt;span class="nv"&gt;$i&lt;/span&gt;
  &lt;span class="nv"&gt;list2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;seq -w &lt;span class="m"&gt;01&lt;/span&gt; &lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
  &lt;span class="k"&gt;for&lt;/span&gt; j &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;list2&lt;/span&gt;&lt;span class="p"&gt;[*]&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
  &lt;span class="k"&gt;do&lt;/span&gt;
    mkdir &lt;span class="nv"&gt;$i&lt;/span&gt;/&lt;span class="nv"&gt;$j&lt;/span&gt;
    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt; &lt;span class="nv"&gt;$j&lt;/span&gt;
    &lt;span class="nb"&gt;cd&lt;/span&gt; &lt;span class="nv"&gt;$home&lt;/span&gt;
  &lt;span class="k"&gt;done&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</content><category term="misc"></category><category term="bash"></category></entry><entry><title>cube file</title><link href="https://yaoyi92.github.io/cube-file.html" rel="alternate"></link><published>2015-05-07T01:56:00+02:00</published><updated>2015-05-07T01:56:00+02:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2015-05-07:/cube-file.html</id><summary type="html">&lt;p&gt;everything about cube file&lt;/p&gt;</summary><content type="html">&lt;p&gt;Cube file is a file format for electron density. &lt;/p&gt;
&lt;p&gt;I found a python code in dftb+ website which can manipulate cube files. &lt;a href="http://www.dftb-plus.info/fileadmin/DFTB-Plus/public/tools/waveplot/r0.3/cubemanip"&gt;link&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;It manipulate multiple cube files and can do all kinds of expressions using these cube files as input.&lt;/p&gt;</content><category term="misc"></category><category term="dft"></category></entry><entry><title>constrained Density Functional Theory with cp2k</title><link href="https://yaoyi92.github.io/constrained-density-functional-theory-with-cp2k.html" rel="alternate"></link><published>2015-03-09T14:56:00+01:00</published><updated>2015-03-09T14:56:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2015-03-09:/constrained-density-functional-theory-with-cp2k.html</id><summary type="html">&lt;p&gt;A simple example for constrained DFT with cp2k&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="http://pubs.acs.org/doi/pdf/10.1021/cr200148b"&gt;Constrained Density Functional Theory&lt;/a&gt; has many applications. Here I showed a simple example of cDFT of H2+ system. And I would like to constrain the electron on one proton with cp2k.&lt;/p&gt;
&lt;p&gt;Here is the script.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;FORCE_EVAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;METHOD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Quickstep&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;DFT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;BASIS_SET_FILE_NAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;global&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;homes&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;yyao_unc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;software&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cp2k&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cp2k&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cp2k&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;data&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;BASIS_MOLOPT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;POTENTIAL_FILE_NAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;global&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;homes&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;yyao_unc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;software&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cp2k&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cp2k&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cp2k&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;data&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;GTH_POTENTIALS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;CHARGE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;MGRID&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;CUTOFF&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;250&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;REL_CUTOFF&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MGRID&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;QS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="k"&gt;METHOD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GPW&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;MULLIKEN_RESTRAINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;TARGET&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;STRENGTH&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;3000.0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;ATOMS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;QS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;SCF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;OT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;ON&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;MINIMIZER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DIIS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;ENERGY_GAP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.001&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;PRECONDITIONER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FULL_ALL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;OT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;EPS_SCF&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0E-6&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;SCF_GUESS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;ATOMIC&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;MAX_SCF&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;200000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SCF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;UKS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;XC&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;XC_FUNCTIONAL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PBE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;XC_FUNCTIONAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;XC_GRID&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;XC_SMOOTH_RHO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NN50&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;XC_DERIV&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NN50_SMOOTH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;XC&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;                                                   &lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;E_DENSITY_CUBE&lt;/span&gt;&lt;span class="w"&gt;                                        &lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;                                                &lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="w"&gt;                                             &lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;                                            &lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;STRIDE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;                                         &lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E_DENSITY_CUBE&lt;/span&gt;&lt;span class="w"&gt;                                    &lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DFT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;SUBSYS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;CELL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;ABC&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;bohr&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;20.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;20.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;20.0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CELL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;COORD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;H&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;10.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;10.0&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;9.0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;H&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;10.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;10.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;11.0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;UNIT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bohr&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;COORD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;KIND&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;H&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;BASIS_SET&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DZVP&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;MOLOPT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SR&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GTH&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;q1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;#BASIS_SET&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DZVP&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GTH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;POTENTIAL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GTH&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;BLYP&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;q1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KIND&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SUBSYS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FORCE_EVAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;GLOBAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;PROJECT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h2&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;PRINT_LEVEL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MEDIUM&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;GLOBAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;After the calculation the Mulliken Analysis is showed here.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt; MULLIKEN POPULATION ANALYSIS

 #  Atom  Element  Kind  Atomic population (alpha,beta)   Net charge  Spin moment
       1     H        1          0.999915     0.000000     0.000085     0.999915
       2     H        1          0.000085     0.000000     0.999915     0.000085
 # Total charge and spin         1.000000     0.000000     1.000000     1.000000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And I also visulized the charge density cube file. Most of the charge density is on the left proton now.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt Text" src="https://yaoyi92.github.io/images/cdft_h2+_cp2k.jpeg"&gt;&lt;/p&gt;</content><category term="misc"></category><category term="dft"></category></entry><entry><title>crystal code with lc-blyp functional</title><link href="https://yaoyi92.github.io/crystal-code-with-lc-blyp-functional.html" rel="alternate"></link><published>2015-03-09T14:56:00+01:00</published><updated>2015-03-09T14:56:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2015-03-09:/crystal-code-with-lc-blyp-functional.html</id><summary type="html">&lt;p&gt;using crystal to calculate scf with lc-blyp functional&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="http://www.crystal.unito.it/index.php"&gt;crystal&lt;/a&gt; is a computational tool for solid state chemistry and physics. Basically, it does DFT. 
I post here an example of lc-blyp calculation of bulk water system.&lt;/p&gt;
&lt;p&gt;When I did the lc-blyp calculation, the scf not converge is a problem. So I did a blyp calculation first. Then copy the fort.9 file to a new folder of fort.20 which is the density matrix file. And I will add a GUESSP command to the INPUT for lc-blyp calculation.&lt;/p&gt;
&lt;p&gt;Here is the inputs:&lt;/p&gt;
&lt;p&gt;INPUT for blyp calculation&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;Water&lt;/span&gt; &lt;span class="n"&gt;cube&lt;/span&gt;
&lt;span class="n"&gt;CRYSTAL&lt;/span&gt;
&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="mf"&gt;11.8172&lt;/span&gt; &lt;span class="mf"&gt;11.8172&lt;/span&gt; &lt;span class="mf"&gt;11.8172&lt;/span&gt; &lt;span class="mi"&gt;90&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="mi"&gt;90&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="mi"&gt;90&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;span class="mi"&gt;165&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.966182090512&lt;/span&gt; &lt;span class="mf"&gt;1.00021468707&lt;/span&gt; &lt;span class="mf"&gt;1.4854507836&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.03919930271&lt;/span&gt; &lt;span class="mf"&gt;1.40081195207&lt;/span&gt; &lt;span class="mf"&gt;1.57239938395&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.2300162475&lt;/span&gt; &lt;span class="mf"&gt;0.527247909826&lt;/span&gt; &lt;span class="mf"&gt;1.33289637139&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.768640540906&lt;/span&gt; &lt;span class="mf"&gt;1.65014267339&lt;/span&gt; &lt;span class="mf"&gt;1.3298380327&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.15689283417&lt;/span&gt; &lt;span class="mf"&gt;1.2052291575&lt;/span&gt; &lt;span class="mf"&gt;1.08481399993&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.903492451681&lt;/span&gt; &lt;span class="mf"&gt;1.21632146363&lt;/span&gt; &lt;span class="mf"&gt;1.38370900044&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.762101766916&lt;/span&gt; &lt;span class="mf"&gt;0.505654892868&lt;/span&gt; &lt;span class="mf"&gt;0.887620671563&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.38305427682&lt;/span&gt; &lt;span class="mf"&gt;0.459265985174&lt;/span&gt; &lt;span class="mf"&gt;1.53107572014&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.50650348644&lt;/span&gt; &lt;span class="mf"&gt;0.456861016146&lt;/span&gt; &lt;span class="mf"&gt;1.17375080391&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.63803650611&lt;/span&gt; &lt;span class="mf"&gt;1.15520588634&lt;/span&gt; &lt;span class="mf"&gt;0.658485597265&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.45252310192&lt;/span&gt; &lt;span class="mf"&gt;1.04503698&lt;/span&gt; &lt;span class="mf"&gt;1.09088574282&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.446270182446&lt;/span&gt; &lt;span class="mf"&gt;0.842531479538&lt;/span&gt; &lt;span class="mf"&gt;0.927859729885&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.43138112243&lt;/span&gt; &lt;span class="mf"&gt;0.708681921267&lt;/span&gt; &lt;span class="mf"&gt;0.740832092205&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.937938767221&lt;/span&gt; &lt;span class="mf"&gt;1.03809015672&lt;/span&gt; &lt;span class="mf"&gt;0.702070372&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.863986223471&lt;/span&gt; &lt;span class="mf"&gt;1.24494550316&lt;/span&gt; &lt;span class="mf"&gt;0.67097527333&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.26616296585&lt;/span&gt; &lt;span class="mf"&gt;0.550525843685&lt;/span&gt; &lt;span class="mf"&gt;0.700526097553&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.808251954778&lt;/span&gt; &lt;span class="mf"&gt;1.01392546458&lt;/span&gt; &lt;span class="mf"&gt;0.888978438209&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.700633060285&lt;/span&gt; &lt;span class="mf"&gt;1.30514241952&lt;/span&gt; &lt;span class="mf"&gt;1.36784449785&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.27978945943&lt;/span&gt; &lt;span class="mf"&gt;1.22268439224&lt;/span&gt; &lt;span class="mf"&gt;1.87452839928&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.61985597265&lt;/span&gt; &lt;span class="mf"&gt;1.42719138205&lt;/span&gt; &lt;span class="mf"&gt;1.54634253461&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.52579096571&lt;/span&gt; &lt;span class="mf"&gt;0.709874674204&lt;/span&gt; &lt;span class="mf"&gt;0.49502242494&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.984720576786&lt;/span&gt; &lt;span class="mf"&gt;0.61250702366&lt;/span&gt; &lt;span class="mf"&gt;2.05818366449&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.900647784585&lt;/span&gt; &lt;span class="mf"&gt;0.474448261856&lt;/span&gt; &lt;span class="mf"&gt;1.22569508852&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.49653835088&lt;/span&gt; &lt;span class="mf"&gt;1.28823308398&lt;/span&gt; &lt;span class="mf"&gt;0.830222810818&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.79160029449&lt;/span&gt; &lt;span class="mf"&gt;1.07211158312&lt;/span&gt; &lt;span class="mf"&gt;1.2086718512&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.83282960431&lt;/span&gt; &lt;span class="mf"&gt;0.803301205023&lt;/span&gt; &lt;span class="mf"&gt;0.9671824967&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.34537504654&lt;/span&gt; &lt;span class="mf"&gt;0.873155146735&lt;/span&gt; &lt;span class="mf"&gt;1.24777189182&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.4377635142&lt;/span&gt; &lt;span class="mf"&gt;1.24948481874&lt;/span&gt; &lt;span class="mf"&gt;1.26121712419&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.61083522323&lt;/span&gt; &lt;span class="mf"&gt;0.963454117727&lt;/span&gt; &lt;span class="mf"&gt;1.32491478523&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.89343812409&lt;/span&gt; &lt;span class="mf"&gt;0.582376366652&lt;/span&gt; &lt;span class="mf"&gt;1.52855871103&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.492430694242&lt;/span&gt; &lt;span class="mf"&gt;1.0714599059&lt;/span&gt; &lt;span class="mf"&gt;0.497475290255&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.32287047693&lt;/span&gt; &lt;span class="mf"&gt;1.24018718478&lt;/span&gt; &lt;span class="mf"&gt;1.48182623633&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.08089682835&lt;/span&gt; &lt;span class="mf"&gt;0.710079629692&lt;/span&gt; &lt;span class="mf"&gt;1.69978937481&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.566233625563&lt;/span&gt; &lt;span class="mf"&gt;1.66400610974&lt;/span&gt; &lt;span class="mf"&gt;1.25198558034&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.188996462783&lt;/span&gt; &lt;span class="mf"&gt;0.885536929222&lt;/span&gt; &lt;span class="mf"&gt;1.46524041228&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.92452552212&lt;/span&gt; &lt;span class="mf"&gt;1.23048649426&lt;/span&gt; &lt;span class="mf"&gt;1.03169295603&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.617660274854&lt;/span&gt; &lt;span class="mf"&gt;0.817834258538&lt;/span&gt; &lt;span class="mf"&gt;1.08969459771&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.33952662221&lt;/span&gt; &lt;span class="mf"&gt;0.537026114477&lt;/span&gt; &lt;span class="mf"&gt;0.97252276343&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.21163067393&lt;/span&gt; &lt;span class="mf"&gt;1.07015274346&lt;/span&gt; &lt;span class="mf"&gt;0.705801289646&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.708953559219&lt;/span&gt; &lt;span class="mf"&gt;1.40961251396&lt;/span&gt; &lt;span class="mf"&gt;1.10277104559&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.06568992655&lt;/span&gt; &lt;span class="mf"&gt;0.706494854957&lt;/span&gt; &lt;span class="mf"&gt;0.400919507159&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.12978751312&lt;/span&gt; &lt;span class="mf"&gt;0.876184290695&lt;/span&gt; &lt;span class="mf"&gt;0.910686033917&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.55138340724&lt;/span&gt; &lt;span class="mf"&gt;1.51283019666&lt;/span&gt; &lt;span class="mf"&gt;1.84138306875&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.943388281488&lt;/span&gt; &lt;span class="mf"&gt;0.379874928071&lt;/span&gt; &lt;span class="mf"&gt;0.842503892631&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.35594709407&lt;/span&gt; &lt;span class="mf"&gt;0.919504451139&lt;/span&gt; &lt;span class="mf"&gt;1.62474444031&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.948775175168&lt;/span&gt; &lt;span class="mf"&gt;0.840589733609&lt;/span&gt; &lt;span class="mf"&gt;1.20458492706&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.622394898961&lt;/span&gt; &lt;span class="mf"&gt;1.20107174288&lt;/span&gt; &lt;span class="mf"&gt;1.02580848255&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.784972836205&lt;/span&gt; &lt;span class="mf"&gt;0.848350032157&lt;/span&gt; &lt;span class="mf"&gt;1.42938403344&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.08217014183&lt;/span&gt; &lt;span class="mf"&gt;0.360261737129&lt;/span&gt; &lt;span class="mf"&gt;1.27039222489&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.16518735403&lt;/span&gt; &lt;span class="mf"&gt;1.41018464611&lt;/span&gt; &lt;span class="mf"&gt;0.848232999357&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.851257319839&lt;/span&gt; &lt;span class="mf"&gt;0.708795315303&lt;/span&gt; &lt;span class="mf"&gt;0.771359374471&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.682134261923&lt;/span&gt; &lt;span class="mf"&gt;0.819043512846&lt;/span&gt; &lt;span class="mf"&gt;1.64355321057&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.15068908032&lt;/span&gt; &lt;span class="mf"&gt;0.962640642453&lt;/span&gt; &lt;span class="mf"&gt;1.15036303016&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.595814321497&lt;/span&gt; &lt;span class="mf"&gt;0.971598517415&lt;/span&gt; &lt;span class="mf"&gt;0.797778153877&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.22474054768&lt;/span&gt; &lt;span class="mf"&gt;0.674640862472&lt;/span&gt; &lt;span class="mf"&gt;1.14489794537&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.04184933825&lt;/span&gt; &lt;span class="mf"&gt;0.980869495312&lt;/span&gt; &lt;span class="mf"&gt;1.46944707714&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.966587770369&lt;/span&gt; &lt;span class="mf"&gt;1.07866017331&lt;/span&gt; &lt;span class="mf"&gt;1.46048801747&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.00937303253&lt;/span&gt; &lt;span class="mf"&gt;1.3425173476&lt;/span&gt; &lt;span class="mf"&gt;1.52038587821&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.996500440037&lt;/span&gt; &lt;span class="mf"&gt;1.36528094642&lt;/span&gt; &lt;span class="mf"&gt;1.63609315235&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.19357995126&lt;/span&gt; &lt;span class="mf"&gt;0.452229885252&lt;/span&gt; &lt;span class="mf"&gt;1.3260631114&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.2984623261&lt;/span&gt; &lt;span class="mf"&gt;0.518463849304&lt;/span&gt; &lt;span class="mf"&gt;1.38540804928&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.69602291575&lt;/span&gt; &lt;span class="mf"&gt;1.63709626646&lt;/span&gt; &lt;span class="mf"&gt;1.29537860068&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.773463595437&lt;/span&gt; &lt;span class="mf"&gt;1.60575229327&lt;/span&gt; &lt;span class="mf"&gt;1.39931286599&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.20908819348&lt;/span&gt; &lt;span class="mf"&gt;1.22614197949&lt;/span&gt; &lt;span class="mf"&gt;1.02950817453&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.16437641743&lt;/span&gt; &lt;span class="mf"&gt;1.12178147108&lt;/span&gt; &lt;span class="mf"&gt;1.09562891379&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.947235893443&lt;/span&gt; &lt;span class="mf"&gt;1.26596960363&lt;/span&gt; &lt;span class="mf"&gt;1.33223919372&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.828159800968&lt;/span&gt; &lt;span class="mf"&gt;1.25201502894&lt;/span&gt; &lt;span class="mf"&gt;1.3869174593&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.780803151339&lt;/span&gt; &lt;span class="mf"&gt;0.587075533967&lt;/span&gt; &lt;span class="mf"&gt;0.881474714822&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.68113961006&lt;/span&gt; &lt;span class="mf"&gt;0.5006251904&lt;/span&gt; &lt;span class="mf"&gt;0.86950588972&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.3673395559&lt;/span&gt; &lt;span class="mf"&gt;0.378040991098&lt;/span&gt; &lt;span class="mf"&gt;1.51693726094&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.33352156179&lt;/span&gt; &lt;span class="mf"&gt;0.485049588735&lt;/span&gt; &lt;span class="mf"&gt;1.59441102799&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.47586949531&lt;/span&gt; &lt;span class="mf"&gt;0.39175532275&lt;/span&gt; &lt;span class="mf"&gt;1.222188928&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.58466718004&lt;/span&gt; &lt;span class="mf"&gt;0.431308601022&lt;/span&gt; &lt;span class="mf"&gt;1.15432369766&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.712842297668&lt;/span&gt; &lt;span class="mf"&gt;1.19142317977&lt;/span&gt; &lt;span class="mf"&gt;0.671666130725&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.583473242392&lt;/span&gt; &lt;span class="mf"&gt;1.21072326778&lt;/span&gt; &lt;span class="mf"&gt;0.685453745388&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.42818645703&lt;/span&gt; &lt;span class="mf"&gt;0.985092492299&lt;/span&gt; &lt;span class="mf"&gt;1.14459347392&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.40604855634&lt;/span&gt; &lt;span class="mf"&gt;1.03039180178&lt;/span&gt; &lt;span class="mf"&gt;1.0221847815&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.501959939749&lt;/span&gt; &lt;span class="mf"&gt;0.818277595369&lt;/span&gt; &lt;span class="mf"&gt;0.98203043022&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.496883864198&lt;/span&gt; &lt;span class="mf"&gt;0.884192532918&lt;/span&gt; &lt;span class="mf"&gt;0.874850979928&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.3629141421&lt;/span&gt; &lt;span class="mf"&gt;0.660376992858&lt;/span&gt; &lt;span class="mf"&gt;0.741408540094&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.43287403107&lt;/span&gt; &lt;span class="mf"&gt;0.754663287412&lt;/span&gt; &lt;span class="mf"&gt;0.80945367769&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.88731882341&lt;/span&gt; &lt;span class="mf"&gt;1.01235055682&lt;/span&gt; &lt;span class="mf"&gt;0.761407270758&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.921746352774&lt;/span&gt; &lt;span class="mf"&gt;0.989740039942&lt;/span&gt; &lt;span class="mf"&gt;0.636936922452&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.902074180009&lt;/span&gt; &lt;span class="mf"&gt;1.16786878448&lt;/span&gt; &lt;span class="mf"&gt;0.686409132451&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.880754916562&lt;/span&gt; &lt;span class="mf"&gt;1.28857258911&lt;/span&gt; &lt;span class="mf"&gt;0.734293148969&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.20818239515&lt;/span&gt; &lt;span class="mf"&gt;0.594553701384&lt;/span&gt; &lt;span class="mf"&gt;0.661167196967&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.23049461801&lt;/span&gt; &lt;span class="mf"&gt;0.478967860407&lt;/span&gt; &lt;span class="mf"&gt;0.725150289409&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.800044934502&lt;/span&gt; &lt;span class="mf"&gt;1.07074408489&lt;/span&gt; &lt;span class="mf"&gt;0.951595386386&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.830195731645&lt;/span&gt; &lt;span class="mf"&gt;0.943031936499&lt;/span&gt; &lt;span class="mf"&gt;0.928683021359&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.646418525539&lt;/span&gt; &lt;span class="mf"&gt;1.23949438107&lt;/span&gt; &lt;span class="mf"&gt;1.36054429137&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.683390312426&lt;/span&gt; &lt;span class="mf"&gt;1.34626527435&lt;/span&gt; &lt;span class="mf"&gt;1.43572419863&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.24986798903&lt;/span&gt; &lt;span class="mf"&gt;1.18033011204&lt;/span&gt; &lt;span class="mf"&gt;1.80907744643&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.22760806282&lt;/span&gt; &lt;span class="mf"&gt;1.2866260197&lt;/span&gt; &lt;span class="mf"&gt;1.87128905324&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.625272230308&lt;/span&gt; &lt;span class="mf"&gt;1.50671580408&lt;/span&gt; &lt;span class="mf"&gt;1.54202382967&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.535658193142&lt;/span&gt; &lt;span class="mf"&gt;1.43206825644&lt;/span&gt; &lt;span class="mf"&gt;1.53148512338&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.4713100396&lt;/span&gt; &lt;span class="mf"&gt;0.673917594692&lt;/span&gt; &lt;span class="mf"&gt;0.538588328877&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.57402514978&lt;/span&gt; &lt;span class="mf"&gt;0.751981264597&lt;/span&gt; &lt;span class="mf"&gt;0.544835494026&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.949492265511&lt;/span&gt; &lt;span class="mf"&gt;0.674646109061&lt;/span&gt; &lt;span class="mf"&gt;2.01927876316&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.0533313306&lt;/span&gt; &lt;span class="mf"&gt;0.647151440273&lt;/span&gt; &lt;span class="mf"&gt;2.08902565752&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.863003249501&lt;/span&gt; &lt;span class="mf"&gt;0.521055664624&lt;/span&gt; &lt;span class="mf"&gt;1.28386834445&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.915682564398&lt;/span&gt; &lt;span class="mf"&gt;0.527658159293&lt;/span&gt; &lt;span class="mf"&gt;1.16331449074&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.53407033815&lt;/span&gt; &lt;span class="mf"&gt;1.26134955827&lt;/span&gt; &lt;span class="mf"&gt;0.900975781065&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.42385751278&lt;/span&gt; &lt;span class="mf"&gt;1.25535329858&lt;/span&gt; &lt;span class="mf"&gt;0.838775090546&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.83110787665&lt;/span&gt; &lt;span class="mf"&gt;1.110282385&lt;/span&gt; &lt;span class="mf"&gt;1.26734920286&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.82474283248&lt;/span&gt; &lt;span class="mf"&gt;1.00062798294&lt;/span&gt; &lt;span class="mf"&gt;1.19666672308&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.82245294994&lt;/span&gt; &lt;span class="mf"&gt;0.769117895948&lt;/span&gt; &lt;span class="mf"&gt;0.891854923332&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.76170404157&lt;/span&gt; &lt;span class="mf"&gt;0.803360186846&lt;/span&gt; &lt;span class="mf"&gt;1.00857690485&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.40859916055&lt;/span&gt; &lt;span class="mf"&gt;0.85375351183&lt;/span&gt; &lt;span class="mf"&gt;1.29727025014&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.33183749111&lt;/span&gt; &lt;span class="mf"&gt;0.802479098264&lt;/span&gt; &lt;span class="mf"&gt;1.21061545882&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.446815997021&lt;/span&gt; &lt;span class="mf"&gt;1.21367328978&lt;/span&gt; &lt;span class="mf"&gt;1.18704210811&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.358139576211&lt;/span&gt; &lt;span class="mf"&gt;1.2353378973&lt;/span&gt; &lt;span class="mf"&gt;1.2831327218&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.66086932607&lt;/span&gt; &lt;span class="mf"&gt;0.922097112683&lt;/span&gt; &lt;span class="mf"&gt;1.3729647463&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.67285642961&lt;/span&gt; &lt;span class="mf"&gt;1.01279677081&lt;/span&gt; &lt;span class="mf"&gt;1.29008411468&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.957590545984&lt;/span&gt; &lt;span class="mf"&gt;0.632685153844&lt;/span&gt; &lt;span class="mf"&gt;1.5060956064&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.933899400873&lt;/span&gt; &lt;span class="mf"&gt;0.523855397218&lt;/span&gt; &lt;span class="mf"&gt;1.57795696104&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.551201722912&lt;/span&gt; &lt;span class="mf"&gt;1.10626459737&lt;/span&gt; &lt;span class="mf"&gt;0.546421995058&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.537420031818&lt;/span&gt; &lt;span class="mf"&gt;1.03579316589&lt;/span&gt; &lt;span class="mf"&gt;0.432327962631&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.25434925363&lt;/span&gt; &lt;span class="mf"&gt;1.20460235927&lt;/span&gt; &lt;span class="mf"&gt;1.50925904614&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.3737658667&lt;/span&gt; &lt;span class="mf"&gt;1.17283730495&lt;/span&gt; &lt;span class="mf"&gt;1.48596918052&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.0930285516&lt;/span&gt; &lt;span class="mf"&gt;0.750098754358&lt;/span&gt; &lt;span class="mf"&gt;1.77176970856&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.07449065769&lt;/span&gt; &lt;span class="mf"&gt;0.765123464103&lt;/span&gt; &lt;span class="mf"&gt;1.64081863724&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.546249449954&lt;/span&gt; &lt;span class="mf"&gt;1.66335714044&lt;/span&gt; &lt;span class="mf"&gt;1.3301193176&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.539837355719&lt;/span&gt; &lt;span class="mf"&gt;1.59276799919&lt;/span&gt; &lt;span class="mf"&gt;1.21536616119&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.251858392851&lt;/span&gt; &lt;span class="mf"&gt;0.879943302982&lt;/span&gt; &lt;span class="mf"&gt;1.52049774904&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.232733811732&lt;/span&gt; &lt;span class="mf"&gt;0.878230376062&lt;/span&gt; &lt;span class="mf"&gt;1.3938625055&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.00160816437&lt;/span&gt; &lt;span class="mf"&gt;1.20912948922&lt;/span&gt; &lt;span class="mf"&gt;1.04366550452&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.879809684189&lt;/span&gt; &lt;span class="mf"&gt;1.16527443049&lt;/span&gt; &lt;span class="mf"&gt;1.06027476898&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.603268794638&lt;/span&gt; &lt;span class="mf"&gt;0.750526859154&lt;/span&gt; &lt;span class="mf"&gt;1.13895787496&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.585660731815&lt;/span&gt; &lt;span class="mf"&gt;0.876426733913&lt;/span&gt; &lt;span class="mf"&gt;1.13619165285&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.37529253969&lt;/span&gt; &lt;span class="mf"&gt;0.488983600176&lt;/span&gt; &lt;span class="mf"&gt;1.02619588397&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.39717259588&lt;/span&gt; &lt;span class="mf"&gt;0.536500440037&lt;/span&gt; &lt;span class="mf"&gt;0.915897251464&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.1347961446&lt;/span&gt; &lt;span class="mf"&gt;1.04030303287&lt;/span&gt; &lt;span class="mf"&gt;0.712572436787&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.2586348712&lt;/span&gt; &lt;span class="mf"&gt;1.00216734929&lt;/span&gt; &lt;span class="mf"&gt;0.714364908777&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.737165741462&lt;/span&gt; &lt;span class="mf"&gt;1.46138696138&lt;/span&gt; &lt;span class="mf"&gt;1.0475441729&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.76957561859&lt;/span&gt; &lt;span class="mf"&gt;1.40887164472&lt;/span&gt; &lt;span class="mf"&gt;1.16059464171&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.1214859696&lt;/span&gt; &lt;span class="mf"&gt;0.641684916901&lt;/span&gt; &lt;span class="mf"&gt;0.389652286498&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.11558770267&lt;/span&gt; &lt;span class="mf"&gt;0.759554293741&lt;/span&gt; &lt;span class="mf"&gt;0.441533019666&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.20594083201&lt;/span&gt; &lt;span class="mf"&gt;0.843863859459&lt;/span&gt; &lt;span class="mf"&gt;0.920729868328&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.12773880445&lt;/span&gt; &lt;span class="mf"&gt;0.920750008462&lt;/span&gt; &lt;span class="mf"&gt;0.980929577226&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.54368022882&lt;/span&gt; &lt;span class="mf"&gt;1.42857944352&lt;/span&gt; &lt;span class="mf"&gt;1.82970407542&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.52811452798&lt;/span&gt; &lt;span class="mf"&gt;1.5493060962&lt;/span&gt; &lt;span class="mf"&gt;1.77275572894&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.933341569915&lt;/span&gt; &lt;span class="mf"&gt;0.323901262566&lt;/span&gt; &lt;span class="mf"&gt;0.902686761669&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.880308702569&lt;/span&gt; &lt;span class="mf"&gt;0.433772467251&lt;/span&gt; &lt;span class="mf"&gt;0.848669820262&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.42239016011&lt;/span&gt; &lt;span class="mf"&gt;0.958958890431&lt;/span&gt; &lt;span class="mf"&gt;1.59115518058&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.39053955252&lt;/span&gt; &lt;span class="mf"&gt;0.845954625461&lt;/span&gt; &lt;span class="mf"&gt;1.64973030836&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.904962681515&lt;/span&gt; &lt;span class="mf"&gt;0.791378668382&lt;/span&gt; &lt;span class="mf"&gt;1.15554928409&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.984347053448&lt;/span&gt; &lt;span class="mf"&gt;0.791743729479&lt;/span&gt; &lt;span class="mf"&gt;1.2649901838&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.65924550655&lt;/span&gt; &lt;span class="mf"&gt;1.26477194259&lt;/span&gt; &lt;span class="mf"&gt;1.06843330061&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.567882070203&lt;/span&gt; &lt;span class="mf"&gt;1.15486240395&lt;/span&gt; &lt;span class="mf"&gt;1.0701736452&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.863088210405&lt;/span&gt; &lt;span class="mf"&gt;0.879352892394&lt;/span&gt; &lt;span class="mf"&gt;1.41566301662&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.793631994043&lt;/span&gt; &lt;span class="mf"&gt;0.772252987171&lt;/span&gt; &lt;span class="mf"&gt;1.38942947568&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.1214436584&lt;/span&gt; &lt;span class="mf"&gt;0.328405375216&lt;/span&gt; &lt;span class="mf"&gt;1.20715423281&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.01978683614&lt;/span&gt; &lt;span class="mf"&gt;0.413442016721&lt;/span&gt; &lt;span class="mf"&gt;1.25119926886&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.0790327658&lt;/span&gt; &lt;span class="mf"&gt;1.41247715195&lt;/span&gt; &lt;span class="mf"&gt;0.840384608875&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.19636343635&lt;/span&gt; &lt;span class="mf"&gt;1.47734378702&lt;/span&gt; &lt;span class="mf"&gt;0.889675049927&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.928021527942&lt;/span&gt; &lt;span class="mf"&gt;0.707212114545&lt;/span&gt; &lt;span class="mf"&gt;0.729177300883&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.798175963849&lt;/span&gt; &lt;span class="mf"&gt;0.728686406255&lt;/span&gt; &lt;span class="mf"&gt;0.710141488678&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.727429678773&lt;/span&gt; &lt;span class="mf"&gt;0.844713976238&lt;/span&gt; &lt;span class="mf"&gt;1.57712486884&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.662433148292&lt;/span&gt; &lt;span class="mf"&gt;0.878843634702&lt;/span&gt; &lt;span class="mf"&gt;1.6949460109&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.09760188539&lt;/span&gt; &lt;span class="mf"&gt;0.914122804048&lt;/span&gt; &lt;span class="mf"&gt;1.18704253123&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.22259553871&lt;/span&gt; &lt;span class="mf"&gt;0.945083776191&lt;/span&gt; &lt;span class="mf"&gt;1.17783011204&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.663454963951&lt;/span&gt; &lt;span class="mf"&gt;0.989731239211&lt;/span&gt; &lt;span class="mf"&gt;0.839021511018&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.599193209897&lt;/span&gt; &lt;span class="mf"&gt;1.02499153776&lt;/span&gt; &lt;span class="mf"&gt;0.734202010629&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.22917552381&lt;/span&gt; &lt;span class="mf"&gt;0.615682902887&lt;/span&gt; &lt;span class="mf"&gt;1.20064211488&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.25094929425&lt;/span&gt; &lt;span class="mf"&gt;0.630362776292&lt;/span&gt; &lt;span class="mf"&gt;1.07951680601&lt;/span&gt;
&lt;span class="n"&gt;BASISSET&lt;/span&gt;
&lt;span class="n"&gt;POB&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;TZVP&lt;/span&gt;
&lt;span class="n"&gt;EXCHPERM&lt;/span&gt;
&lt;span class="n"&gt;DFT&lt;/span&gt;
&lt;span class="n"&gt;BLYP&lt;/span&gt;
&lt;span class="n"&gt;CHUNKS&lt;/span&gt;
&lt;span class="mi"&gt;200&lt;/span&gt;
&lt;span class="kr"&gt;END&lt;/span&gt;
&lt;span class="n"&gt;SHRINK&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;FMIXING&lt;/span&gt;
&lt;span class="mi"&gt;30&lt;/span&gt;
&lt;span class="n"&gt;LEVSHIFT&lt;/span&gt;
&lt;span class="mi"&gt;6&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="kr"&gt;END&lt;/span&gt;
&lt;span class="kr"&gt;END&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;INPUT for lc-blyp calculation&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;Water&lt;/span&gt; &lt;span class="n"&gt;cube&lt;/span&gt;
&lt;span class="n"&gt;CRYSTAL&lt;/span&gt;
&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="mf"&gt;11.8172&lt;/span&gt; &lt;span class="mf"&gt;11.8172&lt;/span&gt; &lt;span class="mf"&gt;11.8172&lt;/span&gt; &lt;span class="mi"&gt;90&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="mi"&gt;90&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="mi"&gt;90&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;span class="mi"&gt;165&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.966182090512&lt;/span&gt; &lt;span class="mf"&gt;1.00021468707&lt;/span&gt; &lt;span class="mf"&gt;1.4854507836&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.03919930271&lt;/span&gt; &lt;span class="mf"&gt;1.40081195207&lt;/span&gt; &lt;span class="mf"&gt;1.57239938395&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.2300162475&lt;/span&gt; &lt;span class="mf"&gt;0.527247909826&lt;/span&gt; &lt;span class="mf"&gt;1.33289637139&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.768640540906&lt;/span&gt; &lt;span class="mf"&gt;1.65014267339&lt;/span&gt; &lt;span class="mf"&gt;1.3298380327&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.15689283417&lt;/span&gt; &lt;span class="mf"&gt;1.2052291575&lt;/span&gt; &lt;span class="mf"&gt;1.08481399993&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.903492451681&lt;/span&gt; &lt;span class="mf"&gt;1.21632146363&lt;/span&gt; &lt;span class="mf"&gt;1.38370900044&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.762101766916&lt;/span&gt; &lt;span class="mf"&gt;0.505654892868&lt;/span&gt; &lt;span class="mf"&gt;0.887620671563&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.38305427682&lt;/span&gt; &lt;span class="mf"&gt;0.459265985174&lt;/span&gt; &lt;span class="mf"&gt;1.53107572014&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.50650348644&lt;/span&gt; &lt;span class="mf"&gt;0.456861016146&lt;/span&gt; &lt;span class="mf"&gt;1.17375080391&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.63803650611&lt;/span&gt; &lt;span class="mf"&gt;1.15520588634&lt;/span&gt; &lt;span class="mf"&gt;0.658485597265&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.45252310192&lt;/span&gt; &lt;span class="mf"&gt;1.04503698&lt;/span&gt; &lt;span class="mf"&gt;1.09088574282&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.446270182446&lt;/span&gt; &lt;span class="mf"&gt;0.842531479538&lt;/span&gt; &lt;span class="mf"&gt;0.927859729885&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.43138112243&lt;/span&gt; &lt;span class="mf"&gt;0.708681921267&lt;/span&gt; &lt;span class="mf"&gt;0.740832092205&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.937938767221&lt;/span&gt; &lt;span class="mf"&gt;1.03809015672&lt;/span&gt; &lt;span class="mf"&gt;0.702070372&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.863986223471&lt;/span&gt; &lt;span class="mf"&gt;1.24494550316&lt;/span&gt; &lt;span class="mf"&gt;0.67097527333&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.26616296585&lt;/span&gt; &lt;span class="mf"&gt;0.550525843685&lt;/span&gt; &lt;span class="mf"&gt;0.700526097553&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.808251954778&lt;/span&gt; &lt;span class="mf"&gt;1.01392546458&lt;/span&gt; &lt;span class="mf"&gt;0.888978438209&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.700633060285&lt;/span&gt; &lt;span class="mf"&gt;1.30514241952&lt;/span&gt; &lt;span class="mf"&gt;1.36784449785&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.27978945943&lt;/span&gt; &lt;span class="mf"&gt;1.22268439224&lt;/span&gt; &lt;span class="mf"&gt;1.87452839928&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.61985597265&lt;/span&gt; &lt;span class="mf"&gt;1.42719138205&lt;/span&gt; &lt;span class="mf"&gt;1.54634253461&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.52579096571&lt;/span&gt; &lt;span class="mf"&gt;0.709874674204&lt;/span&gt; &lt;span class="mf"&gt;0.49502242494&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.984720576786&lt;/span&gt; &lt;span class="mf"&gt;0.61250702366&lt;/span&gt; &lt;span class="mf"&gt;2.05818366449&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.900647784585&lt;/span&gt; &lt;span class="mf"&gt;0.474448261856&lt;/span&gt; &lt;span class="mf"&gt;1.22569508852&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.49653835088&lt;/span&gt; &lt;span class="mf"&gt;1.28823308398&lt;/span&gt; &lt;span class="mf"&gt;0.830222810818&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.79160029449&lt;/span&gt; &lt;span class="mf"&gt;1.07211158312&lt;/span&gt; &lt;span class="mf"&gt;1.2086718512&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.83282960431&lt;/span&gt; &lt;span class="mf"&gt;0.803301205023&lt;/span&gt; &lt;span class="mf"&gt;0.9671824967&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.34537504654&lt;/span&gt; &lt;span class="mf"&gt;0.873155146735&lt;/span&gt; &lt;span class="mf"&gt;1.24777189182&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.4377635142&lt;/span&gt; &lt;span class="mf"&gt;1.24948481874&lt;/span&gt; &lt;span class="mf"&gt;1.26121712419&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.61083522323&lt;/span&gt; &lt;span class="mf"&gt;0.963454117727&lt;/span&gt; &lt;span class="mf"&gt;1.32491478523&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.89343812409&lt;/span&gt; &lt;span class="mf"&gt;0.582376366652&lt;/span&gt; &lt;span class="mf"&gt;1.52855871103&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.492430694242&lt;/span&gt; &lt;span class="mf"&gt;1.0714599059&lt;/span&gt; &lt;span class="mf"&gt;0.497475290255&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.32287047693&lt;/span&gt; &lt;span class="mf"&gt;1.24018718478&lt;/span&gt; &lt;span class="mf"&gt;1.48182623633&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.08089682835&lt;/span&gt; &lt;span class="mf"&gt;0.710079629692&lt;/span&gt; &lt;span class="mf"&gt;1.69978937481&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.566233625563&lt;/span&gt; &lt;span class="mf"&gt;1.66400610974&lt;/span&gt; &lt;span class="mf"&gt;1.25198558034&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.188996462783&lt;/span&gt; &lt;span class="mf"&gt;0.885536929222&lt;/span&gt; &lt;span class="mf"&gt;1.46524041228&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.92452552212&lt;/span&gt; &lt;span class="mf"&gt;1.23048649426&lt;/span&gt; &lt;span class="mf"&gt;1.03169295603&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.617660274854&lt;/span&gt; &lt;span class="mf"&gt;0.817834258538&lt;/span&gt; &lt;span class="mf"&gt;1.08969459771&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.33952662221&lt;/span&gt; &lt;span class="mf"&gt;0.537026114477&lt;/span&gt; &lt;span class="mf"&gt;0.97252276343&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.21163067393&lt;/span&gt; &lt;span class="mf"&gt;1.07015274346&lt;/span&gt; &lt;span class="mf"&gt;0.705801289646&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.708953559219&lt;/span&gt; &lt;span class="mf"&gt;1.40961251396&lt;/span&gt; &lt;span class="mf"&gt;1.10277104559&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.06568992655&lt;/span&gt; &lt;span class="mf"&gt;0.706494854957&lt;/span&gt; &lt;span class="mf"&gt;0.400919507159&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.12978751312&lt;/span&gt; &lt;span class="mf"&gt;0.876184290695&lt;/span&gt; &lt;span class="mf"&gt;0.910686033917&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.55138340724&lt;/span&gt; &lt;span class="mf"&gt;1.51283019666&lt;/span&gt; &lt;span class="mf"&gt;1.84138306875&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.943388281488&lt;/span&gt; &lt;span class="mf"&gt;0.379874928071&lt;/span&gt; &lt;span class="mf"&gt;0.842503892631&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.35594709407&lt;/span&gt; &lt;span class="mf"&gt;0.919504451139&lt;/span&gt; &lt;span class="mf"&gt;1.62474444031&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.948775175168&lt;/span&gt; &lt;span class="mf"&gt;0.840589733609&lt;/span&gt; &lt;span class="mf"&gt;1.20458492706&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.622394898961&lt;/span&gt; &lt;span class="mf"&gt;1.20107174288&lt;/span&gt; &lt;span class="mf"&gt;1.02580848255&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.784972836205&lt;/span&gt; &lt;span class="mf"&gt;0.848350032157&lt;/span&gt; &lt;span class="mf"&gt;1.42938403344&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.08217014183&lt;/span&gt; &lt;span class="mf"&gt;0.360261737129&lt;/span&gt; &lt;span class="mf"&gt;1.27039222489&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.16518735403&lt;/span&gt; &lt;span class="mf"&gt;1.41018464611&lt;/span&gt; &lt;span class="mf"&gt;0.848232999357&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.851257319839&lt;/span&gt; &lt;span class="mf"&gt;0.708795315303&lt;/span&gt; &lt;span class="mf"&gt;0.771359374471&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.682134261923&lt;/span&gt; &lt;span class="mf"&gt;0.819043512846&lt;/span&gt; &lt;span class="mf"&gt;1.64355321057&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.15068908032&lt;/span&gt; &lt;span class="mf"&gt;0.962640642453&lt;/span&gt; &lt;span class="mf"&gt;1.15036303016&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;0.595814321497&lt;/span&gt; &lt;span class="mf"&gt;0.971598517415&lt;/span&gt; &lt;span class="mf"&gt;0.797778153877&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;1.22474054768&lt;/span&gt; &lt;span class="mf"&gt;0.674640862472&lt;/span&gt; &lt;span class="mf"&gt;1.14489794537&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.04184933825&lt;/span&gt; &lt;span class="mf"&gt;0.980869495312&lt;/span&gt; &lt;span class="mf"&gt;1.46944707714&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.966587770369&lt;/span&gt; &lt;span class="mf"&gt;1.07866017331&lt;/span&gt; &lt;span class="mf"&gt;1.46048801747&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.00937303253&lt;/span&gt; &lt;span class="mf"&gt;1.3425173476&lt;/span&gt; &lt;span class="mf"&gt;1.52038587821&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.996500440037&lt;/span&gt; &lt;span class="mf"&gt;1.36528094642&lt;/span&gt; &lt;span class="mf"&gt;1.63609315235&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.19357995126&lt;/span&gt; &lt;span class="mf"&gt;0.452229885252&lt;/span&gt; &lt;span class="mf"&gt;1.3260631114&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.2984623261&lt;/span&gt; &lt;span class="mf"&gt;0.518463849304&lt;/span&gt; &lt;span class="mf"&gt;1.38540804928&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.69602291575&lt;/span&gt; &lt;span class="mf"&gt;1.63709626646&lt;/span&gt; &lt;span class="mf"&gt;1.29537860068&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.773463595437&lt;/span&gt; &lt;span class="mf"&gt;1.60575229327&lt;/span&gt; &lt;span class="mf"&gt;1.39931286599&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.20908819348&lt;/span&gt; &lt;span class="mf"&gt;1.22614197949&lt;/span&gt; &lt;span class="mf"&gt;1.02950817453&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.16437641743&lt;/span&gt; &lt;span class="mf"&gt;1.12178147108&lt;/span&gt; &lt;span class="mf"&gt;1.09562891379&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.947235893443&lt;/span&gt; &lt;span class="mf"&gt;1.26596960363&lt;/span&gt; &lt;span class="mf"&gt;1.33223919372&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.828159800968&lt;/span&gt; &lt;span class="mf"&gt;1.25201502894&lt;/span&gt; &lt;span class="mf"&gt;1.3869174593&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.780803151339&lt;/span&gt; &lt;span class="mf"&gt;0.587075533967&lt;/span&gt; &lt;span class="mf"&gt;0.881474714822&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.68113961006&lt;/span&gt; &lt;span class="mf"&gt;0.5006251904&lt;/span&gt; &lt;span class="mf"&gt;0.86950588972&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.3673395559&lt;/span&gt; &lt;span class="mf"&gt;0.378040991098&lt;/span&gt; &lt;span class="mf"&gt;1.51693726094&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.33352156179&lt;/span&gt; &lt;span class="mf"&gt;0.485049588735&lt;/span&gt; &lt;span class="mf"&gt;1.59441102799&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.47586949531&lt;/span&gt; &lt;span class="mf"&gt;0.39175532275&lt;/span&gt; &lt;span class="mf"&gt;1.222188928&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.58466718004&lt;/span&gt; &lt;span class="mf"&gt;0.431308601022&lt;/span&gt; &lt;span class="mf"&gt;1.15432369766&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.712842297668&lt;/span&gt; &lt;span class="mf"&gt;1.19142317977&lt;/span&gt; &lt;span class="mf"&gt;0.671666130725&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.583473242392&lt;/span&gt; &lt;span class="mf"&gt;1.21072326778&lt;/span&gt; &lt;span class="mf"&gt;0.685453745388&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.42818645703&lt;/span&gt; &lt;span class="mf"&gt;0.985092492299&lt;/span&gt; &lt;span class="mf"&gt;1.14459347392&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.40604855634&lt;/span&gt; &lt;span class="mf"&gt;1.03039180178&lt;/span&gt; &lt;span class="mf"&gt;1.0221847815&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.501959939749&lt;/span&gt; &lt;span class="mf"&gt;0.818277595369&lt;/span&gt; &lt;span class="mf"&gt;0.98203043022&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.496883864198&lt;/span&gt; &lt;span class="mf"&gt;0.884192532918&lt;/span&gt; &lt;span class="mf"&gt;0.874850979928&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.3629141421&lt;/span&gt; &lt;span class="mf"&gt;0.660376992858&lt;/span&gt; &lt;span class="mf"&gt;0.741408540094&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.43287403107&lt;/span&gt; &lt;span class="mf"&gt;0.754663287412&lt;/span&gt; &lt;span class="mf"&gt;0.80945367769&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.88731882341&lt;/span&gt; &lt;span class="mf"&gt;1.01235055682&lt;/span&gt; &lt;span class="mf"&gt;0.761407270758&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.921746352774&lt;/span&gt; &lt;span class="mf"&gt;0.989740039942&lt;/span&gt; &lt;span class="mf"&gt;0.636936922452&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.902074180009&lt;/span&gt; &lt;span class="mf"&gt;1.16786878448&lt;/span&gt; &lt;span class="mf"&gt;0.686409132451&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.880754916562&lt;/span&gt; &lt;span class="mf"&gt;1.28857258911&lt;/span&gt; &lt;span class="mf"&gt;0.734293148969&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.20818239515&lt;/span&gt; &lt;span class="mf"&gt;0.594553701384&lt;/span&gt; &lt;span class="mf"&gt;0.661167196967&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.23049461801&lt;/span&gt; &lt;span class="mf"&gt;0.478967860407&lt;/span&gt; &lt;span class="mf"&gt;0.725150289409&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.800044934502&lt;/span&gt; &lt;span class="mf"&gt;1.07074408489&lt;/span&gt; &lt;span class="mf"&gt;0.951595386386&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.830195731645&lt;/span&gt; &lt;span class="mf"&gt;0.943031936499&lt;/span&gt; &lt;span class="mf"&gt;0.928683021359&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.646418525539&lt;/span&gt; &lt;span class="mf"&gt;1.23949438107&lt;/span&gt; &lt;span class="mf"&gt;1.36054429137&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.683390312426&lt;/span&gt; &lt;span class="mf"&gt;1.34626527435&lt;/span&gt; &lt;span class="mf"&gt;1.43572419863&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.24986798903&lt;/span&gt; &lt;span class="mf"&gt;1.18033011204&lt;/span&gt; &lt;span class="mf"&gt;1.80907744643&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.22760806282&lt;/span&gt; &lt;span class="mf"&gt;1.2866260197&lt;/span&gt; &lt;span class="mf"&gt;1.87128905324&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.625272230308&lt;/span&gt; &lt;span class="mf"&gt;1.50671580408&lt;/span&gt; &lt;span class="mf"&gt;1.54202382967&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.535658193142&lt;/span&gt; &lt;span class="mf"&gt;1.43206825644&lt;/span&gt; &lt;span class="mf"&gt;1.53148512338&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.4713100396&lt;/span&gt; &lt;span class="mf"&gt;0.673917594692&lt;/span&gt; &lt;span class="mf"&gt;0.538588328877&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.57402514978&lt;/span&gt; &lt;span class="mf"&gt;0.751981264597&lt;/span&gt; &lt;span class="mf"&gt;0.544835494026&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.949492265511&lt;/span&gt; &lt;span class="mf"&gt;0.674646109061&lt;/span&gt; &lt;span class="mf"&gt;2.01927876316&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.0533313306&lt;/span&gt; &lt;span class="mf"&gt;0.647151440273&lt;/span&gt; &lt;span class="mf"&gt;2.08902565752&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.863003249501&lt;/span&gt; &lt;span class="mf"&gt;0.521055664624&lt;/span&gt; &lt;span class="mf"&gt;1.28386834445&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.915682564398&lt;/span&gt; &lt;span class="mf"&gt;0.527658159293&lt;/span&gt; &lt;span class="mf"&gt;1.16331449074&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.53407033815&lt;/span&gt; &lt;span class="mf"&gt;1.26134955827&lt;/span&gt; &lt;span class="mf"&gt;0.900975781065&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.42385751278&lt;/span&gt; &lt;span class="mf"&gt;1.25535329858&lt;/span&gt; &lt;span class="mf"&gt;0.838775090546&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.83110787665&lt;/span&gt; &lt;span class="mf"&gt;1.110282385&lt;/span&gt; &lt;span class="mf"&gt;1.26734920286&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.82474283248&lt;/span&gt; &lt;span class="mf"&gt;1.00062798294&lt;/span&gt; &lt;span class="mf"&gt;1.19666672308&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.82245294994&lt;/span&gt; &lt;span class="mf"&gt;0.769117895948&lt;/span&gt; &lt;span class="mf"&gt;0.891854923332&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.76170404157&lt;/span&gt; &lt;span class="mf"&gt;0.803360186846&lt;/span&gt; &lt;span class="mf"&gt;1.00857690485&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.40859916055&lt;/span&gt; &lt;span class="mf"&gt;0.85375351183&lt;/span&gt; &lt;span class="mf"&gt;1.29727025014&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.33183749111&lt;/span&gt; &lt;span class="mf"&gt;0.802479098264&lt;/span&gt; &lt;span class="mf"&gt;1.21061545882&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.446815997021&lt;/span&gt; &lt;span class="mf"&gt;1.21367328978&lt;/span&gt; &lt;span class="mf"&gt;1.18704210811&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.358139576211&lt;/span&gt; &lt;span class="mf"&gt;1.2353378973&lt;/span&gt; &lt;span class="mf"&gt;1.2831327218&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.66086932607&lt;/span&gt; &lt;span class="mf"&gt;0.922097112683&lt;/span&gt; &lt;span class="mf"&gt;1.3729647463&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.67285642961&lt;/span&gt; &lt;span class="mf"&gt;1.01279677081&lt;/span&gt; &lt;span class="mf"&gt;1.29008411468&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.957590545984&lt;/span&gt; &lt;span class="mf"&gt;0.632685153844&lt;/span&gt; &lt;span class="mf"&gt;1.5060956064&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.933899400873&lt;/span&gt; &lt;span class="mf"&gt;0.523855397218&lt;/span&gt; &lt;span class="mf"&gt;1.57795696104&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.551201722912&lt;/span&gt; &lt;span class="mf"&gt;1.10626459737&lt;/span&gt; &lt;span class="mf"&gt;0.546421995058&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.537420031818&lt;/span&gt; &lt;span class="mf"&gt;1.03579316589&lt;/span&gt; &lt;span class="mf"&gt;0.432327962631&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.25434925363&lt;/span&gt; &lt;span class="mf"&gt;1.20460235927&lt;/span&gt; &lt;span class="mf"&gt;1.50925904614&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.3737658667&lt;/span&gt; &lt;span class="mf"&gt;1.17283730495&lt;/span&gt; &lt;span class="mf"&gt;1.48596918052&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.0930285516&lt;/span&gt; &lt;span class="mf"&gt;0.750098754358&lt;/span&gt; &lt;span class="mf"&gt;1.77176970856&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.07449065769&lt;/span&gt; &lt;span class="mf"&gt;0.765123464103&lt;/span&gt; &lt;span class="mf"&gt;1.64081863724&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.546249449954&lt;/span&gt; &lt;span class="mf"&gt;1.66335714044&lt;/span&gt; &lt;span class="mf"&gt;1.3301193176&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.539837355719&lt;/span&gt; &lt;span class="mf"&gt;1.59276799919&lt;/span&gt; &lt;span class="mf"&gt;1.21536616119&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.251858392851&lt;/span&gt; &lt;span class="mf"&gt;0.879943302982&lt;/span&gt; &lt;span class="mf"&gt;1.52049774904&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.232733811732&lt;/span&gt; &lt;span class="mf"&gt;0.878230376062&lt;/span&gt; &lt;span class="mf"&gt;1.3938625055&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.00160816437&lt;/span&gt; &lt;span class="mf"&gt;1.20912948922&lt;/span&gt; &lt;span class="mf"&gt;1.04366550452&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.879809684189&lt;/span&gt; &lt;span class="mf"&gt;1.16527443049&lt;/span&gt; &lt;span class="mf"&gt;1.06027476898&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.603268794638&lt;/span&gt; &lt;span class="mf"&gt;0.750526859154&lt;/span&gt; &lt;span class="mf"&gt;1.13895787496&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.585660731815&lt;/span&gt; &lt;span class="mf"&gt;0.876426733913&lt;/span&gt; &lt;span class="mf"&gt;1.13619165285&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.37529253969&lt;/span&gt; &lt;span class="mf"&gt;0.488983600176&lt;/span&gt; &lt;span class="mf"&gt;1.02619588397&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.39717259588&lt;/span&gt; &lt;span class="mf"&gt;0.536500440037&lt;/span&gt; &lt;span class="mf"&gt;0.915897251464&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.1347961446&lt;/span&gt; &lt;span class="mf"&gt;1.04030303287&lt;/span&gt; &lt;span class="mf"&gt;0.712572436787&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.2586348712&lt;/span&gt; &lt;span class="mf"&gt;1.00216734929&lt;/span&gt; &lt;span class="mf"&gt;0.714364908777&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.737165741462&lt;/span&gt; &lt;span class="mf"&gt;1.46138696138&lt;/span&gt; &lt;span class="mf"&gt;1.0475441729&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.76957561859&lt;/span&gt; &lt;span class="mf"&gt;1.40887164472&lt;/span&gt; &lt;span class="mf"&gt;1.16059464171&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.1214859696&lt;/span&gt; &lt;span class="mf"&gt;0.641684916901&lt;/span&gt; &lt;span class="mf"&gt;0.389652286498&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.11558770267&lt;/span&gt; &lt;span class="mf"&gt;0.759554293741&lt;/span&gt; &lt;span class="mf"&gt;0.441533019666&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.20594083201&lt;/span&gt; &lt;span class="mf"&gt;0.843863859459&lt;/span&gt; &lt;span class="mf"&gt;0.920729868328&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.12773880445&lt;/span&gt; &lt;span class="mf"&gt;0.920750008462&lt;/span&gt; &lt;span class="mf"&gt;0.980929577226&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.54368022882&lt;/span&gt; &lt;span class="mf"&gt;1.42857944352&lt;/span&gt; &lt;span class="mf"&gt;1.82970407542&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.52811452798&lt;/span&gt; &lt;span class="mf"&gt;1.5493060962&lt;/span&gt; &lt;span class="mf"&gt;1.77275572894&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.933341569915&lt;/span&gt; &lt;span class="mf"&gt;0.323901262566&lt;/span&gt; &lt;span class="mf"&gt;0.902686761669&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.880308702569&lt;/span&gt; &lt;span class="mf"&gt;0.433772467251&lt;/span&gt; &lt;span class="mf"&gt;0.848669820262&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.42239016011&lt;/span&gt; &lt;span class="mf"&gt;0.958958890431&lt;/span&gt; &lt;span class="mf"&gt;1.59115518058&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.39053955252&lt;/span&gt; &lt;span class="mf"&gt;0.845954625461&lt;/span&gt; &lt;span class="mf"&gt;1.64973030836&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.904962681515&lt;/span&gt; &lt;span class="mf"&gt;0.791378668382&lt;/span&gt; &lt;span class="mf"&gt;1.15554928409&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.984347053448&lt;/span&gt; &lt;span class="mf"&gt;0.791743729479&lt;/span&gt; &lt;span class="mf"&gt;1.2649901838&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.65924550655&lt;/span&gt; &lt;span class="mf"&gt;1.26477194259&lt;/span&gt; &lt;span class="mf"&gt;1.06843330061&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.567882070203&lt;/span&gt; &lt;span class="mf"&gt;1.15486240395&lt;/span&gt; &lt;span class="mf"&gt;1.0701736452&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.863088210405&lt;/span&gt; &lt;span class="mf"&gt;0.879352892394&lt;/span&gt; &lt;span class="mf"&gt;1.41566301662&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.793631994043&lt;/span&gt; &lt;span class="mf"&gt;0.772252987171&lt;/span&gt; &lt;span class="mf"&gt;1.38942947568&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.1214436584&lt;/span&gt; &lt;span class="mf"&gt;0.328405375216&lt;/span&gt; &lt;span class="mf"&gt;1.20715423281&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.01978683614&lt;/span&gt; &lt;span class="mf"&gt;0.413442016721&lt;/span&gt; &lt;span class="mf"&gt;1.25119926886&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.0790327658&lt;/span&gt; &lt;span class="mf"&gt;1.41247715195&lt;/span&gt; &lt;span class="mf"&gt;0.840384608875&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.19636343635&lt;/span&gt; &lt;span class="mf"&gt;1.47734378702&lt;/span&gt; &lt;span class="mf"&gt;0.889675049927&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.928021527942&lt;/span&gt; &lt;span class="mf"&gt;0.707212114545&lt;/span&gt; &lt;span class="mf"&gt;0.729177300883&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.798175963849&lt;/span&gt; &lt;span class="mf"&gt;0.728686406255&lt;/span&gt; &lt;span class="mf"&gt;0.710141488678&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.727429678773&lt;/span&gt; &lt;span class="mf"&gt;0.844713976238&lt;/span&gt; &lt;span class="mf"&gt;1.57712486884&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.662433148292&lt;/span&gt; &lt;span class="mf"&gt;0.878843634702&lt;/span&gt; &lt;span class="mf"&gt;1.6949460109&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.09760188539&lt;/span&gt; &lt;span class="mf"&gt;0.914122804048&lt;/span&gt; &lt;span class="mf"&gt;1.18704253123&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.22259553871&lt;/span&gt; &lt;span class="mf"&gt;0.945083776191&lt;/span&gt; &lt;span class="mf"&gt;1.17783011204&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.663454963951&lt;/span&gt; &lt;span class="mf"&gt;0.989731239211&lt;/span&gt; &lt;span class="mf"&gt;0.839021511018&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;0.599193209897&lt;/span&gt; &lt;span class="mf"&gt;1.02499153776&lt;/span&gt; &lt;span class="mf"&gt;0.734202010629&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.22917552381&lt;/span&gt; &lt;span class="mf"&gt;0.615682902887&lt;/span&gt; &lt;span class="mf"&gt;1.20064211488&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;1.25094929425&lt;/span&gt; &lt;span class="mf"&gt;0.630362776292&lt;/span&gt; &lt;span class="mf"&gt;1.07951680601&lt;/span&gt;
&lt;span class="n"&gt;BASISSET&lt;/span&gt;
&lt;span class="n"&gt;POB&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;TZVP&lt;/span&gt;
&lt;span class="n"&gt;EXCHPERM&lt;/span&gt;
&lt;span class="n"&gt;DFT&lt;/span&gt;
&lt;span class="n"&gt;LC&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;wBLYP&lt;/span&gt;
&lt;span class="n"&gt;CHUNKS&lt;/span&gt;
&lt;span class="mi"&gt;200&lt;/span&gt;
&lt;span class="kr"&gt;END&lt;/span&gt;
&lt;span class="n"&gt;GUESSP&lt;/span&gt;
&lt;span class="n"&gt;SHRINK&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;FMIXING&lt;/span&gt;
&lt;span class="mi"&gt;30&lt;/span&gt;
&lt;span class="n"&gt;LEVSHIFT&lt;/span&gt;
&lt;span class="mi"&gt;6&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="kr"&gt;END&lt;/span&gt;
&lt;span class="kr"&gt;END&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And I also post the run.sh file for killdevil here.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;&lt;span class="normal"&gt;1&lt;/span&gt;
&lt;span class="normal"&gt;2&lt;/span&gt;
&lt;span class="normal"&gt;3&lt;/span&gt;
&lt;span class="normal"&gt;4&lt;/span&gt;
&lt;span class="normal"&gt;5&lt;/span&gt;
&lt;span class="normal"&gt;6&lt;/span&gt;
&lt;span class="normal"&gt;7&lt;/span&gt;
&lt;span class="normal"&gt;8&lt;/span&gt;
&lt;span class="normal"&gt;9&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash -l&lt;/span&gt;
&lt;span class="c1"&gt;#BSUB -n &amp;quot;60&amp;quot;&lt;/span&gt;
&lt;span class="c1"&gt;#BSUB -e err.%J  &lt;/span&gt;
&lt;span class="c1"&gt;#BSUB -o out.%J&lt;/span&gt;
&lt;span class="c1"&gt;#BSUB -q week&lt;/span&gt;

&lt;span class="nv"&gt;CRYSTAL&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/nas02/home/y/i/yiy/software/crystal/CRYSTAL14_amd64/bin/Linux-ifort_amd64/v1.0.3/Pcrystal
&lt;span class="c1"&gt;#/usr/mpi/intel/mvapich2-1.7/bin/mpiexec -n 10 $CRYSTAL &amp;gt; cubo.out1 &amp;amp;&amp;gt; cubo.out2&lt;/span&gt;
mpirun &lt;span class="nv"&gt;$CRYSTAL&lt;/span&gt; &amp;gt; H2O55.out1 &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&amp;gt; H2O55.out2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;p&gt;A script to transfer xyz file to crystal structure file.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;species_dict&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;O&amp;#39;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;H&amp;#39;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Na&amp;#39;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Cl&amp;#39;&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;#read&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;box&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;size&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;file_box&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;box&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;file_box&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readline&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;cell_a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;float&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;cell_b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;float&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;cell_c&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;float&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;2&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;file_box&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="n"&gt;#read&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;coordinate&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;file_coordinate&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;NaCl_NVT_34000.xyz&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;file_coordinate&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readline&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;natoms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;file_coordinate&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readline&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;natoms&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;file_coordinate&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readline&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;species&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;float&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;float&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;2&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;float&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;3&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;species_dict&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;species&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cell_a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cell_b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cell_c&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;box file is like this.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mf"&gt;12.4934&lt;/span&gt; &lt;span class="mf"&gt;12.4934&lt;/span&gt; &lt;span class="mf"&gt;12.4934&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="misc"></category><category term="dft"></category></entry><entry><title>generate initial structure by packmol</title><link href="https://yaoyi92.github.io/generate-initial-structure-by-packmol.html" rel="alternate"></link><published>2015-01-20T14:25:00+01:00</published><updated>2015-01-20T14:25:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2015-01-20:/generate-initial-structure-by-packmol.html</id><summary type="html">&lt;p&gt;generate initial structure by packmol&lt;/p&gt;</summary><content type="html">&lt;p&gt;The initial structure for md simulation will be generated by packmol then do an equilibrium step by lammps. The system I would like to prepare is 4M NaCl solution. ( 9 Na+ 9 Cl- and 115 H2O with the box size 15.5473 A. ) The template structure of Na+ and Cl- and tip4p H2O structure are prepared first. &lt;/p&gt;
&lt;p&gt;na.xyz&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mf"&gt;2&lt;/span&gt;

&lt;span class="n"&gt;Na&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;NaD&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.02&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;cl.xyz&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mf"&gt;2&lt;/span&gt;

&lt;span class="n"&gt;Cl&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;ClD&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.02&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;tip4p.xyz&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mf"&gt;3&lt;/span&gt;

&lt;span class="n"&gt;O&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;H&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.75695&lt;/span&gt; &lt;span class="mf"&gt;0.58588&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;H&lt;/span&gt; &lt;span class="mf"&gt;0.75695&lt;/span&gt; &lt;span class="mf"&gt;0.58588&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;and also I have the input file for packmol with the name of packmol_NaClH2O.inp&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;#
# &lt;span class="nv"&gt;A&lt;/span&gt; &lt;span class="nv"&gt;mixture&lt;/span&gt; &lt;span class="nv"&gt;of&lt;/span&gt; &lt;span class="nv"&gt;water&lt;/span&gt; &lt;span class="nv"&gt;and&lt;/span&gt; &lt;span class="nv"&gt;NaCl&lt;/span&gt;
#

&lt;span class="nv"&gt;tolerance&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;.&lt;span class="mi"&gt;5&lt;/span&gt;
&lt;span class="nv"&gt;filetype&lt;/span&gt; &lt;span class="nv"&gt;xyz&lt;/span&gt;
&lt;span class="nv"&gt;output&lt;/span&gt; &lt;span class="nv"&gt;NaClH2O&lt;/span&gt;.&lt;span class="nv"&gt;xyz&lt;/span&gt;

&lt;span class="nv"&gt;structure&lt;/span&gt; &lt;span class="nv"&gt;tip4p&lt;/span&gt;.&lt;span class="nv"&gt;xyz&lt;/span&gt;
  &lt;span class="nv"&gt;number&lt;/span&gt; &lt;span class="mi"&gt;115&lt;/span&gt;
  &lt;span class="nv"&gt;inside&lt;/span&gt; &lt;span class="nv"&gt;box&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;15&lt;/span&gt;.&lt;span class="mi"&gt;0473&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;.&lt;span class="mi"&gt;0473&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;.&lt;span class="mi"&gt;0473&lt;/span&gt; # &lt;span class="mi"&gt;15&lt;/span&gt;.&lt;span class="mi"&gt;5473&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nv"&gt;structure&lt;/span&gt;

&lt;span class="nv"&gt;structure&lt;/span&gt; &lt;span class="nv"&gt;na&lt;/span&gt;.&lt;span class="nv"&gt;xyz&lt;/span&gt;
  &lt;span class="nv"&gt;number&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;
  &lt;span class="nv"&gt;inside&lt;/span&gt; &lt;span class="nv"&gt;box&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;15&lt;/span&gt;.&lt;span class="mi"&gt;0473&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;.&lt;span class="mi"&gt;0473&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;.&lt;span class="mi"&gt;0473&lt;/span&gt; # &lt;span class="mi"&gt;15&lt;/span&gt;.&lt;span class="mi"&gt;5473&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nv"&gt;structure&lt;/span&gt;

&lt;span class="nv"&gt;structure&lt;/span&gt; &lt;span class="nv"&gt;cl&lt;/span&gt;.&lt;span class="nv"&gt;xyz&lt;/span&gt;
  &lt;span class="nv"&gt;number&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;
  &lt;span class="nv"&gt;inside&lt;/span&gt; &lt;span class="nv"&gt;box&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;15&lt;/span&gt;.&lt;span class="mi"&gt;0473&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;.&lt;span class="mi"&gt;0473&lt;/span&gt; &lt;span class="mi"&gt;15&lt;/span&gt;.&lt;span class="mi"&gt;0473&lt;/span&gt; # &lt;span class="mi"&gt;15&lt;/span&gt;.&lt;span class="mi"&gt;5473&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nv"&gt;structure&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then run packmol.sh script&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;PACKMOL=&amp;quot;$HOME/software/packmol/packmol/packmol&amp;quot;
INPUT=packmol_NaClH2O.inp

$PACKMOL &amp;lt; $INPUT
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;With the help of vmd program, the data file and psf topo file are generated.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="x"&gt;mol new NaClH2O.xyz waitfor all&lt;/span&gt;

&lt;span class="x"&gt;pbc set &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt; &lt;span class="m"&gt;15.5473&lt;/span&gt; &lt;span class="m"&gt;15.5473&lt;/span&gt; &lt;span class="m"&gt;15.5473&lt;/span&gt; &lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;

&lt;span class="x"&gt;#add bonds and angles&lt;/span&gt;
&lt;span class="x"&gt;topo clearbonds&lt;/span&gt;
&lt;span class="x"&gt;for &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt;&lt;span class="nf"&gt;set&lt;/span&gt; &lt;span class="na"&gt;i&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="m"&gt;115&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt;&lt;span class="nf"&gt;incr&lt;/span&gt; &lt;span class="na"&gt;i&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt;
  &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addbond&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="na"&gt;bondtype&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="na"&gt;bond&lt;/span&gt; &lt;span class="na"&gt;O&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="na"&gt;H&lt;/span&gt;
  &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addbond&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="na"&gt;bondtype&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="na"&gt;bond&lt;/span&gt; &lt;span class="na"&gt;O&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="na"&gt;H&lt;/span&gt;
  &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addangle&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="na"&gt;angle&lt;/span&gt; &lt;span class="na"&gt;H&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="na"&gt;O&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="na"&gt;H&lt;/span&gt;
&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;

&lt;span class="x"&gt;for &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt;&lt;span class="nf"&gt;set&lt;/span&gt; &lt;span class="na"&gt;i&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="m"&gt;18&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt;&lt;span class="nf"&gt;incr&lt;/span&gt; &lt;span class="na"&gt;i&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt;
  &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addbond&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="m"&gt;115&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="m"&gt;115&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="na"&gt;bondtype&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;
&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;



&lt;span class="x"&gt;topo writelammpsdata data.NaClH2O&lt;/span&gt;
&lt;span class="x"&gt;animate write psf NaClH2O.psf&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then I manually modified the molecule ids in data file.&lt;/p&gt;
&lt;p&gt;After that, lammps is used to equilibrium the system.&lt;/p&gt;</content><category term="misc"></category><category term="misc"></category></entry><entry><title>using gaussian do ccsd calculation</title><link href="https://yaoyi92.github.io/using-gaussian-do-ccsd-calculation.html" rel="alternate"></link><published>2015-01-13T16:34:00+01:00</published><updated>2015-01-13T16:34:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2015-01-13:/using-gaussian-do-ccsd-calculation.html</id><summary type="html">&lt;p&gt;gaussian ccsd&lt;/p&gt;</summary><content type="html">&lt;p&gt;a bash script for gaussian ccsd calculation. Cube files are generated from cc density for bader analysis. pseudopotential and basis set are input manually the data are got from EMSL database.&lt;/p&gt;
&lt;p&gt;The files(&lt;a href="https://yaoyi92.github.io/codes/cal.sh"&gt;cal.sh&lt;/a&gt;, &lt;a href="https://yaoyi92.github.io/codes/cubegen.in"&gt;cubegen.in&lt;/a&gt;, &lt;a href="https://yaoyi92.github.io/codes/nacl_com.sh"&gt;nacl_com.sh&lt;/a&gt;,&lt;a href="https://yaoyi92.github.io/codes/nacl_submit.sh"&gt;nacl_submit.sh&lt;/a&gt;)&lt;/p&gt;</content><category term="misc"></category><category term="misc"></category></entry><entry><title>simple awk and sed</title><link href="https://yaoyi92.github.io/simple-awk-and-sed.html" rel="alternate"></link><published>2014-12-24T01:56:00+01:00</published><updated>2014-12-24T01:56:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-12-24:/simple-awk-and-sed.html</id><summary type="html">&lt;p&gt;the simple use of awk and sed&lt;/p&gt;</summary><content type="html">&lt;p&gt;awk and sed are two powerful command line tools for text processing. The only usage I will use are these two. For all the other complicated tasks I would prefer to use python.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;awk &amp;#39;{print $1 &amp;quot; &amp;quot; $2 &amp;quot; &amp;quot; $3}&amp;#39; input &amp;gt; output

sed &amp;#39;s/wrong/right/&amp;#39; input &amp;gt; output

sed &amp;quot;/&amp;amp;word_after_which_to_insert/ r file_insert&amp;quot; template.inp &amp;gt; out.inp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="misc"></category><category term="awk"></category><category term="sed"></category></entry><entry><title>ase</title><link href="https://yaoyi92.github.io/ase.html" rel="alternate"></link><published>2014-12-20T23:26:00+01:00</published><updated>2014-12-20T23:26:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-12-20:/ase.html</id><summary type="html">&lt;p&gt;ase&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="https://wiki.fysik.dtu.dk/ase/index.html"&gt;ase&lt;/a&gt; is a python library for atomic simulation. It can be used with a lot of code from first principle to classical md codes. It would be a good toy and test ground for atomic simulation. I plan to use it to test some algorithm with lj potential built in.&lt;/p&gt;
&lt;p&gt;Here is the process for me to install it on killdevil.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;module&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt; &lt;span class="n"&gt;anaconda&lt;/span&gt;
&lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="n"&gt;activate&lt;/span&gt; &lt;span class="n"&gt;my_root&lt;/span&gt;
&lt;span class="n"&gt;export&lt;/span&gt; &lt;span class="n"&gt;ASE_TAGS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;svn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fysik&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dtu&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dk&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;projects&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ase&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tags&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;
&lt;span class="n"&gt;mkdir&lt;/span&gt; &lt;span class="o"&gt;~/&lt;/span&gt;&lt;span class="n"&gt;software&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ase&lt;/span&gt;
&lt;span class="n"&gt;cd&lt;/span&gt; &lt;span class="o"&gt;~/&lt;/span&gt;&lt;span class="n"&gt;software&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ase&lt;/span&gt;
&lt;span class="n"&gt;svn&lt;/span&gt; &lt;span class="n"&gt;co&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="mi"&gt;3440&lt;/span&gt; &lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;ASE_TAGS&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;3.8.1&lt;/span&gt; &lt;span class="n"&gt;ase&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3.8.1&lt;/span&gt;
&lt;span class="n"&gt;ln&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;~/&lt;/span&gt;&lt;span class="n"&gt;software&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ase&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ase&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;3.8.1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="n"&gt;ase&lt;/span&gt;
&lt;span class="c1"&gt;#export PYTHONPATH=$HOME/ase:$PYTHONPATH&lt;/span&gt;
&lt;span class="c1"&gt;#export PATH=$HOME/ase/tools:$PATH&lt;/span&gt;
&lt;span class="n"&gt;cd&lt;/span&gt; &lt;span class="o"&gt;~/&lt;/span&gt;&lt;span class="n"&gt;ase&lt;/span&gt;
&lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;
&lt;span class="n"&gt;mkdir&lt;/span&gt; &lt;span class="o"&gt;~/&lt;/span&gt;&lt;span class="n"&gt;yiy&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ase&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;test&lt;/span&gt;
&lt;span class="n"&gt;cd&lt;/span&gt; &lt;span class="o"&gt;~/&lt;/span&gt;&lt;span class="n"&gt;yiy&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ase&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;test&lt;/span&gt;
&lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;from ase.test import test; test(verbosity=2, display=False)&amp;quot;&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;amp;&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;tee&lt;/span&gt; &lt;span class="n"&gt;testase&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And I got the result of &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;----------------------------------------------------------------------&lt;/span&gt;&lt;span class="c"&gt;&lt;/span&gt;
&lt;span class="c"&gt;Ran 96 tests in 64&lt;/span&gt;&lt;span class="nt"&gt;.&lt;/span&gt;&lt;span class="c"&gt;938s&lt;/span&gt;

&lt;span class="c"&gt;OK&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now I can play around with it.&lt;/p&gt;</content><category term="python"></category><category term="python"></category></entry><entry><title>doing global optimization with minima hopping algorithm with cp2k</title><link href="https://yaoyi92.github.io/doing-global-optimization-with-minima-hopping-algorithm-with-cp2k.html" rel="alternate"></link><published>2014-12-20T23:26:00+01:00</published><updated>2014-12-20T23:26:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-12-20:/doing-global-optimization-with-minima-hopping-algorithm-with-cp2k.html</id><summary type="html">&lt;p&gt;using cp2k doing MINHOP global optimization method&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="http://scitation.aip.org/content/aip/journal/jcp/120/21/10.1063/1.1724816"&gt;Minima hopping&lt;/a&gt; is an effecient global minimization method. It is implemented in cp2k code. I have tested it on LJ38 clusters and found it performed very well. It is easy to using all the force methods in cp2k, and also easy to using multiple cores and easy to restart.&lt;/p&gt;
&lt;p&gt;I copied and modified the input file in cp2k test examples.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;GLOBAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;PROJECT_NAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LJ38_minhop_1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;PROGRAM_NAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SWARM&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;RUN_TYPE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;NONE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;SEED&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;42&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;GLOBAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;SWARM&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;BEHAVIOR&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GLOBAL_OPT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;NUMBER_OF_WORKERS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;MAX_ITER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;50000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;GLOBAL_OPT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;#E_TARGET&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.028421532&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;#E_TARGET&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.397492331&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;E_TARGET&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.173928427&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="k"&gt;METHOD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MINIMA_HOPPING&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;HISTORY&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="n"&gt;ENERGY_PRECISION&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0e-5&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="n"&gt;FINGERPRINT_PRECISION&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0e-2&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HISTORY&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GLOBAL_OPT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;#REPLAY_COMMUNICATION_LOG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LJ38_minhop_1_old&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;comlog&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SWARM&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;


&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;MOTION&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;!&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;IO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;expensive&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;turning&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;everything&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;off&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;RESTART&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RESTART&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;RESTART_HISTORY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RESTART_HISTORY&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;TRAJECTORY&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="err"&gt;!&lt;/span&gt;&lt;span class="n"&gt;ADD_LAST&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;NUMERIC&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;GEO_OPT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TRAJECTORY&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;ENSEMBLE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NVE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;STEPS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;TIMESTEP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;VELOCITY_SOFTENING&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;STEPS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;ALPHA&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;DELTA&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.01&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VELOCITY_SOFTENING&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;ENERGY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ENERGY&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;CENTER_OF_MASS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CENTER_OF_MASS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;COEFFICIENTS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;COEFFICIENTS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;PROGRAM_RUN_INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PROGRAM_RUN_INFO&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;ROTATIONAL_INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ROTATIONAL_INFO&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;SHELL_ENERGY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SHELL_ENERGY&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;TEMP_KIND&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TEMP_KIND&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;TEMP_SHELL_KIND&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TEMP_SHELL_KIND&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;FORCE_LAST&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;TRUE&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;GEO_OPT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;OPTIMIZER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CG&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;MAX_ITER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;CG&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;MAX_STEEP_STEPS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LINE_SEARCH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;GOLD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;INITIAL_STEP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0e-2&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GOLD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LINE_SEARCH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CG&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;BFGS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;TRUST_RADIUS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;angstrom&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;USE_RAT_FUN_OPT&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;!&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;otherwise&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LJ&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;particle&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sth&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;get&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;too&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;close&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;RESTART&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RESTART&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BFGS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;PROGRAM_RUN_INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PROGRAM_RUN_INFO&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GEO_OPT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MOTION&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;FORCE_EVAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;DISTRIBUTION&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DISTRIBUTION&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;DISTRIBUTION1D&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DISTRIBUTION1D&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;DISTRIBUTION2D&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DISTRIBUTION2D&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;FORCES&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FORCES&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;GRID_INFORMATION&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GRID_INFORMATION&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;PROGRAM_RUN_INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PROGRAM_RUN_INFO&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;STRESS_TENSOR&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;STRESS_TENSOR&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;TOTAL_NUMBERS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TOTAL_NUMBERS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;


&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;METHOD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FIST&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;MM&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;FORCEFIELD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;SPLINE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;R0_NB&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0E-10&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;!&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;solely&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MAX_SPLINE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;control&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;spline&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;range&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;EMAX_SPLINE&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;hartree&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;EMAX_ACCURACY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;hartree&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;!&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;yields&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r_min&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.66&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bohr&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;EPS_SPLINE&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;hartree&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0E-10&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="err"&gt;!&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;yields&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1698&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;spline&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;points&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SPLINE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;NONBONDED&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LENNARD&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;JONES&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;atoms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;EPSILON&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;hartree&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.001&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;SIGMA&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;RCUT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;25.0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LENNARD&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;JONES&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NONBONDED&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;CHARGE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;ATOM&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;CHARGE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CHARGE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FORCEFIELD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;NEIGHBOR_LISTS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;GEO_CHECK&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NEIGHBOR_LISTS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;POISSON&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;EWALD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;EWALD_TYPE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;none&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;EWALD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;POISSON&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;DERIVATIVES&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DERIVATIVES&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;DIPOLE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DIPOLE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;EWALD_INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;EWALD_INFO&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;FF_INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FF_INFO&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;FF_PARAMETER_FILE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FF_PARAMETER_FILE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;ITER_INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ITER_INFO&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;NEIGHBOR_LISTS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NEIGHBOR_LISTS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;PROGRAM_BANNER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PROGRAM_BANNER&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;PROGRAM_RUN_INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PROGRAM_RUN_INFO&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;SUBCELL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SUBCELL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MM&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;SUBSYS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;CELL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;ABC&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;angstrom&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;50.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;50.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;50.0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="err"&gt;!&lt;/span&gt;&lt;span class="n"&gt;PERIODIC&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;NONE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CELL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;COORD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;19.9299001112&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;19.950169551&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;19.8322640143&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;19.9729085751&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;19.9093309127&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;21.9394380813&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;19.8941562054&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;19.8941284049&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;24.0569837799&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;19.9695852658&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;20.05096174&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;26.0067040618&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;19.8674946895&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;21.8602000252&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;20.1915984374&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;19.8880139948&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;21.9536267685&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;22.0485106395&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;20.0129749414&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;21.8625405898&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;23.9870979205&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;20.082926774&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;22.0788992596&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;25.8572713695&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;20.1546207624&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;24.0025491948&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;19.8547537874&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;19.8031230442&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;24.0436048709&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;21.9106314379&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;19.9463916441&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;24.1839491879&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;23.8834113495&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;19.8704727285&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;24.16644628&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;25.8358148517&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;19.9838019218&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;25.9057999191&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;20.0560911995&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;20.1292145367&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;26.1581490664&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;22.0943715423&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;19.9781889658&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;26.083599068&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;24.0336864536&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;19.8883959013&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;25.8200957812&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;26.0366653688&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;21.8201260724&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;20.1242010293&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;19.8205288067&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;21.8505910349&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;19.9947362491&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;21.8404146774&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;21.8550273956&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;19.9254871471&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;24.1073006016&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;21.8959492318&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;19.9013788938&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;25.8664416645&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;22.1302099673&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;21.9272265398&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;19.9252007031&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;21.9102230055&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;22.1149858217&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;21.9240625018&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;22.199987559&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;22.1591700852&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;23.8318003313&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;21.9003367373&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;22.1293676776&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;25.9205476882&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;21.88906222&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;23.8016798271&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;19.8361992897&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;21.8178764403&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;23.959817666&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;22.139335581&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;22.0455507021&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;24.1606968111&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;23.9829670521&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;21.9423108666&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;23.979777561&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;26.0915224226&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;21.8720398156&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;26.0920668527&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;19.9883875322&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;22.1930798224&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;25.9151320315&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;22.018793157&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;21.8088496409&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;26.0005309843&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;23.9521645719&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;22.1819324474&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;26.1518318479&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;25.9325533822&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;23.9252010921&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;20.0182542645&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;19.8463786663&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;24.0939325405&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;20.1666761084&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;22.0954054271&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;23.9434446885&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;20.0072638668&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;24.1136432412&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;24.1239486847&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;20.1448454527&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;25.9584634081&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;23.8406670306&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;22.148328277&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;20.1143768668&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;24.1302214528&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;21.9474940966&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;22.0937869524&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;COORD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;TOPOLOGY&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;CONNECTIVITY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TOPOLOGY&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;KIND&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;X&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;ELEMENT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;H&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;MASS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KIND&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SUBSYS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FORCE_EVAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Here number of processors has to be NUMBER_OF_WORKERS * n + 1, n is any interger number.
So here is the running script for killdevil.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;&lt;span class="normal"&gt;1&lt;/span&gt;
&lt;span class="normal"&gt;2&lt;/span&gt;
&lt;span class="normal"&gt;3&lt;/span&gt;
&lt;span class="normal"&gt;4&lt;/span&gt;
&lt;span class="normal"&gt;5&lt;/span&gt;
&lt;span class="normal"&gt;6&lt;/span&gt;
&lt;span class="normal"&gt;7&lt;/span&gt;
&lt;span class="normal"&gt;8&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash -l&lt;/span&gt;
&lt;span class="c1"&gt;#BSUB -n 12&lt;/span&gt;
&lt;span class="c1"&gt;#BSUB -e err.%J&lt;/span&gt;
&lt;span class="c1"&gt;#BSUB -o out.%J&lt;/span&gt;

module load cp2k

/usr/mpi/intel/mvapich2-1.7/bin/mpiexec -np &lt;span class="m"&gt;12&lt;/span&gt; cp2k.popt -i LJ38_minhop_1.inp -o LJ38_minhop_1.out
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;p&gt;If would like to restart a calculation I need to mv the comlog file, and uncomment REPLAY_COMMUNICATION_LOG command in the input file.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mv LJ38_minhop_1.comlog LJ38_minhop_1_old.comlog
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Here is the scripts for plotting the local minimum and global minimum versus timesteps.&lt;/p&gt;
&lt;p&gt;make_figure.sh&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;&lt;span class="normal"&gt;1&lt;/span&gt;
&lt;span class="normal"&gt;2&lt;/span&gt;
&lt;span class="normal"&gt;3&lt;/span&gt;
&lt;span class="normal"&gt;4&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash -l&lt;/span&gt;
module load gnuplot
bash grep_energys.sh
gnuplot plot.gplt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;p&gt;grep_energys.sh&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;grep &amp;quot; GLBOPT| Reported potential energy&amp;quot; LJ38_minhop_1.out | awk &amp;#39;{print $6 }&amp;#39; &amp;gt; 1
grep &amp;quot;GLBOPT| Lowest reported potential energy&amp;quot; LJ38_minhop_1.out | awk &amp;#39;{print $7 }&amp;#39; &amp;gt; 2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;plot.gplt&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="s s-Atom"&gt;#set&lt;/span&gt; &lt;span class="s s-Atom"&gt;terminal&lt;/span&gt; &lt;span class="s s-Atom"&gt;postscript&lt;/span&gt;
&lt;span class="s s-Atom"&gt;#set&lt;/span&gt; &lt;span class="s s-Atom"&gt;output&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;test.ps&amp;quot;&lt;/span&gt;
&lt;span class="s s-Atom"&gt;set&lt;/span&gt; &lt;span class="s s-Atom"&gt;terminal&lt;/span&gt; &lt;span class="s s-Atom"&gt;png&lt;/span&gt;
&lt;span class="s s-Atom"&gt;set&lt;/span&gt; &lt;span class="s s-Atom"&gt;output&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;test.png&amp;quot;&lt;/span&gt;
&lt;span class="s s-Atom"&gt;set&lt;/span&gt; &lt;span class="s s-Atom"&gt;yrange&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.175&lt;/span&gt;&lt;span class="p"&gt;:-&lt;/span&gt;&lt;span class="mf"&gt;0.160&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="s s-Atom"&gt;set&lt;/span&gt; &lt;span class="s s-Atom"&gt;trange&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="s s-Atom"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;50000&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="s s-Atom"&gt;set&lt;/span&gt; &lt;span class="s s-Atom"&gt;xrange&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="s s-Atom"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="s s-Atom"&gt;set&lt;/span&gt; &lt;span class="s s-Atom"&gt;parametric&lt;/span&gt;
&lt;span class="s s-Atom"&gt;const=-&lt;/span&gt;&lt;span class="mf"&gt;0.173928427&lt;/span&gt;

&lt;span class="s s-Atom"&gt;p&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;1&amp;quot;&lt;/span&gt; &lt;span class="s s-Atom"&gt;u&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;2&amp;quot;&lt;/span&gt; &lt;span class="s s-Atom"&gt;u&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="s s-Atom"&gt;w&lt;/span&gt; &lt;span class="s s-Atom"&gt;l&lt;/span&gt; &lt;span class="s s-Atom"&gt;lw&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s s-Atom"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s s-Atom"&gt;const&lt;/span&gt; &lt;span class="s s-Atom"&gt;w&lt;/span&gt; &lt;span class="s s-Atom"&gt;l&lt;/span&gt; &lt;span class="s s-Atom"&gt;lw&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And I post the output plot here.
&lt;img alt="Alt Text" src="https://yaoyi92.github.io/images/cp2k_lj38_minhop.png"&gt;&lt;/p&gt;
&lt;p&gt;To get the minimal energy structures out, I wrote a script. The script will output the structures with the order from low energy to high energy.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;LJ38_minhop_1.comlog&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="k"&gt;read&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;False&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;Epot_positions&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;[]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;Epot_position&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;[]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;True&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readline&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;Epot&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;line&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;read&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;True&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readline&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readline&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Epot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;float&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Epot_position&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Epot&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;size&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;and&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;read&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;True&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;read&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;False&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;natoms&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;words&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;positions&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;[]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;natoms&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readline&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;float&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.889725989&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readline&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;float&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.889725989&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readline&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;float&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.889725989&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;position&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;x,y,z&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;positions&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;position&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Epot_position&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;positions&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Epot_positions&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Epot_position&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Epot_position&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;[]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;#print&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;natoms&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;#print&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;Epot: &amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Epot&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;#for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;natoms&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;X&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;positions&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;][&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;positions&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;][&lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;positions&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;][&lt;/span&gt;&lt;span class="n"&gt;2&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="n"&gt;Epot_positions_sorted&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sorted&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Epot_positions&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;key&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lambda&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;Epot_position&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Epot_position&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="n"&gt;Epot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Epot_positions_sorted&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="o"&gt;][&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Epot_positions_sorted&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Epot_positions_sorted&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;][&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Epot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1e-5&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Epot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Epot_positions_sorted&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;][&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;natoms&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;Epot: &amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Epot_positions_sorted&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;][&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;natoms&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;positions&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Epot_positions_sorted&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="o"&gt;][&lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;X&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;positions&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;][&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;positions&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;][&lt;/span&gt;&lt;span class="n"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;positions&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;][&lt;/span&gt;&lt;span class="n"&gt;2&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The two lowest energy structure are here with the energy of -0.173928415115, and -0.173252366954.
Here are the structures of them.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt Text" src="https://yaoyi92.github.io/images/cp2k_lj38_minhop_min2.png"&gt;
&lt;img alt="Alt Text" src="https://yaoyi92.github.io/images/cp2k_lj38_minhop_min1.png"&gt;&lt;/p&gt;</content><category term="molecular dynamics"></category><category term="molecular dynamics"></category></entry><entry><title>using horton do esp charge analysis</title><link href="https://yaoyi92.github.io/using-horton-do-esp-charge-analysis.html" rel="alternate"></link><published>2014-12-15T13:50:00+01:00</published><updated>2014-12-15T13:50:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-12-15:/using-horton-do-esp-charge-analysis.html</id><summary type="html">&lt;p&gt;horton esp&lt;/p&gt;</summary><content type="html">&lt;p&gt;In order to do esp charge analysis, I generate charge density cube file and electric potential cube file from cp2k (with GPW method, GAPW method has a problem generate charge density cube file). I post here the steps I use horton and these cube files to do esp charge analysis (follow this &lt;a href="http://theochem.github.io/horton/tut_espfit.html"&gt;link&lt;/a&gt; ).&lt;/p&gt;
&lt;p&gt;Here is how I use it on killdevil.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;module&lt;/span&gt; &lt;span class="nb"&gt;load&lt;/span&gt; &lt;span class="n"&gt;anaconda&lt;/span&gt;
&lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="n"&gt;activate&lt;/span&gt; &lt;span class="n"&gt;my_root&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Here is the input file for cp2k.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;@SET&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RTYPE&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="nv"&gt;@SET&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RESTART&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;ON&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="nv"&gt;@SET&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RESTARTFILE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;H2O64NaCl&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;_500&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;restart&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="nv"&gt;@SET&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MD_ENS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NVT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;FORCE_EVAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;METHOD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;QS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;PROPERTIES&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;RESP&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;STRIDE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RESP&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;FIT_CHARGE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;FILENAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;NaCl_NVT_fit_charge&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FIT_CHARGE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PROPERTIES&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;DFT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;DENSITY_FITTING&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DENSITY_FITTING&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;BASIS_SET_FILE_NAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cp2k&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;BASIS_MOLOPT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;POTENTIAL_FILE_NAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cp2k&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;GTH_POTENTIALS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;MGRID&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;NGRIDS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;CUTOFF&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;280&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;REL_CUTOFF&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MGRID&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;SCF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="nv"&gt;@IF&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;${&lt;/span&gt;&lt;span class="n"&gt;RESTART&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;OFF&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;SCF_GUESS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;ATOMIC&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="nv"&gt;@ENDIF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="nv"&gt;@IF&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;${&lt;/span&gt;&lt;span class="n"&gt;RESTART&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;ON&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;SCF_GUESS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RESTART&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="nv"&gt;@ENDIF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;OT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;ON&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;MINIMIZER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DIIS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;ENERGY_GAP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.001&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;PRECONDITIONER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FULL_ALL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;OT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;EPS_SCF&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mf"&gt;1.0E-6&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;RESTART&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SCF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;QS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;EXTRAPOLATION&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;EXTRAPOLATION_ORDER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="k"&gt;METHOD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GPW&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;QS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;XC&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;XC_FUNCTIONAL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BLYP&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;XC_FUNCTIONAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;XC_GRID&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;XC_SMOOTH_RHO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NN50&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;XC_DERIV&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NN50_SMOOTH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;vdW_POTENTIAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;POTENTIAL_TYPE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PAIR_POTENTIAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;PAIR_POTENTIAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;TYPE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DFTD3&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;PARAMETER_FILE_NAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cp2k&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dftd3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dat&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;REFERENCE_FUNCTIONAL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;revPBE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PAIR_POTENTIAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;vdW_POTENTIAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;XC&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;E_DENSITY_CUBE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;STRIDE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E_DENSITY_CUBE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;V_HARTREE_CUBE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;STRIDE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;V_HARTREE_CUBE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;MULLIKEN&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;FILENAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;NaCl_NVT_mulliken&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MULLIKEN&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LOWDIN&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;FILENAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;NaCl_NVT_lowdin&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LOWDIN&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;HIRSCHFELD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;#FILENAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;NaCl_NVT_hirschfeld&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HIRSCHFELD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LOCALIZE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;METHOD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;JACOBI&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;#MAX_CRAZY_ANGLE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;MAX_ITER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;#EPS_LOCALIZATION&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1E-8&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;#MAX_CRAZY_ANGLE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.05&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;WANNIER_CENTERS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;FILENAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;NaCl_NVT_wannier_centers&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xyz&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;IONS&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;CENTERS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;WANNIER_CENTERS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;WANNIER_SPREADS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;FILENAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;NaCl_NVT_wannier_spread&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;data&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;WANNIER_SPREADS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;USE_HISTORY&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LOCALIZE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DFT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;SUBSYS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;CELL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;ABC&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;12.4934&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;12.4934&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;12.4934&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CELL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;TOPOLOGY&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;COORD_FILE_NAME&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;H2O64NaCl&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xyz&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;COORD_FILE_FORMAT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;xyz&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TOPOLOGY&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;COLVAR&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;DISTANCE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="n"&gt;ATOMS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;193&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;194&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DISTANCE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;COLVAR&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;KIND&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;H&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;BASIS_SET&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DZVP&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;MOLOPT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SR&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GTH&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;q1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;POTENTIAL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GTH&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;BLYP&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;q1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KIND&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;KIND&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;O&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;BASIS_SET&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DZVP&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;MOLOPT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SR&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GTH&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;q6&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;POTENTIAL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GTH&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;BLYP&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;q6&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KIND&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;KIND&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Na&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;BASIS_SET&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DZVP&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;MOLOPT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SR&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GTH&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;q9&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;POTENTIAL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GTH&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;BLYP&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;q9&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KIND&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;KIND&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Cl&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;BASIS_SET&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DZVP&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;MOLOPT&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;SR&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;GTH&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;q7&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;POTENTIAL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GTH&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;BLYP&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;q7&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KIND&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SUBSYS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FORCE_EVAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;GLOBAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;PROJECT_NAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;H2O64NaCl&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;RUN_TYPE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;PRINT_LEVEL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LOW&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;TIMINGS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;THRESHOLD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.000001&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;#WALLTIME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;172500&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;#WALLTIME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;345000&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;WALLTIME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1750&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;GLOBAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;MOTION&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;CONSTRAINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;COLLECTIVE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;COLVAR&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;INTERMOLECULAR&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;TARGET&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;angstrom&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.2&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;COLLECTIVE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;LAGRANGE_MULTIPLIERS&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;COMMON_ITERATION_LEVELS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;CONSTRAINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nv"&gt;@IF&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;${&lt;/span&gt;&lt;span class="n"&gt;MD_ENS&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NVE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;ENSEMBLE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NVE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nv"&gt;@ENDIF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nv"&gt;@IF&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;${&lt;/span&gt;&lt;span class="n"&gt;MD_ENS&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NVT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;ENSEMBLE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NVT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;THERMOSTAT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;REGION&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;GLOBAL&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;TYPE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NOSE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;NOSE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NOSE&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;THERMOSTAT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nv"&gt;@ENDIF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;STEPS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;TIMESTEP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;TEMPERATURE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;298.0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;TRAJECTORY&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;SILENT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;FILENAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;NaCl_NVT&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xyz&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TRAJECTORY&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;RESTART&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;ADD_LAST&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;NUMERIC&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RESTART&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;VELOCITIES&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;FILENAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;NaCl_NVT_vel&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xyz&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VELOCITIES&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;FORCES&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;EACH&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;FILENAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;NaCl_NVT_frc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xyz&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;FORCES&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;PRINT&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MOTION&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;EXT_RESTART&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;ON&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;RESTART_DEFAULT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;RESTART_FILE_NAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;${&lt;/span&gt;&lt;span class="n"&gt;RESTARTFILE&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;RESTART_POS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;RESTART_COUNTERS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nv"&gt;@IF&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;${&lt;/span&gt;&lt;span class="n"&gt;RTYPE&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;RESTART_VEL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nv"&gt;@ENDIF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nv"&gt;@IF&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;${&lt;/span&gt;&lt;span class="n"&gt;MD_ENS&lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NVT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;RESTART_THERMOSTAT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nv"&gt;@ENDIF&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;EXT_RESTART&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The cube files I have are H2O64NaCl-ELECTRON_DENSITY-1_0.cube and H2O64NaCl-v_hartree-1_0.cube. &lt;/p&gt;
&lt;p&gt;This command is used to generate the cost function.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;horton-esp-cost.py H2O64NaCl-v_hartree-1_0.cube cost.h5 --wdens=H2O64NaCl-ELECTRON_DENSITY-1_0.cube -s --wnear 8:2.0:2.0 1:2.0:2.0 11:2.0:2.0 17:2.0:2.0 --pbc=111 &amp;gt; esp-cost-out
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;It took me 6 hours to generate the cost function. After that, charges are fitted to the esp by this command.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;horton-esp-fit.py cost.h5 charges.h5
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Transfer it to csv file to read.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;horton-hdf2csv.py charges.h5 charges.csv
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="python"></category><category term="python"></category></entry><entry><title>using horton do hirshfeld charge analysis</title><link href="https://yaoyi92.github.io/using-horton-do-hirshfeld-charge-analysis.html" rel="alternate"></link><published>2014-12-09T23:34:00+01:00</published><updated>2014-12-09T23:34:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-12-09:/using-horton-do-hirshfeld-charge-analysis.html</id><summary type="html">&lt;p&gt;horton hirshfeld&lt;/p&gt;</summary><content type="html">&lt;p&gt;In order to do hirshfeld charge analysis, I generate charge density cube file from cp2k (with GPW method, GAPW method has a problem generate charge density cube file). I post here the steps I use horton and this cube file to do hirshfeld charge analysis (follow this &lt;a href="http://theochem.github.io/horton/tut_part.html#id32"&gt;link&lt;/a&gt; ).&lt;/p&gt;
&lt;p&gt;Here is how I use it on killdevil.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;module&lt;/span&gt; &lt;span class="nb"&gt;load&lt;/span&gt; &lt;span class="n"&gt;anaconda&lt;/span&gt;
&lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="n"&gt;activate&lt;/span&gt; &lt;span class="n"&gt;my_root&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;First, I need to set up a database for proatoms. I am using cp2k for atom calculation. I need H, O, Na, Cl in my system. So I generate the input files like this.&lt;/p&gt;
&lt;p&gt;ppot.inc ( XXX_000_00 XXX stands for element number, GTH-PBE-qX which is the name of the pseudopotential)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mf"&gt;001&lt;/span&gt;&lt;span class="n"&gt;_000_00&lt;/span&gt; &lt;span class="n"&gt;GTH&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;PBE&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;q0&lt;/span&gt;
&lt;span class="mf"&gt;008&lt;/span&gt;&lt;span class="n"&gt;_000_00&lt;/span&gt; &lt;span class="n"&gt;GTH&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;PBE&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;q6&lt;/span&gt;
&lt;span class="mf"&gt;011&lt;/span&gt;&lt;span class="n"&gt;_000_00&lt;/span&gt; &lt;span class="n"&gt;GTH&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;PBE&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;q9&lt;/span&gt;
&lt;span class="mf"&gt;017&lt;/span&gt;&lt;span class="n"&gt;_000_00&lt;/span&gt; &lt;span class="n"&gt;GTH&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;PBE&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;q7&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;valence.inc ( NNN_PPP_MM NNN: element number. PPP: atomic population(#electon). MM: spin multiplicity(2S+1) 1s2 2p1: orbital occupations)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mf"&gt;001&lt;/span&gt;&lt;span class="n"&gt;_001_02&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s1&lt;/span&gt;
&lt;span class="mf"&gt;001&lt;/span&gt;&lt;span class="n"&gt;_002_01&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt;

&lt;span class="mf"&gt;008&lt;/span&gt;&lt;span class="n"&gt;_005_02&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p1&lt;/span&gt;
&lt;span class="mf"&gt;008&lt;/span&gt;&lt;span class="n"&gt;_006_03&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p2&lt;/span&gt;
&lt;span class="mf"&gt;008&lt;/span&gt;&lt;span class="n"&gt;_007_04&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p3&lt;/span&gt;
&lt;span class="mf"&gt;008&lt;/span&gt;&lt;span class="n"&gt;_008_03&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p4&lt;/span&gt;
&lt;span class="mf"&gt;008&lt;/span&gt;&lt;span class="n"&gt;_009_02&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p5&lt;/span&gt;
&lt;span class="mf"&gt;008&lt;/span&gt;&lt;span class="n"&gt;_010_01&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p6&lt;/span&gt;

&lt;span class="mf"&gt;011&lt;/span&gt;&lt;span class="n"&gt;_005_02&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p1&lt;/span&gt;
&lt;span class="mf"&gt;011&lt;/span&gt;&lt;span class="n"&gt;_006_03&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p2&lt;/span&gt;
&lt;span class="mf"&gt;011&lt;/span&gt;&lt;span class="n"&gt;_007_04&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p3&lt;/span&gt;
&lt;span class="mf"&gt;011&lt;/span&gt;&lt;span class="n"&gt;_008_03&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p4&lt;/span&gt;
&lt;span class="mf"&gt;011&lt;/span&gt;&lt;span class="n"&gt;_009_02&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p5&lt;/span&gt;
&lt;span class="mf"&gt;011&lt;/span&gt;&lt;span class="n"&gt;_010_01&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p6&lt;/span&gt;
&lt;span class="mf"&gt;011&lt;/span&gt;&lt;span class="n"&gt;_011_02&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p6&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;s1&lt;/span&gt;
&lt;span class="mf"&gt;011&lt;/span&gt;&lt;span class="n"&gt;_012_01&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p6&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt;
&lt;span class="mf"&gt;011&lt;/span&gt;&lt;span class="n"&gt;_013_02&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p6&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;3&lt;/span&gt;&lt;span class="n"&gt;p1&lt;/span&gt;

&lt;span class="mf"&gt;017&lt;/span&gt;&lt;span class="n"&gt;_013_02&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p1&lt;/span&gt;
&lt;span class="mf"&gt;017&lt;/span&gt;&lt;span class="n"&gt;_014_03&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p2&lt;/span&gt;
&lt;span class="mf"&gt;017&lt;/span&gt;&lt;span class="n"&gt;_015_04&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p3&lt;/span&gt;
&lt;span class="mf"&gt;017&lt;/span&gt;&lt;span class="n"&gt;_016_03&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p4&lt;/span&gt;
&lt;span class="mf"&gt;017&lt;/span&gt;&lt;span class="n"&gt;_017_02&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p5&lt;/span&gt;
&lt;span class="mf"&gt;017&lt;/span&gt;&lt;span class="n"&gt;_018_01&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="n"&gt;p6&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;template.inp&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;&amp;amp;&lt;/span&gt;GLOBAL
  PROJECT ATOM
  PROGRAM_NAME ATOM
&lt;span class="err"&gt;&amp;amp;&lt;/span&gt;END GLOBAL
&lt;span class="err"&gt;&amp;amp;&lt;/span&gt;ATOM
  ATOMIC_NUMBER &lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;
  ELECTRON_CONFIGURATION (&lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;mult&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;) CORE &lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;valence&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;inc&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;
  CORE none

  MAX_ANGULAR_MOMENTUM 1
  &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;METHOD
     METHOD_TYPE UKS
     &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;XC
       &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;XC_FUNCTIONAL PBE
         &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;PBE
           PARAMETRIZATION REVPBE
         &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;END PBE
       &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;END XC_FUNCTIONAL
     &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;END XC
  &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;END METHOD
  &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;POTENTIAL
      PSEUDO_TYPE GTH
      POTENTIAL_FILE_NAME ../../PBE_PSEUDOPOTENTIALS
      POTENTIAL_NAME &lt;span class="cp"&gt;${&lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;ppot&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;inc&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;
  &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;END POTENTIAL
  &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;PP_BASIS
      BASIS_SET_FILE_NAME ../../BASIS_MOLOPT
      BASIS_TYPE CONTRACTED_GTO
      BASIS_SET DZVP-MOLOPT-SR-GTH
  &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;END PP_BASIS
  &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;PRINT
    &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;BASIS_SET ON
    &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;END
    &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;ORBITALS ON
    &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;END
    &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;POTENTIAL ON
    &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;END
  &lt;span class="err"&gt;&amp;amp;&lt;/span&gt;END
&lt;span class="err"&gt;&amp;amp;&lt;/span&gt;END ATOM
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;After preparing these files. I do&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;horton-atomdb.py input cp2k 1,8,11,17 template.inp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This will generate several folders and a run_cp2k.sh file. In order to run it on hopper (which supercomputer I use for cp2k) I add several lines in the head of this file.&lt;/p&gt;
&lt;table class="highlighttable"&gt;&lt;tr&gt;&lt;td class="linenos"&gt;&lt;div class="linenodiv"&gt;&lt;pre&gt;&lt;span class="normal"&gt; 1&lt;/span&gt;
&lt;span class="normal"&gt; 2&lt;/span&gt;
&lt;span class="normal"&gt; 3&lt;/span&gt;
&lt;span class="normal"&gt; 4&lt;/span&gt;
&lt;span class="normal"&gt; 5&lt;/span&gt;
&lt;span class="normal"&gt; 6&lt;/span&gt;
&lt;span class="normal"&gt; 7&lt;/span&gt;
&lt;span class="normal"&gt; 8&lt;/span&gt;
&lt;span class="normal"&gt; 9&lt;/span&gt;
&lt;span class="normal"&gt;10&lt;/span&gt;
&lt;span class="normal"&gt;11&lt;/span&gt;
&lt;span class="normal"&gt;12&lt;/span&gt;
&lt;span class="normal"&gt;13&lt;/span&gt;
&lt;span class="normal"&gt;14&lt;/span&gt;
&lt;span class="normal"&gt;15&lt;/span&gt;
&lt;span class="normal"&gt;16&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c1"&gt;#PBS -N myjob &lt;/span&gt;
&lt;span class="c1"&gt;###PBS -q regular&lt;/span&gt;
&lt;span class="c1"&gt;#PBS -q debug&lt;/span&gt;
&lt;span class="c1"&gt;#PBS -l mppwidth=24&lt;/span&gt;
&lt;span class="c1"&gt;###PBS -l walltime=96:00:00&lt;/span&gt;
&lt;span class="c1"&gt;#PBS -l walltime=00:30:00&lt;/span&gt;
&lt;span class="c1"&gt;#PBS -j oe&lt;/span&gt;
&lt;span class="c1"&gt;#PBS -V&lt;/span&gt;

&lt;span class="c1"&gt;# Note: if you want to use an mpi-parallel CP2K binary, uncomment the following&lt;/span&gt;
&lt;span class="c1"&gt;# line and fill in the right binary and mpirun script:&lt;/span&gt;
&lt;span class="nb"&gt;cd&lt;/span&gt; &lt;span class="nv"&gt;$PBS_O_WORKDIR&lt;/span&gt;
module load cp2k/2.5.1
&lt;span class="c1"&gt;#CP2K_BIN=&amp;quot;mpirun -n4 cp2k.popt&amp;quot;&lt;/span&gt;
&lt;span class="nv"&gt;CP2K_BIN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;aprun -n 24 cp2k.popt&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;p&gt;Then I do&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;qsub run_cp2k.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;After the calculations are done, I copy the folder back to killdevil and using horton again. This will generate a atom.h5 file for hirshfeld calculation.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;horton-atomdb.py convert
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now, I copy atom.h5 file and the cube file from cp2k calculation to another folder. I also modify the cube file based on the 3.4.1 in the &lt;a href="http://theochem.github.io/horton/tut_part.html#id32"&gt;manual&lt;/a&gt;. The command I use for the real calculation is &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;horton-cpart.py cube output.h5:group {h,hi,he} atoms.h5
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;h, hi, he stands for different partitioning schemes.&lt;/p&gt;
&lt;p&gt;To make the result readable, there is a tool to convert h5 file to csv file.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;horton-hdf2csv.py output.h5 output.csv
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The information I got based on hirshfeld analysis are in the file of output.csv.&lt;/p&gt;</content><category term="python"></category><category term="python"></category></entry><entry><title>horton</title><link href="https://yaoyi92.github.io/horton.html" rel="alternate"></link><published>2014-12-09T00:09:00+01:00</published><updated>2014-12-09T00:09:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-12-09:/horton.html</id><summary type="html">&lt;p&gt;horton&lt;/p&gt;</summary><content type="html">&lt;p&gt;horton is a development platform for electronic structure methods. It can do electronic density partition with different methods. I am trying to install it on killdevil, now.&lt;/p&gt;
&lt;p&gt;Here is how I use it on killdevil.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;module&lt;/span&gt; &lt;span class="nb"&gt;load&lt;/span&gt; &lt;span class="n"&gt;anaconda&lt;/span&gt;
&lt;span class="n"&gt;module&lt;/span&gt; &lt;span class="nb"&gt;load&lt;/span&gt; &lt;span class="n"&gt;gcc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;4.8&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="n"&gt;activate&lt;/span&gt; &lt;span class="n"&gt;my_root&lt;/span&gt;
&lt;span class="n"&gt;cd&lt;/span&gt; &lt;span class="o"&gt;~/&lt;/span&gt;&lt;span class="n"&gt;software&lt;/span&gt;
&lt;span class="n"&gt;mkdir&lt;/span&gt; &lt;span class="n"&gt;horton&lt;/span&gt;
&lt;span class="n"&gt;cd&lt;/span&gt; &lt;span class="n"&gt;horton&lt;/span&gt;
&lt;span class="n"&gt;wget&lt;/span&gt; &lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;github&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;theochem&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;horton&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;releases&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;download&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;1.2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;horton&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;1.&lt;/span&gt;&lt;span class="n"&gt;tar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gz&lt;/span&gt;
&lt;span class="n"&gt;tar&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;xzvf&lt;/span&gt; &lt;span class="n"&gt;horton&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;1.&lt;/span&gt;&lt;span class="n"&gt;tar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gz&lt;/span&gt;
&lt;span class="n"&gt;cd&lt;/span&gt; &lt;span class="n"&gt;horton&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I think anaconda has all packages needed for horton.&lt;/p&gt;
&lt;p&gt;Then I do.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cd depends
make libint
make libxc
cd ..
./setup.py install --user
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;After I do the tests,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cd ~
nosetests -v horton
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I got,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;----------------------------------------------------------------------&lt;/span&gt;&lt;span class="c"&gt;&lt;/span&gt;
&lt;span class="c"&gt;Ran 755 tests in 386&lt;/span&gt;&lt;span class="nt"&gt;.&lt;/span&gt;&lt;span class="c"&gt;921s&lt;/span&gt;

&lt;span class="c"&gt;OK&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This means I have succesfully install horton.&lt;/p&gt;</content><category term="python"></category><category term="python"></category></entry><entry><title>lis write matrix</title><link href="https://yaoyi92.github.io/lis-write-matrix.html" rel="alternate"></link><published>2014-12-04T14:56:00+01:00</published><updated>2014-12-04T14:56:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-12-04:/lis-write-matrix.html</id><summary type="html">&lt;p&gt;using lis to write a matrix instead of read from file&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="http://www.ssisc.org/lis/"&gt;lis&lt;/a&gt; is a parallel iterative solvers library for linear systems. Instead of read matrix from files, write matrix information directly in the code is useful. I tested it and gave an example here. The matrix is stored in csr form and distributed in all the cpus.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;quot;lis_config.h&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;
&lt;span class="cp"&gt;#include&lt;/span&gt; &lt;span class="cpf"&gt;&amp;quot;lis.h&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;&lt;/span&gt;

&lt;span class="n"&gt;LIS_INT&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INT&lt;/span&gt; &lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kt"&gt;char&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[])&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;LIS_MATRIX&lt;/span&gt;  &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;LIS_VECTOR&lt;/span&gt;  &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;LIS_SOLVER&lt;/span&gt;  &lt;span class="n"&gt;solver&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;LIS_INT&lt;/span&gt;     &lt;span class="n"&gt;iter&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="kt"&gt;double&lt;/span&gt;      &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="n"&gt;LIS_INT&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;nnz&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;my_rank&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;LIS_INT&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;LIS_SCALAR&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

  &lt;span class="n"&gt;lis_initialize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

  &lt;span class="n"&gt;lis_matrix_create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_COMM_WORLD&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;lis_vector_create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_COMM_WORLD&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;lis_vector_create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_COMM_WORLD&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;gn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="n"&gt;lis_matrix_set_size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;gn&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;lis_matrix_get_size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;gn&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;lis_matrix_get_range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;-1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;4.11418428571&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;-1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;25.6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;-0.000345454479536&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;-1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.000345454479536&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;-0.000345454479536&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;-1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;-1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;-1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;0.000345454479536&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;4.11418428571&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;-1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;-1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;-1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;-1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;-1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_matrix_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;-1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;lis_matrix_assemble&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;



  &lt;span class="n"&gt;lis_vector_duplicate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;lis_vector_set_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;lis_vector_get_range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;ie&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;lis_vector_set_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LIS_INS_VALUE&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;5.04&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;lis_output_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;LIS_FMT_MM&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;

  &lt;span class="n"&gt;lis_vector_duplicate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

  &lt;span class="n"&gt;lis_solver_create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;solver&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;lis_solver_set_optionC&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;solver&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;lis_solve&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;solver&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;lis_solver_get_iter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;solver&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;iter&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;lis_solver_get_time&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;solver&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;number of iterations = %d&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;iter&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;elapsed time = %e&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

  &lt;span class="n"&gt;lis_output_vector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;LIS_FMT_MM&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;

  &lt;span class="n"&gt;lis_solver_destroy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;solver&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;lis_matrix_destroy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;lis_vector_destroy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
  &lt;span class="n"&gt;lis_vector_destroy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

  &lt;span class="n"&gt;lis_finalize&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And here is the Makefile.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nf"&gt;CC&lt;/span&gt;&lt;span class="err"&gt;=&lt;/span&gt;&lt;span class="no"&gt;mpicc&lt;/span&gt;
&lt;span class="c1"&gt;#CFLAGS=-c -Wall&lt;/span&gt;
&lt;span class="c1"&gt;#LDFLAGS=&lt;/span&gt;
&lt;span class="c1"&gt;#CFLAGS=-c -Wall -I/nas02/home/y/i/yiy/software/lis/lis-1.4.61-build/include&lt;/span&gt;
&lt;span class="nf"&gt;CFLAGS&lt;/span&gt;&lt;span class="err"&gt;=&lt;/span&gt;&lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="no"&gt;DHAVE_CONFIG_H&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="no"&gt;I.&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="no"&gt;I&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;nas02&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;home&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;y&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;i&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;yiy&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;software&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;lis&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;lis-1.4.61&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;include&lt;/span&gt;  &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="no"&gt;I&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;nas02&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;home&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;y&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;i&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;yiy&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;software&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;lis&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;lis-1.4.61&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;   &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="no"&gt;O3&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="no"&gt;ansi_alias&lt;/span&gt;  &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="no"&gt;DUSE_MPI&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="no"&gt;c&lt;/span&gt;
&lt;span class="c1"&gt;#LDFLAGS=-L/nas02/home/y/i/yiy/software/lis/lis-1.4.61-build/lib -llis&lt;/span&gt;
&lt;span class="nf"&gt;LDFLAGS&lt;/span&gt;&lt;span class="err"&gt;=&lt;/span&gt;&lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="no"&gt;L&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;nas02&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;home&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;y&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;i&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;yiy&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;software&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;lis&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;lis-1.4.61&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;src&lt;/span&gt; &lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;nas02&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;home&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;y&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;i&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;yiy&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;software&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;lis&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;lis-1.4.61&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;src&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;.libs&lt;/span&gt;&lt;span class="err"&gt;/&lt;/span&gt;&lt;span class="no"&gt;liblis.a&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="no"&gt;lm&lt;/span&gt;
&lt;span class="nf"&gt;SOURCES&lt;/span&gt;&lt;span class="err"&gt;=&lt;/span&gt;&lt;span class="no"&gt;test_wiki.c&lt;/span&gt;
&lt;span class="nf"&gt;OBJECTS&lt;/span&gt;&lt;span class="err"&gt;=&lt;/span&gt;&lt;span class="no"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;SOURCES&lt;/span&gt;&lt;span class="p"&gt;:.&lt;/span&gt;&lt;span class="no"&gt;c&lt;/span&gt;&lt;span class="err"&gt;=&lt;/span&gt;&lt;span class="no"&gt;.o&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nf"&gt;EXECUTABLE&lt;/span&gt;&lt;span class="err"&gt;=&lt;/span&gt;&lt;span class="no"&gt;test&lt;/span&gt;

&lt;span class="nl"&gt;all:&lt;/span&gt; &lt;span class="nf"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;SOURCES&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="no"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;EXECUTABLE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nf"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;EXECUTABLE&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt; &lt;span class="no"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;OBJECTS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nf"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;CC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="no"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;OBJECTS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="no"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;LDFLAGS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="no"&gt;o&lt;/span&gt; &lt;span class="no"&gt;$@&lt;/span&gt;

&lt;span class="nl"&gt;.c.o:&lt;/span&gt;
    &lt;span class="nf"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;CC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="no"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;CFLAGS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="no"&gt;$&lt;/span&gt;&lt;span class="err"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="no"&gt;o&lt;/span&gt; &lt;span class="no"&gt;$@&lt;/span&gt;

&lt;span class="nl"&gt;clean:&lt;/span&gt;
    &lt;span class="nf"&gt;rm&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="no"&gt;rf&lt;/span&gt; &lt;span class="p"&gt;*&lt;/span&gt;&lt;span class="no"&gt;o&lt;/span&gt; &lt;span class="no"&gt;test&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I can run the exe in serial and parallel.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;./test b x
mpiexec -n 2 ./test b x
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;However when the number of cpus is larger than the number of rows in A matrix the program will stuck. I am contacting lis developers to see if there is something wrong with the code.&lt;/p&gt;</content><category term="misc"></category><category term="parallel computing"></category></entry><entry><title>combine arrays on different cores</title><link href="https://yaoyi92.github.io/combine-arrays-on-different-cores.html" rel="alternate"></link><published>2014-12-04T13:40:00+01:00</published><updated>2014-12-04T13:40:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-12-04:/combine-arrays-on-different-cores.html</id><summary type="html">&lt;p&gt;using MPI_Allgatherv to combine arrays on different cores&lt;/p&gt;</summary><content type="html">&lt;p&gt;The way to combine arrays in different cores to a big array by MPI is using MPI_Allgatherv. An example I would like to test is like this.&lt;/p&gt;
&lt;p&gt;Core 1 : 1&lt;/p&gt;
&lt;p&gt;Core 2 : 2 2&lt;/p&gt;
&lt;p&gt;Core 3 : 3 3 3&lt;/p&gt;
&lt;p&gt;Core 4 : 4 4 4 4&lt;/p&gt;
&lt;p&gt;Core 5 ...&lt;/p&gt;
&lt;p&gt;After combine all the arrays, I will get&lt;/p&gt;
&lt;p&gt;1 2 2 3 3 3 4 4 4 4 5 5 ...&lt;/p&gt;
&lt;p&gt;Here is the code(test_allgatherv.c) and Makefile for this calculation. Pay attention to displ_list.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;#include&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;mpi.h&amp;quot;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;#include&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;stdio&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;#include&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;stdlib&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;char&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="err"&gt;[]&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;my_rank&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MPI&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;rank&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;size&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MPI&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;size&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;local_array&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;array&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;local&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;core&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_num&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;num&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;of&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;elements&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;local&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;array&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;local_num_list&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;list&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;of&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_num&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;displ_list&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;displ_list&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;of&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;global_array&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;global_array&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;array&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;global&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;global_num&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;sum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;of&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_num&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MPI&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;related&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;variables&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;MPI_Init&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;argc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;MPI_Comm_rank&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MPI_COMM_WORLD&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;my_rank&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;MPI_Comm_size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MPI_COMM_WORLD&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;size&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;generate&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;local&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;array&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;local_num&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;my_rank&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;local_array&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;malloc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;local_num&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;local_num&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;local_array&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_num&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;%d \n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_num&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;calculate&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;global_num&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;sum&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;local_num&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;MPI_Allreduce&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;local_num&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;global_num&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MPI_INT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MPI_SUM&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MPI_COMM_WORLD&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MPI_Allgatherv&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;calculation&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;of&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;displ_list&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;little&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tricky&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;global_array&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;malloc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;global_num&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;displ_list&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;malloc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;size&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;local_num_list&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;malloc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;size&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nc"&gt;int&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;MPI_Allgather&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;local_num&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MPI_INT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_num_list&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MPI_INT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MPI_COMM_WORLD&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;displ_list&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;0&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;size&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;displ_list&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;displ_list&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i-1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_num_list&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i-1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;MPI_Allgatherv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;local_array&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_num&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MPI_INT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;global_array&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;local_num_list&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;displ_list&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MPI_INT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MPI_COMM_WORLD&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;

&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;global_array&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;my_rank&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;after MPI_Allgatherv\n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;global_num&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;printf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;%d %d\n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;global_array&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;MPI_Finalize&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And the Makefile.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nf"&gt;CC&lt;/span&gt;&lt;span class="err"&gt;=&lt;/span&gt;&lt;span class="no"&gt;mpicc&lt;/span&gt;
&lt;span class="nf"&gt;CFLAGS&lt;/span&gt;&lt;span class="err"&gt;=&lt;/span&gt;&lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="no"&gt;c&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="no"&gt;Wall&lt;/span&gt;
&lt;span class="nf"&gt;LDFLAGS&lt;/span&gt;&lt;span class="err"&gt;=&lt;/span&gt;
&lt;span class="nf"&gt;SOURCES&lt;/span&gt;&lt;span class="err"&gt;=&lt;/span&gt;&lt;span class="no"&gt;test_allgatherv.c&lt;/span&gt;
&lt;span class="nf"&gt;OBJECTS&lt;/span&gt;&lt;span class="err"&gt;=&lt;/span&gt;&lt;span class="no"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;SOURCES&lt;/span&gt;&lt;span class="p"&gt;:.&lt;/span&gt;&lt;span class="no"&gt;c&lt;/span&gt;&lt;span class="err"&gt;=&lt;/span&gt;&lt;span class="no"&gt;.o&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nf"&gt;EXECUTABLE&lt;/span&gt;&lt;span class="err"&gt;=&lt;/span&gt;&lt;span class="no"&gt;test_allgatherv&lt;/span&gt;

&lt;span class="nl"&gt;all:&lt;/span&gt; &lt;span class="nf"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;SOURCES&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="no"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;EXECUTABLE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nf"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;EXECUTABLE&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt; &lt;span class="no"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;OBJECTS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nf"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;CC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="no"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;LDFLAGS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="no"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;OBJECTS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="no"&gt;o&lt;/span&gt; &lt;span class="no"&gt;$@&lt;/span&gt;

&lt;span class="nl"&gt;.c.o:&lt;/span&gt;
    &lt;span class="nf"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;CC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="no"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="no"&gt;CFLAGS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="no"&gt;$&lt;/span&gt;&lt;span class="err"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt;&lt;span class="no"&gt;o&lt;/span&gt; &lt;span class="no"&gt;$@&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;After compiling, run the job by&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mpirun -n 8 ./test_allgatherv
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;I got the correct result&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mf"&gt;1&lt;/span&gt; 
&lt;span class="mf"&gt;2&lt;/span&gt; 
&lt;span class="mf"&gt;2&lt;/span&gt; 
&lt;span class="mf"&gt;4&lt;/span&gt; 
&lt;span class="mf"&gt;4&lt;/span&gt; 
&lt;span class="mf"&gt;4&lt;/span&gt; 
&lt;span class="mf"&gt;4&lt;/span&gt; 
&lt;span class="mf"&gt;5&lt;/span&gt; 
&lt;span class="mf"&gt;5&lt;/span&gt; 
&lt;span class="mf"&gt;5&lt;/span&gt; 
&lt;span class="mf"&gt;5&lt;/span&gt; 
&lt;span class="mf"&gt;5&lt;/span&gt; 
&lt;span class="mf"&gt;8&lt;/span&gt; 
&lt;span class="mf"&gt;8&lt;/span&gt; 
&lt;span class="mf"&gt;8&lt;/span&gt; 
&lt;span class="mf"&gt;8&lt;/span&gt; 
&lt;span class="mf"&gt;8&lt;/span&gt; 
&lt;span class="mf"&gt;8&lt;/span&gt; 
&lt;span class="mf"&gt;8&lt;/span&gt; 
&lt;span class="mf"&gt;8&lt;/span&gt; 
&lt;span class="mf"&gt;3&lt;/span&gt; 
&lt;span class="mf"&gt;3&lt;/span&gt; 
&lt;span class="mf"&gt;3&lt;/span&gt; 
&lt;span class="mf"&gt;6&lt;/span&gt; 
&lt;span class="mf"&gt;6&lt;/span&gt; 
&lt;span class="mf"&gt;6&lt;/span&gt; 
&lt;span class="mf"&gt;6&lt;/span&gt; 
&lt;span class="mf"&gt;6&lt;/span&gt; 
&lt;span class="mf"&gt;6&lt;/span&gt; 
&lt;span class="mf"&gt;7&lt;/span&gt; 
&lt;span class="mf"&gt;7&lt;/span&gt; 
&lt;span class="mf"&gt;7&lt;/span&gt; 
&lt;span class="mf"&gt;7&lt;/span&gt; 
&lt;span class="mf"&gt;7&lt;/span&gt; 
&lt;span class="mf"&gt;7&lt;/span&gt; 
&lt;span class="mf"&gt;7&lt;/span&gt; 
&lt;span class="n"&gt;after&lt;/span&gt; &lt;span class="n"&gt;MPI_Allgatherv&lt;/span&gt;
&lt;span class="mf"&gt;0&lt;/span&gt; &lt;span class="mf"&gt;1&lt;/span&gt;
&lt;span class="mf"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;
&lt;span class="mf"&gt;2&lt;/span&gt; &lt;span class="mf"&gt;2&lt;/span&gt;
&lt;span class="mf"&gt;3&lt;/span&gt; &lt;span class="mf"&gt;3&lt;/span&gt;
&lt;span class="mf"&gt;4&lt;/span&gt; &lt;span class="mf"&gt;3&lt;/span&gt;
&lt;span class="mf"&gt;5&lt;/span&gt; &lt;span class="mf"&gt;3&lt;/span&gt;
&lt;span class="mf"&gt;6&lt;/span&gt; &lt;span class="mf"&gt;4&lt;/span&gt;
&lt;span class="mf"&gt;7&lt;/span&gt; &lt;span class="mf"&gt;4&lt;/span&gt;
&lt;span class="mf"&gt;8&lt;/span&gt; &lt;span class="mf"&gt;4&lt;/span&gt;
&lt;span class="mf"&gt;9&lt;/span&gt; &lt;span class="mf"&gt;4&lt;/span&gt;
&lt;span class="mf"&gt;10&lt;/span&gt; &lt;span class="mf"&gt;5&lt;/span&gt;
&lt;span class="mf"&gt;11&lt;/span&gt; &lt;span class="mf"&gt;5&lt;/span&gt;
&lt;span class="mf"&gt;12&lt;/span&gt; &lt;span class="mf"&gt;5&lt;/span&gt;
&lt;span class="mf"&gt;13&lt;/span&gt; &lt;span class="mf"&gt;5&lt;/span&gt;
&lt;span class="mf"&gt;14&lt;/span&gt; &lt;span class="mf"&gt;5&lt;/span&gt;
&lt;span class="mf"&gt;15&lt;/span&gt; &lt;span class="mf"&gt;6&lt;/span&gt;
&lt;span class="mf"&gt;16&lt;/span&gt; &lt;span class="mf"&gt;6&lt;/span&gt;
&lt;span class="mf"&gt;17&lt;/span&gt; &lt;span class="mf"&gt;6&lt;/span&gt;
&lt;span class="mf"&gt;18&lt;/span&gt; &lt;span class="mf"&gt;6&lt;/span&gt;
&lt;span class="mf"&gt;19&lt;/span&gt; &lt;span class="mf"&gt;6&lt;/span&gt;
&lt;span class="mf"&gt;20&lt;/span&gt; &lt;span class="mf"&gt;6&lt;/span&gt;
&lt;span class="mf"&gt;21&lt;/span&gt; &lt;span class="mf"&gt;7&lt;/span&gt;
&lt;span class="mf"&gt;22&lt;/span&gt; &lt;span class="mf"&gt;7&lt;/span&gt;
&lt;span class="mf"&gt;23&lt;/span&gt; &lt;span class="mf"&gt;7&lt;/span&gt;
&lt;span class="mf"&gt;24&lt;/span&gt; &lt;span class="mf"&gt;7&lt;/span&gt;
&lt;span class="mf"&gt;25&lt;/span&gt; &lt;span class="mf"&gt;7&lt;/span&gt;
&lt;span class="mf"&gt;26&lt;/span&gt; &lt;span class="mf"&gt;7&lt;/span&gt;
&lt;span class="mf"&gt;27&lt;/span&gt; &lt;span class="mf"&gt;7&lt;/span&gt;
&lt;span class="mf"&gt;28&lt;/span&gt; &lt;span class="mf"&gt;8&lt;/span&gt;
&lt;span class="mf"&gt;29&lt;/span&gt; &lt;span class="mf"&gt;8&lt;/span&gt;
&lt;span class="mf"&gt;30&lt;/span&gt; &lt;span class="mf"&gt;8&lt;/span&gt;
&lt;span class="mf"&gt;31&lt;/span&gt; &lt;span class="mf"&gt;8&lt;/span&gt;
&lt;span class="mf"&gt;32&lt;/span&gt; &lt;span class="mf"&gt;8&lt;/span&gt;
&lt;span class="mf"&gt;33&lt;/span&gt; &lt;span class="mf"&gt;8&lt;/span&gt;
&lt;span class="mf"&gt;34&lt;/span&gt; &lt;span class="mf"&gt;8&lt;/span&gt;
&lt;span class="mf"&gt;35&lt;/span&gt; &lt;span class="mf"&gt;8&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="misc"></category><category term="parallel computing"></category></entry><entry><title>mdtraj</title><link href="https://yaoyi92.github.io/mdtraj.html" rel="alternate"></link><published>2014-12-02T16:08:00+01:00</published><updated>2014-12-02T16:08:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-12-02:/mdtraj.html</id><summary type="html">&lt;p&gt;mdtraj&lt;/p&gt;</summary><content type="html">&lt;p&gt;mdtraj is a python library to read, write and analyze MD trajectories. Here is its &lt;a href="http://http://mdtraj.org"&gt;website&lt;/a&gt;. It can be easy installed by conda and has the function to calculate distance for particles with periodic boundary conditions.&lt;/p&gt;
&lt;p&gt;Here is how I use it on killdevil.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;module&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt; &lt;span class="n"&gt;anaconda&lt;/span&gt;
&lt;span class="n"&gt;module&lt;/span&gt; &lt;span class="n"&gt;load&lt;/span&gt; &lt;span class="n"&gt;gcc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;4.8.1&lt;/span&gt;
&lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="n"&gt;activate&lt;/span&gt; &lt;span class="n"&gt;my_root&lt;/span&gt;
&lt;span class="n"&gt;ipython&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;mdtraj&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="python"></category><category term="python"></category></entry><entry><title>dissipative particle dynamics of membrane from scratch</title><link href="https://yaoyi92.github.io/dissipative-particle-dynamics-of-membrane-from-scratch.html" rel="alternate"></link><published>2014-11-25T13:44:00+01:00</published><updated>2014-11-25T13:44:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-11-25:/dissipative-particle-dynamics-of-membrane-from-scratch.html</id><summary type="html">&lt;p&gt;Learning dissipative particle dynamics by lammps&lt;/p&gt;</summary><content type="html">&lt;p&gt;I perform a test dpd simulation of membrane started from the generation of structures. packmol is used for generate the input structure. lammps is used as the simulator. &lt;/p&gt;
&lt;p&gt;The lipid structure is as follow(lipid.xyz):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mf"&gt;11&lt;/span&gt;

&lt;span class="n"&gt;C&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;C&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;C&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;C&lt;/span&gt; &lt;span class="mf"&gt;1.5&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;C&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.6&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;C&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt; &lt;span class="mf"&gt;0.6&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;C&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt; &lt;span class="mf"&gt;0.6&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;C&lt;/span&gt; &lt;span class="mf"&gt;1.5&lt;/span&gt; &lt;span class="mf"&gt;0.6&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;H&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;H&lt;/span&gt; &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;span class="n"&gt;H&lt;/span&gt; &lt;span class="mf"&gt;2.5&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;which is like the pic shown below.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt Text" src="https://yaoyi92.github.io/images/lipid.png"&gt;&lt;/p&gt;
&lt;p&gt;also a water sturcture is listed(water.xyz). Because only one particle will represent one water.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mf"&gt;1&lt;/span&gt;

&lt;span class="n"&gt;W&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt; &lt;span class="mf"&gt;0.0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;a packmol input(bilayer_packmol.in) script is used here to generate the structure of the total system.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;tolerance&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;.&lt;span class="mi"&gt;5&lt;/span&gt;
&lt;span class="nv"&gt;filetype&lt;/span&gt; &lt;span class="nv"&gt;xyz&lt;/span&gt;
&lt;span class="nv"&gt;output&lt;/span&gt; &lt;span class="nv"&gt;bilayer&lt;/span&gt;.&lt;span class="nv"&gt;xyz&lt;/span&gt;

&lt;span class="nv"&gt;structure&lt;/span&gt; &lt;span class="nv"&gt;lipid&lt;/span&gt;.&lt;span class="nv"&gt;xyz&lt;/span&gt;
  &lt;span class="nv"&gt;number&lt;/span&gt; &lt;span class="mi"&gt;250&lt;/span&gt;
  &lt;span class="nv"&gt;inside&lt;/span&gt; &lt;span class="nv"&gt;box&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;10&lt;/span&gt;. &lt;span class="mi"&gt;19&lt;/span&gt;.&lt;span class="mi"&gt;428&lt;/span&gt; &lt;span class="mi"&gt;19&lt;/span&gt;.&lt;span class="mi"&gt;428&lt;/span&gt; &lt;span class="mi"&gt;13&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;
  &lt;span class="nv"&gt;atoms&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="nv"&gt;below&lt;/span&gt; &lt;span class="nv"&gt;plane&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;1&lt;/span&gt;. &lt;span class="mi"&gt;10&lt;/span&gt;.&lt;span class="mi"&gt;5&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nv"&gt;atoms&lt;/span&gt;
  &lt;span class="nv"&gt;atoms&lt;/span&gt; &lt;span class="mi"&gt;11&lt;/span&gt;
    &lt;span class="nv"&gt;over&lt;/span&gt; &lt;span class="nv"&gt;plane&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;1&lt;/span&gt;. &lt;span class="mi"&gt;12&lt;/span&gt;.&lt;span class="mi"&gt;5&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nv"&gt;atoms&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nv"&gt;structure&lt;/span&gt;

&lt;span class="nv"&gt;structure&lt;/span&gt; &lt;span class="nv"&gt;lipid&lt;/span&gt;.&lt;span class="nv"&gt;xyz&lt;/span&gt;
  &lt;span class="nv"&gt;number&lt;/span&gt; &lt;span class="mi"&gt;250&lt;/span&gt;
  &lt;span class="nv"&gt;inside&lt;/span&gt; &lt;span class="nv"&gt;box&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;7&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="mi"&gt;19&lt;/span&gt;.&lt;span class="mi"&gt;428&lt;/span&gt; &lt;span class="mi"&gt;19&lt;/span&gt;.&lt;span class="mi"&gt;428&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;.&lt;span class="mi"&gt;0&lt;/span&gt;
  &lt;span class="nv"&gt;atoms&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;
    &lt;span class="nv"&gt;over&lt;/span&gt; &lt;span class="nv"&gt;plane&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;1&lt;/span&gt;. &lt;span class="mi"&gt;9&lt;/span&gt;.&lt;span class="mi"&gt;5&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nv"&gt;atoms&lt;/span&gt;
  &lt;span class="nv"&gt;atoms&lt;/span&gt; &lt;span class="mi"&gt;11&lt;/span&gt;
    &lt;span class="nv"&gt;below&lt;/span&gt; &lt;span class="nv"&gt;plane&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;1&lt;/span&gt;. &lt;span class="mi"&gt;7&lt;/span&gt;.&lt;span class="mi"&gt;5&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nv"&gt;atoms&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nv"&gt;structure&lt;/span&gt;

&lt;span class="nv"&gt;structure&lt;/span&gt; &lt;span class="nv"&gt;water&lt;/span&gt;.&lt;span class="nv"&gt;xyz&lt;/span&gt;
  &lt;span class="nv"&gt;number&lt;/span&gt; &lt;span class="mi"&gt;8250&lt;/span&gt;
  &lt;span class="nv"&gt;inside&lt;/span&gt; &lt;span class="nv"&gt;box&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;12&lt;/span&gt;.&lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="mi"&gt;19&lt;/span&gt;.&lt;span class="mi"&gt;428&lt;/span&gt; &lt;span class="mi"&gt;19&lt;/span&gt;.&lt;span class="mi"&gt;428&lt;/span&gt; &lt;span class="mi"&gt;19&lt;/span&gt;.&lt;span class="mi"&gt;428&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nv"&gt;structure&lt;/span&gt;

&lt;span class="nv"&gt;structure&lt;/span&gt; &lt;span class="nv"&gt;water&lt;/span&gt;.&lt;span class="nv"&gt;xyz&lt;/span&gt;
  &lt;span class="nv"&gt;number&lt;/span&gt; &lt;span class="mi"&gt;8250&lt;/span&gt;
  &lt;span class="nv"&gt;inside&lt;/span&gt; &lt;span class="nv"&gt;box&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;0&lt;/span&gt;. &lt;span class="mi"&gt;19&lt;/span&gt;.&lt;span class="mi"&gt;428&lt;/span&gt; &lt;span class="mi"&gt;19&lt;/span&gt;.&lt;span class="mi"&gt;428&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;.&lt;span class="mi"&gt;5&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="nv"&gt;structure&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And also I have a script for the generation of psf and lammps data file.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="x"&gt;mol new bilayer.xyz&lt;/span&gt;

&lt;span class="x"&gt;pbc set &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt; &lt;span class="m"&gt;19.428&lt;/span&gt; &lt;span class="m"&gt;19.428&lt;/span&gt; &lt;span class="m"&gt;19.428&lt;/span&gt; &lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;
&lt;span class="x"&gt;topo clearbonds&lt;/span&gt;
&lt;span class="x"&gt;for &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt;&lt;span class="nf"&gt;set&lt;/span&gt; &lt;span class="na"&gt;i&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="m"&gt;500&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt;&lt;span class="nf"&gt;incr&lt;/span&gt; &lt;span class="na"&gt;i&lt;/span&gt;&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt; &lt;/span&gt;&lt;span class="cp"&gt;{&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addbond&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addbond&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addbond&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addbond&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addbond&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;6&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addbond&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;6&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;7&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addbond&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;8&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addbond&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;7&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addbond&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;8&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addbond&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;8&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addangle&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addangle&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addangle&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;8&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addangle&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;6&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addangle&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;6&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;7&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
    &lt;span class="na"&gt;topo&lt;/span&gt; &lt;span class="na"&gt;addangle&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;6&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;7&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="na"&gt;expr&lt;/span&gt; &lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="cp"&gt;}&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;

&lt;span class="x"&gt;animate write psf bilayer.psf&lt;/span&gt;
&lt;span class="x"&gt;topo writelammpsdata bilayer.data&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The final version of the input structure is showed as follow&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt Text" src="https://yaoyi92.github.io/images/membrane.png"&gt;&lt;/p&gt;
&lt;p&gt;I use this structure for the input of DPD simulation, and the input file for lammps is as follow. &lt;/p&gt;
&lt;p&gt;The input files: &lt;a href="https://yaoyi92.github.io/codes/bilayer.data"&gt;bilayer.data&lt;/a&gt;, &lt;a href="https://yaoyi92.github.io/codes/dpd_test.in"&gt;dpd_test.in&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;units&lt;/span&gt;       &lt;span class="n"&gt;lj&lt;/span&gt;
&lt;span class="n"&gt;atom_style&lt;/span&gt; &lt;span class="n"&gt;full&lt;/span&gt;
&lt;span class="n"&gt;comm_modify&lt;/span&gt; &lt;span class="n"&gt;vel&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;
&lt;span class="n"&gt;pair_style&lt;/span&gt;  &lt;span class="n"&gt;dpd&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt; &lt;span class="mh"&gt;34387&lt;/span&gt;

&lt;span class="n"&gt;read_data&lt;/span&gt; &lt;span class="n"&gt;bilayer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;
&lt;span class="p"&gt;#&lt;/span&gt; &lt;span class="n"&gt;create&lt;/span&gt; &lt;span class="n"&gt;simulation&lt;/span&gt; &lt;span class="n"&gt;box&lt;/span&gt;
&lt;span class="p"&gt;#&lt;/span&gt;&lt;span class="n"&gt;lattice&lt;/span&gt;     &lt;span class="n"&gt;fcc&lt;/span&gt; &lt;span class="mh"&gt;3&lt;/span&gt;
&lt;span class="p"&gt;#&lt;/span&gt;&lt;span class="n"&gt;region&lt;/span&gt;      &lt;span class="n"&gt;mybox&lt;/span&gt; &lt;span class="n"&gt;block&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mh"&gt;4&lt;/span&gt; &lt;span class="mh"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mh"&gt;4&lt;/span&gt; &lt;span class="mh"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mh"&gt;4&lt;/span&gt; &lt;span class="mh"&gt;4&lt;/span&gt; &lt;span class="n"&gt;units&lt;/span&gt; &lt;span class="n"&gt;lattice&lt;/span&gt;
&lt;span class="p"&gt;#&lt;/span&gt;&lt;span class="n"&gt;create_box&lt;/span&gt;  &lt;span class="mh"&gt;1&lt;/span&gt; &lt;span class="n"&gt;mybox&lt;/span&gt;
&lt;span class="p"&gt;#&lt;/span&gt;&lt;span class="n"&gt;create_atoms&lt;/span&gt;    &lt;span class="mh"&gt;1&lt;/span&gt; &lt;span class="n"&gt;box&lt;/span&gt;

&lt;span class="p"&gt;#&lt;/span&gt; &lt;span class="n"&gt;define&lt;/span&gt; &lt;span class="n"&gt;masses&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;interaction&lt;/span&gt; &lt;span class="n"&gt;coefficient&lt;/span&gt;
&lt;span class="p"&gt;#&lt;/span&gt;&lt;span class="n"&gt;mass&lt;/span&gt;        &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mh"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;pair_coeff&lt;/span&gt;  &lt;span class="mh"&gt;1&lt;/span&gt; &lt;span class="mh"&gt;1&lt;/span&gt; &lt;span class="mh"&gt;10&lt;/span&gt; &lt;span class="mf"&gt;4.5&lt;/span&gt;
&lt;span class="n"&gt;pair_coeff&lt;/span&gt;  &lt;span class="mh"&gt;2&lt;/span&gt; &lt;span class="mh"&gt;2&lt;/span&gt; &lt;span class="mh"&gt;30&lt;/span&gt; &lt;span class="mf"&gt;4.5&lt;/span&gt;
&lt;span class="n"&gt;pair_coeff&lt;/span&gt;  &lt;span class="mh"&gt;3&lt;/span&gt; &lt;span class="mh"&gt;3&lt;/span&gt; &lt;span class="mh"&gt;25&lt;/span&gt; &lt;span class="mf"&gt;4.5&lt;/span&gt;
&lt;span class="n"&gt;pair_coeff&lt;/span&gt;  &lt;span class="mh"&gt;1&lt;/span&gt; &lt;span class="mh"&gt;2&lt;/span&gt; &lt;span class="mh"&gt;35&lt;/span&gt; &lt;span class="mf"&gt;4.5&lt;/span&gt;
&lt;span class="n"&gt;pair_coeff&lt;/span&gt;  &lt;span class="mh"&gt;1&lt;/span&gt; &lt;span class="mh"&gt;3&lt;/span&gt; &lt;span class="mh"&gt;75&lt;/span&gt; &lt;span class="mf"&gt;4.5&lt;/span&gt;
&lt;span class="n"&gt;pair_coeff&lt;/span&gt;  &lt;span class="mh"&gt;2&lt;/span&gt; &lt;span class="mh"&gt;3&lt;/span&gt; &lt;span class="mh"&gt;30&lt;/span&gt; &lt;span class="mf"&gt;4.5&lt;/span&gt;

&lt;span class="n"&gt;bond_style&lt;/span&gt; &lt;span class="n"&gt;harmonic&lt;/span&gt;
&lt;span class="n"&gt;bond_coeff&lt;/span&gt; &lt;span class="mh"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;128.0&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;

&lt;span class="n"&gt;angle_style&lt;/span&gt; &lt;span class="n"&gt;cosine&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;delta&lt;/span&gt;
&lt;span class="n"&gt;angle_coeff&lt;/span&gt; &lt;span class="mh"&gt;1&lt;/span&gt; &lt;span class="mf"&gt;7.5&lt;/span&gt; &lt;span class="mf"&gt;180.0&lt;/span&gt;

&lt;span class="p"&gt;#&lt;/span&gt; &lt;span class="n"&gt;create&lt;/span&gt; &lt;span class="k"&gt;initial&lt;/span&gt; &lt;span class="n"&gt;velocities&lt;/span&gt;
&lt;span class="n"&gt;velocity&lt;/span&gt;    &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="n"&gt;create&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt; &lt;span class="mh"&gt;4928459&lt;/span&gt; &lt;span class="n"&gt;dist&lt;/span&gt; &lt;span class="n"&gt;gaussian&lt;/span&gt;

&lt;span class="p"&gt;#&lt;/span&gt; &lt;span class="n"&gt;change&lt;/span&gt; &lt;span class="n"&gt;neighbor&lt;/span&gt; &lt;span class="n"&gt;list&lt;/span&gt; &lt;span class="n"&gt;parameters&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;avoid&lt;/span&gt; &lt;span class="n"&gt;dangerous&lt;/span&gt; &lt;span class="n"&gt;builds&lt;/span&gt;
&lt;span class="n"&gt;neighbor&lt;/span&gt;    &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="n"&gt;bin&lt;/span&gt;
&lt;span class="n"&gt;neigh_modify&lt;/span&gt;    &lt;span class="n"&gt;delay&lt;/span&gt; &lt;span class="mh"&gt;3&lt;/span&gt;

&lt;span class="p"&gt;#&lt;/span&gt; &lt;span class="k"&gt;specify&lt;/span&gt; &lt;span class="n"&gt;simulation&lt;/span&gt; &lt;span class="n"&gt;parameters&lt;/span&gt;
&lt;span class="n"&gt;timestep&lt;/span&gt;    &lt;span class="mf"&gt;0.04&lt;/span&gt;
&lt;span class="n"&gt;thermo&lt;/span&gt;      &lt;span class="mh"&gt;10&lt;/span&gt;

&lt;span class="p"&gt;#&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt; &lt;span class="n"&gt;equilibrate&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="k"&gt;initial&lt;/span&gt; &lt;span class="n"&gt;condition&lt;/span&gt;
&lt;span class="n"&gt;fix&lt;/span&gt;     &lt;span class="mh"&gt;1&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="n"&gt;nve&lt;/span&gt;
&lt;span class="n"&gt;run&lt;/span&gt;     &lt;span class="mh"&gt;500&lt;/span&gt;

&lt;span class="n"&gt;dump&lt;/span&gt; &lt;span class="n"&gt;traj&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="n"&gt;xtc&lt;/span&gt;  &lt;span class="mh"&gt;50&lt;/span&gt; &lt;span class="n"&gt;traj&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xtc&lt;/span&gt;
&lt;span class="n"&gt;dump_modify&lt;/span&gt; &lt;span class="n"&gt;traj&lt;/span&gt; &lt;span class="n"&gt;unwrap&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;

&lt;span class="n"&gt;dump&lt;/span&gt; &lt;span class="n"&gt;traj_xyz&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="n"&gt;xyz&lt;/span&gt; &lt;span class="mh"&gt;50&lt;/span&gt; &lt;span class="n"&gt;traj&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xyz&lt;/span&gt;

&lt;span class="p"&gt;#&lt;/span&gt; &lt;span class="n"&gt;production&lt;/span&gt; &lt;span class="n"&gt;run&lt;/span&gt;
&lt;span class="n"&gt;run&lt;/span&gt;     &lt;span class="mh"&gt;50000&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The result movie is shown as below&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt Text" src="https://yaoyi92.github.io/images/dpd_movie.gif"&gt;&lt;/p&gt;</content><category term="molecular dynamics"></category><category term="molecular dynamics"></category></entry><entry><title>using ipython notebook remotely over an ssh tunnel</title><link href="https://yaoyi92.github.io/using-ipython-notebook-remotely-over-an-ssh-tunnel.html" rel="alternate"></link><published>2014-11-24T09:27:00+01:00</published><updated>2014-11-24T09:27:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-11-24:/using-ipython-notebook-remotely-over-an-ssh-tunnel.html</id><summary type="html">&lt;p&gt;ipython&lt;/p&gt;</summary><content type="html">&lt;p&gt;ipython notebook is a tool I loved. &lt;a href="http://wisdomthroughknowledge.blogspot.com/2012/07/accessing-ipython-notebook-remotely.html"&gt;Here&lt;/a&gt; is a tutorial of using ipython remotely with ssh tunnel. I list the commands here for remembering.&lt;/p&gt;
&lt;p&gt;On killdevil&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ipython notebook --no-browser --port=7000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;On my local machine&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;N&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;localhost&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;8888&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="nl"&gt;localhost&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;7000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;yiy&lt;/span&gt;&lt;span class="nv"&gt;@killdevil&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;edu&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;On my webbrowser&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;http://localhost:8888
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="python"></category><category term="python"></category></entry><entry><title>anaconda</title><link href="https://yaoyi92.github.io/anaconda.html" rel="alternate"></link><published>2014-11-23T13:40:00+01:00</published><updated>2014-11-23T13:40:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-11-23:/anaconda.html</id><summary type="html">&lt;p&gt;anaconda&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="https://store.continuum.io/cshop/anaconda/"&gt;anaconda&lt;/a&gt; is a python distribution for scientific computing. I used to use epd distribution but this one is better including tons of python packages built-in. The packages of numpy, scipy, ipython, numba, matplotlib are all included. The installation is also straight forward. I would like to recommend this distribution of python for scientists. It is totally free.&lt;/p&gt;</content><category term="python"></category><category term="python"></category></entry><entry><title>numba</title><link href="https://yaoyi92.github.io/numba.html" rel="alternate"></link><published>2014-11-23T11:52:00+01:00</published><updated>2014-11-23T11:52:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-11-23:/numba.html</id><summary type="html">&lt;p&gt;numba&lt;/p&gt;</summary><content type="html">&lt;p&gt;numba is a tool using jit to speed up python applications. Here is a &lt;a href="https://www.youtube.com/watch?v=COglHpt7KSs"&gt;video introduction&lt;/a&gt;.&lt;/p&gt;</content><category term="python"></category><category term="python"></category></entry><entry><title>dissipative particle dynamics</title><link href="https://yaoyi92.github.io/dissipative-particle-dynamics.html" rel="alternate"></link><published>2014-11-22T23:27:00+01:00</published><updated>2014-11-22T23:27:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-11-22:/dissipative-particle-dynamics.html</id><summary type="html">&lt;p&gt;Learning dissipative particle dynamics&lt;/p&gt;</summary><content type="html">&lt;p&gt;I learned about dissipative particle dynamics (DPD) with Max, Upendra, and Ardeshir. It is an amazing tool for simulation of mesoscale systems including polymers and bio-membranes.
The system size can be extened to µm ,and µs for time scale which is about 10^6 faster than regular molecular dynamics.&lt;/p&gt;
&lt;p&gt;This post is for my learning process and materials of DPD.&lt;/p&gt;
&lt;p&gt;Rob Groot seems to be the bigest name in the field of DPD. And he has really good slides for DPD. Here is the &lt;a href="http://www.cecam.org/upload/talk/presentation_2751.pdf"&gt;link&lt;/a&gt;. &lt;/p&gt;
&lt;p&gt;In the presentation, he answered the question of how to parameterise DPD. The goal of it is to reproduce local thermodynamics which are measured by compressibility and solubility. Flory-Huggins theory are used for the solubility.&lt;/p&gt;
&lt;p&gt;I tried to run dpd in lammps. With the input below.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="p"&gt;#&lt;/span&gt; &lt;span class="n"&gt;This&lt;/span&gt; &lt;span class="n"&gt;is&lt;/span&gt; &lt;span class="n"&gt;LAMMPS&lt;/span&gt; &lt;span class="k"&gt;input&lt;/span&gt; &lt;span class="n"&gt;script&lt;/span&gt; &lt;span class="n"&gt;specifies&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;simple&lt;/span&gt; &lt;span class="n"&gt;DPD&lt;/span&gt; &lt;span class="n"&gt;simulation&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;span class="p"&gt;#&lt;/span&gt; &lt;span class="n"&gt;It&lt;/span&gt; &lt;span class="n"&gt;reproduces&lt;/span&gt; &lt;span class="n"&gt;Fig&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="mh"&gt;2&lt;/span&gt; &lt;span class="n"&gt;of&lt;/span&gt; &lt;span class="n"&gt;Groot&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;Warren&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;J&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Chem&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="n"&gt;Phys&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt; &lt;span class="mh"&gt;107&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;#&lt;/span&gt; &lt;span class="mh"&gt;4423&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;1997&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;units&lt;/span&gt;       &lt;span class="n"&gt;lj&lt;/span&gt;
&lt;span class="n"&gt;atom_style&lt;/span&gt; &lt;span class="n"&gt;atomic&lt;/span&gt; 
&lt;span class="n"&gt;comm_modify&lt;/span&gt; &lt;span class="n"&gt;vel&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;
&lt;span class="n"&gt;pair_style&lt;/span&gt;  &lt;span class="n"&gt;dpd&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt; &lt;span class="mh"&gt;34387&lt;/span&gt;

&lt;span class="p"&gt;#&lt;/span&gt; &lt;span class="n"&gt;create&lt;/span&gt; &lt;span class="n"&gt;simulation&lt;/span&gt; &lt;span class="n"&gt;box&lt;/span&gt;
&lt;span class="n"&gt;lattice&lt;/span&gt;     &lt;span class="n"&gt;fcc&lt;/span&gt; &lt;span class="mh"&gt;3&lt;/span&gt;
&lt;span class="n"&gt;region&lt;/span&gt;      &lt;span class="n"&gt;mybox&lt;/span&gt; &lt;span class="n"&gt;block&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mh"&gt;4&lt;/span&gt; &lt;span class="mh"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mh"&gt;4&lt;/span&gt; &lt;span class="mh"&gt;4&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mh"&gt;4&lt;/span&gt; &lt;span class="mh"&gt;4&lt;/span&gt; &lt;span class="n"&gt;units&lt;/span&gt; &lt;span class="n"&gt;lattice&lt;/span&gt;
&lt;span class="n"&gt;create_box&lt;/span&gt;  &lt;span class="mh"&gt;1&lt;/span&gt; &lt;span class="n"&gt;mybox&lt;/span&gt;
&lt;span class="n"&gt;create_atoms&lt;/span&gt;    &lt;span class="mh"&gt;1&lt;/span&gt; &lt;span class="n"&gt;box&lt;/span&gt;

&lt;span class="p"&gt;#&lt;/span&gt; &lt;span class="n"&gt;define&lt;/span&gt; &lt;span class="n"&gt;masses&lt;/span&gt; &lt;span class="k"&gt;and&lt;/span&gt; &lt;span class="n"&gt;interaction&lt;/span&gt; &lt;span class="n"&gt;coefficient&lt;/span&gt;
&lt;span class="n"&gt;mass&lt;/span&gt;        &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="mh"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;pair_coeff&lt;/span&gt;  &lt;span class="mh"&gt;1&lt;/span&gt; &lt;span class="mh"&gt;1&lt;/span&gt; &lt;span class="mh"&gt;25&lt;/span&gt; &lt;span class="mf"&gt;4.5&lt;/span&gt;

&lt;span class="p"&gt;#&lt;/span&gt; &lt;span class="n"&gt;create&lt;/span&gt; &lt;span class="k"&gt;initial&lt;/span&gt; &lt;span class="n"&gt;velocities&lt;/span&gt;
&lt;span class="n"&gt;velocity&lt;/span&gt;    &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="n"&gt;create&lt;/span&gt; &lt;span class="mf"&gt;1.0&lt;/span&gt; &lt;span class="mh"&gt;4928459&lt;/span&gt; &lt;span class="n"&gt;dist&lt;/span&gt; &lt;span class="n"&gt;gaussian&lt;/span&gt;

&lt;span class="p"&gt;#&lt;/span&gt; &lt;span class="n"&gt;change&lt;/span&gt; &lt;span class="n"&gt;neighbor&lt;/span&gt; &lt;span class="n"&gt;list&lt;/span&gt; &lt;span class="n"&gt;parameters&lt;/span&gt; &lt;span class="n"&gt;to&lt;/span&gt; &lt;span class="n"&gt;avoid&lt;/span&gt; &lt;span class="n"&gt;dangerous&lt;/span&gt; &lt;span class="n"&gt;builds&lt;/span&gt;
&lt;span class="n"&gt;neighbor&lt;/span&gt;    &lt;span class="mf"&gt;2.0&lt;/span&gt; &lt;span class="n"&gt;bin&lt;/span&gt;
&lt;span class="n"&gt;neigh_modify&lt;/span&gt;    &lt;span class="n"&gt;delay&lt;/span&gt; &lt;span class="mh"&gt;3&lt;/span&gt;

&lt;span class="p"&gt;#&lt;/span&gt; &lt;span class="k"&gt;specify&lt;/span&gt; &lt;span class="n"&gt;simulation&lt;/span&gt; &lt;span class="n"&gt;parameters&lt;/span&gt;
&lt;span class="n"&gt;timestep&lt;/span&gt;    &lt;span class="mf"&gt;0.04&lt;/span&gt;
&lt;span class="n"&gt;thermo&lt;/span&gt;      &lt;span class="mh"&gt;10&lt;/span&gt;

&lt;span class="p"&gt;#&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt; &lt;span class="n"&gt;equilibrate&lt;/span&gt; &lt;span class="n"&gt;the&lt;/span&gt; &lt;span class="k"&gt;initial&lt;/span&gt; &lt;span class="n"&gt;condition&lt;/span&gt;
&lt;span class="n"&gt;fix&lt;/span&gt;     &lt;span class="mh"&gt;1&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="n"&gt;nve&lt;/span&gt;
&lt;span class="n"&gt;run&lt;/span&gt;     &lt;span class="mh"&gt;500&lt;/span&gt;

&lt;span class="n"&gt;dump&lt;/span&gt; &lt;span class="n"&gt;traj&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="n"&gt;xtc&lt;/span&gt;  &lt;span class="mh"&gt;50&lt;/span&gt; &lt;span class="n"&gt;traj&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xtc&lt;/span&gt;
&lt;span class="n"&gt;dump_modify&lt;/span&gt; &lt;span class="n"&gt;traj&lt;/span&gt; &lt;span class="n"&gt;unwrap&lt;/span&gt; &lt;span class="n"&gt;yes&lt;/span&gt;

&lt;span class="n"&gt;dump&lt;/span&gt; &lt;span class="n"&gt;traj_xyz&lt;/span&gt; &lt;span class="n"&gt;all&lt;/span&gt; &lt;span class="n"&gt;xyz&lt;/span&gt; &lt;span class="mh"&gt;50&lt;/span&gt; &lt;span class="n"&gt;traj&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xyz&lt;/span&gt;

&lt;span class="p"&gt;#&lt;/span&gt; &lt;span class="n"&gt;production&lt;/span&gt; &lt;span class="n"&gt;run&lt;/span&gt;
&lt;span class="n"&gt;run&lt;/span&gt;     &lt;span class="mh"&gt;50000&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The gr plot I got from this simulation is the same as the plot 2 in the paper.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Alt Text" src="https://yaoyi92.github.io/images/gr_dpd.png"&gt;&lt;/p&gt;</content><category term="molecular dynamics"></category><category term="molecular dynamics"></category></entry><entry><title>Install mpi4py on killdevil</title><link href="https://yaoyi92.github.io/install-mpi4py-on-killdevil.html" rel="alternate"></link><published>2014-11-22T23:27:00+01:00</published><updated>2014-11-22T23:27:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-11-22:/install-mpi4py-on-killdevil.html</id><summary type="html">&lt;p&gt;The way to install mpi4py on killdevil&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="http://mpi4py.scipy.org/"&gt;mpi4py&lt;/a&gt; is the package for python to take advantage of mpi. I am try to install it on killdevil.&lt;/p&gt;
&lt;p&gt;The modules: I got on killdevil are&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Currently Loaded Modulefiles:
  1) null                   2) epd/7.2-2              3) openmpi_intel/12.1-5
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And I run the commands:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;wget&lt;/span&gt; &lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;bitbucket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;org&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mpi4py&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mpi4py&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;downloads&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mpi4py&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;1.&lt;/span&gt;&lt;span class="n"&gt;tar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gz&lt;/span&gt;
&lt;span class="n"&gt;tar&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;xzvf&lt;/span&gt; &lt;span class="n"&gt;mpi4py&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;1.&lt;/span&gt;&lt;span class="n"&gt;tar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gz&lt;/span&gt;
&lt;span class="n"&gt;cd&lt;/span&gt; &lt;span class="n"&gt;mpi4py&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt; &lt;span class="n"&gt;install&lt;/span&gt; &lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Then it is successfully installed.&lt;/p&gt;
&lt;p&gt;I do the test.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mpiexec -n 5 python demo/helloworld.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Got the result:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Hello, World! I am process 1 of 5 on c-186-31.kd.unc.edu.
Hello, World! I am process 4 of 5 on c-186-31.kd.unc.edu.
Hello, World! I am process 0 of 5 on c-186-31.kd.unc.edu.
Hello, World! I am process 3 of 5 on c-186-31.kd.unc.edu.
Hello, World! I am process 2 of 5 on c-186-31.kd.unc.edu.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="python"></category><category term="python"></category><category term="parallel computing"></category></entry><entry><title>thermodynamics integration from scratch using cp2k</title><link href="https://yaoyi92.github.io/thermodynamics-integration-from-scratch-using-cp2k.html" rel="alternate"></link><published>2014-11-20T12:52:00+01:00</published><updated>2014-11-20T12:52:00+01:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-11-20:/thermodynamics-integration-from-scratch-using-cp2k.html</id><summary type="html">&lt;p&gt;help me remember some tools in setting up MD simulation and free energy calculation.&lt;/p&gt;</summary><content type="html">&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;2 ions in 512 water system is using to calculation the Potential of Mean Force (PMF) for ion pair. ( I was using 64 water system where the size of the box is only about 12.0Å, the PMF can only exceed to 6.0Å, if I use 512 water system the box size can be more than 24Å the PMF can exceed to 10.0Å. )&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;I need to know the size of the box with such number of water and ion in the system. (maybe not necessary for such big system, I put it here for smaller system and large concentration ionic solutions) Details are in my code.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://yaoyi92.github.io/codes/cal_density.py"&gt;cal_density.py&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://yaoyi92.github.io/codes/cal_density_512h2o.py"&gt;cal_density_512h2o.py&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The box size calculated for NaCl in 512H2O is 24.8736639347 Å.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Generate the initial structure for my simulation. I use gromacs and vmd to do that.
First using genbox tool in gromacs to generate a box of water with 514 water in it. The size is a little bit larger to make sure enough water molecules can be included.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;genbox_d -cs spc216.gro -box 2.52 2.52 2.52 -maxsol 514
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;In this way, I got a out.gro file. I will rename it to h2o514.gro file. And edit it to change the last two water to a Na ion and a Cl ion. Also the size of the box will be changed as well as the index of the atoms and the total number of atoms in the top of the file. Then I rename it to h2o512NaCl.gro. I have the final version of it here.
&lt;a href="https://yaoyi92.github.io/codes/h2o512NaCl.gro"&gt;h2o512NaCl.gro&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I would like to use psf and xyz file for the input of topology information and coordinations in to cp2k. VMD is used here for this task. So I use the script I wrote for vmd.
&lt;a href="https://yaoyi92.github.io/codes/tr_psf512.vmd"&gt;tr_psf512.vmd&lt;/a&gt;
it used in this way.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vmd -e tr_psf512.vmd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The files I got here is H2O512NaCl.xyz, and H2O512NaCl_gro.psf . They also need to be edited (OW -&amp;gt; O, HW1, HW2 -&amp;gt; H, the atom mass, and change the form of psf to upsf which can be loaded by cp2k). The final version of these two files are given here.
&lt;a href="https://yaoyi92.github.io/codes/H2O512NaCl.xyz"&gt;H2O512NaCl.xyz&lt;/a&gt;
&lt;a href="https://yaoyi92.github.io/codes/H2O512NaCl_gro.psf"&gt;H2O512NaCl_gro.psf&lt;/a&gt;
(This structure is not good enough for directly calculation since the cell size is not the same. I will try to use packmol to regenerate another initial structure for the calculation later.)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The force field I am using is &lt;a href="http://scitation.aip.org/content/aip/journal/jcp/130/12/10.1063/1.3081142"&gt;SPCE/HMN&lt;/a&gt;. An online &lt;a href="http://www.colby.edu/chemistry/PChem/Hartree.html"&gt;energy unit convertion tool&lt;/a&gt; is used for the parameters.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The &lt;a href="https://yaoyi92.github.io/codes/H2O_SPCE_HMN.inp"&gt;input file&lt;/a&gt; for cp2k. It is the input file for constraint dynamics. The lagrange multiplier will print out for the constraint force for the thermodynamics integration calculation. &lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;</content><category term="molecular dynamics"></category><category term="molecular dynamics"></category><category term="free energy calculation"></category></entry><entry><title>calculate madelung constant by ewald method</title><link href="https://yaoyi92.github.io/calculate-madelung-constant-by-ewald-method.html" rel="alternate"></link><published>2014-04-22T14:31:00+02:00</published><updated>2014-04-22T14:31:00+02:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-04-22:/calculate-madelung-constant-by-ewald-method.html</id><summary type="html">&lt;p&gt;Understand the details of ewald summation by calculate madelung constant&lt;/p&gt;</summary><content type="html">&lt;p&gt;I would like to understand the details of ewald summation. So, I took the
calculation of madelung constant (&lt;a href="http://en.wikipedia.org/wiki/Madelung_constant"&gt;Wikipedia&lt;/a&gt;)
as an example. I took two method to calculate madelung constant.
One is calculate it by expanding cubes method, the other is ewald summation method.
A good description of ewald summation can be found &lt;a href="http://micro.stanford.edu/mediawiki/images/4/46/Ewald_notes.pdf"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;After the derivation, the total Coulomb interaction energy can be finally written as,
&lt;/p&gt;
&lt;div class="math"&gt;\begin{array}
 E E &amp;amp;=&amp;amp; E^S + E^L - E^{self} \\
\end{array}&lt;/div&gt;
&lt;div class="math"&gt;\begin{array}
   &amp;amp;=&amp;amp; \frac{1}{4\pi\epsilon_0}\frac{1}{2}
       \sum_\mathbf{n} \sum_{i=1}^N \sum_{j=1}^N
       \frac{q_iq_j}{|\mathbf{r}_i - \mathbf{r}_j + \mathbf{n}L|}
       erfc\left( \frac{|\mathbf{r}_i - \mathbf{r}_j + \mathbf{n}L|}{\sqrt{2}\sigma}\right)
\end{array}&lt;/div&gt;
&lt;div class="math"&gt;\begin{array}
    + + \frac{1}{2V\epsilon_0} \sum_{\mathbf{k}\neq \mathbf{0}}
    \frac{e^{-\sigma^2k^2/2}}{k^2}|S(\mathbf{k})| 
    -\frac{1}{4\pi\epsilon_0}\frac{1}{\sqrt{2\pi\sigma}}
    \sum_{i=1}^{N}q_i^2
\end{array}&lt;/div&gt;
&lt;p&gt;In the &lt;a href="http://micro.stanford.edu/mediawiki/images/4/46/Ewald_notes.pdf"&gt;paper&lt;/a&gt; 
I just mentioned, we can find all the details for this formula.&lt;/p&gt;
&lt;p&gt;While, we need potential instead of total energy to calculate Madelung constant.
We should take derivative over q to calculate the potential. Notice that some 
term exists which include 1/2. These are used to deal with double counting.
When we want to calculate potential, these 1/2 should be erased.&lt;/p&gt;
&lt;p&gt;&lt;span class="math"&gt;\(test^2\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="https://yaoyi92.github.io/codes/madelung_realspace.m"&gt;madelung_realspace.m&lt;/a&gt;
&lt;a href="https://yaoyi92.github.io/codes/madelung_ewald.m"&gt;madelung_ewald.m&lt;/a&gt;&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content><category term="molecular dynamics"></category><category term="molecular dynamics"></category><category term="ewald"></category><category term="matlab"></category></entry><entry><title>qmcpack - a qmc package</title><link href="https://yaoyi92.github.io/qmcpack-a-qmc-package.html" rel="alternate"></link><published>2014-04-22T14:31:00+02:00</published><updated>2014-04-22T14:31:00+02:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-04-22:/qmcpack-a-qmc-package.html</id><summary type="html">&lt;p&gt;QMCPACK with video tutorials&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="http://qmcpack.org/"&gt;QMCPACK&lt;/a&gt; is a software designed for qmc calculation. reptation is included. And it can start from pwscf calculation which attracts me a lot.&lt;/p&gt;
&lt;p&gt;I found a video tutorial from their website.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://www.youtube.com/playlist?list=PLZ3WPqWe6k8t6__0VESBAh6KfUcVo7JTt"&gt;QMCPACK Summer Training 2014&lt;/a&gt;&lt;/p&gt;</content><category term="quantum monte carlo"></category><category term="quantum monte carlo"></category></entry><entry><title>My first Post</title><link href="https://yaoyi92.github.io/my-first-post.html" rel="alternate"></link><published>2014-04-13T19:20:00+02:00</published><updated>2014-04-13T19:20:00+02:00</updated><author><name>Yi Yao</name></author><id>tag:yaoyi92.github.io,2014-04-13:/my-first-post.html</id><summary type="html">&lt;p class="first last"&gt;I generate this website using pelican and pelican-bootstrap3.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;I generate this website using pelican and pelican-bootstrap3.
Now, I can write blogs with it in rst form.&lt;/p&gt;
</content><category term="python"></category><category term="website"></category><category term="python"></category></entry></feed>